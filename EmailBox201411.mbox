From bookkeeper-dev-return-11562-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov  2 09:52:34 2014
Return-Path: <bookkeeper-dev-return-11562-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 451D710F70
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun,  2 Nov 2014 09:52:34 +0000 (UTC)
Received: (qmail 79659 invoked by uid 500); 2 Nov 2014 09:52:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 79625 invoked by uid 500); 2 Nov 2014 09:52:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 79614 invoked by uid 99); 2 Nov 2014 09:52:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Nov 2014 09:52:34 +0000
Date: Sun, 2 Nov 2014 09:52:34 +0000 (UTC)
From: "Flavio Junqueira (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12654780.1372185725000.393541.1414921954027@Atlassian.JIRA>
In-Reply-To: <JIRA.12654780.1372185725000@Atlassian.JIRA>
References: <JIRA.12654780.1372185725000@Atlassian.JIRA> <JIRA.12654780.1372185725063@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-634) Provide admin tool to rename
 bookie identifier in ledger metadata
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-634?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14193768#comment-14193768 ] 

Flavio Junqueira commented on BOOKKEEPER-634:
---------------------------------------------

[~rakeshr], have you had a chance to consider the last batch of comments [~ikelly] has put up? I can see QA posts, but no response from you. Let's try to wrap up this issue soon.

> Provide admin tool to rename bookie identifier in ledger metadata
> -----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-634
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-634
>             Project: Bookkeeper
>          Issue Type: Sub-task
>          Components: bookkeeper-client, bookkeeper-server
>    Affects Versions: 4.2.1
>            Reporter: Rakesh R
>            Assignee: Rakesh R
>             Fix For: 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-634-initial-draft-version.patch, 001-BOOKKEEPER-634-rename-bookieid-in-ledger.patch, 002-BOOKKEEPER-634-rename-bookieid-in-ledger.patch, BOOKKEEPER-634-rename-bookieid-in-ledger.patch, BOOKKEEPER-634.patch, BOOKKEEPER-634.patch
>
>
> This JIRA to discuss about admin tool for changing the bookie's IP to hostname.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11563-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov  2 10:14:34 2014
Return-Path: <bookkeeper-dev-return-11563-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9A55F10FCA
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun,  2 Nov 2014 10:14:34 +0000 (UTC)
Received: (qmail 87210 invoked by uid 500); 2 Nov 2014 10:14:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 87174 invoked by uid 500); 2 Nov 2014 10:14:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 87163 invoked by uid 99); 2 Nov 2014 10:14:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Nov 2014 10:14:34 +0000
Date: Sun, 2 Nov 2014 10:14:34 +0000 (UTC)
From: "Flavio Junqueira (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12745924.1412436521000.393567.1414923274367@Atlassian.JIRA>
In-Reply-To: <JIRA.12745924.1412436521000@Atlassian.JIRA>
References: <JIRA.12745924.1412436521000@Atlassian.JIRA> <JIRA.12745924.1412436521775@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-788) Provide release inspector
 script
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-788?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14193770#comment-14193770 ] 

Flavio Junqueira commented on BOOKKEEPER-788:
---------------------------------------------

I like the idea of the script. I'm also not sure what [~ikelly] means with integrating with the buildscripts. Is it about QA or maven build?

The build of hedwig-protocol fails for me when running your script against trunk and it doesn't complete the initialization.

I also noticed that it doesn't spit out an error message, so I had to look at the logs to see what happened. It is not a big deal, but it would be nice to spit out success or failure at the end.

A simple performance test is this:

{noformat}
bookkeeper-benchmark/bin/benchmark bookie -zookeeper <zk> -host <bookie>
{noformat}

> Provide release inspector script
> --------------------------------
>
>                 Key: BOOKKEEPER-788
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-788
>             Project: Bookkeeper
>          Issue Type: Improvement
>            Reporter: Jiannan Wang
>            Assignee: Jiannan Wang
>            Priority: Trivial
>             Fix For: 4.4.0
>
>         Attachments: BOOKKEEPER-788.patch
>
>
> For each release, we need to type a sequence of commands to validate release candidate tag. This process could be achieved by a single script.
> Here is the behavior of the script in my mind:
>    1. Collecting build environment info (Operation System, JDK, Maven)
>    2. Run 'mvn install -DskipTests'
>    3. Checking code (findbugs, rat).
>    4. Running unit test
>    5. Start standalone Bookie and Hedwig service
>    6. Run simple Bookie test: bookkeeper-server/bin/bookkeeper simpletest
> -ensemble 3 -writeQuorum 3
>    7. Run simple Hedwig test: hedwig-server/bin/hedwig console; pubsub
> topic subscriber 10 message
>    8. Tar all above logs when error/exit
> In addition, this script could also be provided to user which could collect related information to diagnose compile/UT failure issue.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11564-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov  2 10:39:35 2014
Return-Path: <bookkeeper-dev-return-11564-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1A06617231
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun,  2 Nov 2014 10:39:34 +0000 (UTC)
Received: (qmail 6872 invoked by uid 500); 2 Nov 2014 10:39:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 6827 invoked by uid 500); 2 Nov 2014 10:39:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 6814 invoked by uid 99); 2 Nov 2014 10:39:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 02 Nov 2014 10:39:34 +0000
Date: Sun, 2 Nov 2014 10:39:34 +0000 (UTC)
From: "Rakesh R (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12654780.1372185725000.393604.1414924774339@Atlassian.JIRA>
In-Reply-To: <JIRA.12654780.1372185725000@Atlassian.JIRA>
References: <JIRA.12654780.1372185725000@Atlassian.JIRA> <JIRA.12654780.1372185725063@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-634) Provide admin tool to rename
 bookie identifier in ledger metadata
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-634?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14193777#comment-14193777 ] 

Rakesh R commented on BOOKKEEPER-634:
-------------------------------------

Thanks [~fpj] for the reminder. Unfortunately I couldn't find enough time to focus on this due to couple of reasons:(, I think I will be able to see it after Nov 7th.

> Provide admin tool to rename bookie identifier in ledger metadata
> -----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-634
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-634
>             Project: Bookkeeper
>          Issue Type: Sub-task
>          Components: bookkeeper-client, bookkeeper-server
>    Affects Versions: 4.2.1
>            Reporter: Rakesh R
>            Assignee: Rakesh R
>             Fix For: 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-634-initial-draft-version.patch, 001-BOOKKEEPER-634-rename-bookieid-in-ledger.patch, 002-BOOKKEEPER-634-rename-bookieid-in-ledger.patch, BOOKKEEPER-634-rename-bookieid-in-ledger.patch, BOOKKEEPER-634.patch, BOOKKEEPER-634.patch
>
>
> This JIRA to discuss about admin tool for changing the bookie's IP to hostname.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11565-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov  3 16:58:39 2014
Return-Path: <bookkeeper-dev-return-11565-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4BF4D1035F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon,  3 Nov 2014 16:58:39 +0000 (UTC)
Received: (qmail 58782 invoked by uid 500); 3 Nov 2014 16:58:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 58746 invoked by uid 500); 3 Nov 2014 16:58:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 58731 invoked by uid 99); 3 Nov 2014 16:58:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Nov 2014 16:58:34 +0000
Date: Mon, 3 Nov 2014 16:58:34 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12745924.1412436521000.399066.1415033914110@Atlassian.JIRA>
In-Reply-To: <JIRA.12745924.1412436521000@Atlassian.JIRA>
References: <JIRA.12745924.1412436521000@Atlassian.JIRA> <JIRA.12745924.1412436521775@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-788) Provide release inspector
 script
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-788?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14194727#comment-14194727 ] 

Ivan Kelly commented on BOOKKEEPER-788:
---------------------------------------

[~jiannan] [~fpj] I was referring to the QA scripts, bin/test-*.

Jiannan, I don't have any automated scripts for testing perf, since it means spinning up a cluster.

> Provide release inspector script
> --------------------------------
>
>                 Key: BOOKKEEPER-788
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-788
>             Project: Bookkeeper
>          Issue Type: Improvement
>            Reporter: Jiannan Wang
>            Assignee: Jiannan Wang
>            Priority: Trivial
>             Fix For: 4.4.0
>
>         Attachments: BOOKKEEPER-788.patch
>
>
> For each release, we need to type a sequence of commands to validate release candidate tag. This process could be achieved by a single script.
> Here is the behavior of the script in my mind:
>    1. Collecting build environment info (Operation System, JDK, Maven)
>    2. Run 'mvn install -DskipTests'
>    3. Checking code (findbugs, rat).
>    4. Running unit test
>    5. Start standalone Bookie and Hedwig service
>    6. Run simple Bookie test: bookkeeper-server/bin/bookkeeper simpletest
> -ensemble 3 -writeQuorum 3
>    7. Run simple Hedwig test: hedwig-server/bin/hedwig console; pubsub
> topic subscriber 10 message
>    8. Tar all above logs when error/exit
> In addition, this script could also be provided to user which could collect related information to diagnose compile/UT failure issue.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11566-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov  3 17:00:38 2014
Return-Path: <bookkeeper-dev-return-11566-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EFAC71037F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon,  3 Nov 2014 17:00:37 +0000 (UTC)
Received: (qmail 60288 invoked by uid 500); 3 Nov 2014 17:00:37 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 60249 invoked by uid 500); 3 Nov 2014 17:00:37 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 60238 invoked by uid 99); 3 Nov 2014 17:00:37 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Nov 2014 17:00:37 +0000
Date: Mon, 3 Nov 2014 17:00:37 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.399070.1415034037513@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-795:
----------------------------------
    Attachment: 0001-Made-ledger-metadata-immutable.patch

Patch makes LedgerMetadata immutable.

Ensembles are now ImmutableMap<Long, ImmutableList<BookieSocketAddress>>. The LedgerManager manager interface has changed to avoid implicitly updating the version of a LedgerMetadata object. Recovery, Closing and handling bookie failures have now changed, as there are no longer merge operations. If a write to zookeeper fails, then recovery/closing/failureHandling are retried with the new metadata, provided that assumptions are not broken.
    
The interesting changes are in LedgerHandle and LedgerMetadata.
    
There are a lot of changes from ArrayList -> ImmutableList,List

Also a lot of changes from currentEnsemble -> getCurrentEnsemble.
    
One test had to change. With the old code, if someone fenced a ledger, closing would fail. This isn't always the case now. If there's lac of the writing ledger matches the lastEntryId of the new metadata, then close can succeed. ConditionalSetTest has changed to reflect this.
    

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11567-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov  3 17:02:33 2014
Return-Path: <bookkeeper-dev-return-11567-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 43A6F103E7
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon,  3 Nov 2014 17:02:33 +0000 (UTC)
Received: (qmail 69844 invoked by uid 500); 3 Nov 2014 17:02:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 69811 invoked by uid 500); 3 Nov 2014 17:02:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 69725 invoked by uid 99); 3 Nov 2014 17:02:32 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Nov 2014 17:02:32 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id 42DF61DFA90;
	Mon,  3 Nov 2014 17:02:36 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============5865336050472303934=="
MIME-Version: 1.0
Subject: Review Request 27529: BOOKKEEPER-795 Race condition causes writes to
 hang if ledger is fences
From: "Ivan Kelly" <ivank@apache.org>
To: "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Mon, 03 Nov 2014 17:02:36 -0000
Message-ID: <20141103170236.10454.5921@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/27529/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>
X-ReviewRequest-Repository: bookkeeper-git

--===============5865336050472303934==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/27529/
-----------------------------------------------------------

Review request for bookkeeper.


Bugs: BOOKKEEPER-795
    https://issues.apache.org/jira/browse/BOOKKEEPER-795


Repository: bookkeeper-git


Description
-------

    Made ledger metadata immutable
    
    Ensembles are now ImmutableMap<Long, ImmutableList<BookieSocketAddress>>.
    The LedgerManager manager interface has changed to avoid implicitly
    updating the version of a LedgerMetadata object. Recovery, Closing and
    handling bookie failures have now changed, as there are no longer merge
    operations. If a write to zookeeper fails, then
    recovery/closing/failureHandling are retried with the new metadata,
    provided that assumptions are not broken.
    
    The interesting changes are in LedgerHandle and LedgerMetadata.
    
    There are a lot of changes from ArrayList -> ImmutableList,List
    Also a lot of changes from currentEnsemble -> getCurrentEnsemble.
    
    One test had to change. With the old code, if someone fenced a ledger,
    closing would fail. This isn't always the case now. If there's lac of
    the writing ledger matches the lastEntryId of the new metadata, then
    close can succeed. ConditionalSetTest has changed to reflect this.


Diffs
-----

  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java 18a801c 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java 3f2580f 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java fe223af 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragment.java 6aadb8a 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java 4501524 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java 7204d6c 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadata.java a20f34a 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java 7ed7aa2 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java 1b92d09 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java e548f3d 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedOp.java af21f44 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java 8de4092 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TryReadLastConfirmedOp.java 01b81c9 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java 0fc8afe 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/CleanupLedgerManager.java a873112 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java 2bc4258 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java 7f2df73 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java 7229028 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java 2510b89 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/BookieLedgerIndexer.java 1b4efaf 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java 02154e5 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/CompactionTest.java ef4cea8 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieRecoveryTest.java f18e159 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieWriteLedgerTest.java 7b77c48 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/ClientUtil.java dc43b2c 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerCloseTest.java eef56b0 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerHandleAdapter.java 9af527a 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerRecoveryTest.java f54cde1 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/SlowBookieTest.java 521d1e3 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerChecker.java eb61c21 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerFragmentReplication.java e4f744f 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java 2a6c71d 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestTryReadLastConfirmed.java ac0afb6 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestWatchEnsembleChange.java eb833a3 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/GcLedgersTest.java 19aab44 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/AuditorPeriodicBookieCheckTest.java 91aae77 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/BookieAutoRecoveryTest.java 72fd11c 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestAutoRecoveryAlongWithBookieServers.java e1ccf68 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestReplicationWorker.java d47e4b1 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java 9662777 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/ConditionalSetTest.java a06accd 

Diff: https://reviews.apache.org/r/27529/diff/


Testing
-------

All tests pass


Thanks,

Ivan Kelly


--===============5865336050472303934==--

From bookkeeper-dev-return-11568-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov  3 17:03:34 2014
Return-Path: <bookkeeper-dev-return-11568-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ECB36103F1
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon,  3 Nov 2014 17:03:33 +0000 (UTC)
Received: (qmail 71658 invoked by uid 500); 3 Nov 2014 17:03:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 71614 invoked by uid 500); 3 Nov 2014 17:03:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 71601 invoked by uid 99); 3 Nov 2014 17:03:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Nov 2014 17:03:33 +0000
Date: Mon, 3 Nov 2014 17:03:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.399085.1415034213665@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14194734#comment-14194734 ] 

Ivan Kelly commented on BOOKKEEPER-795:
---------------------------------------

Review board: https://reviews.apache.org/r/27529/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11569-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov  3 17:46:34 2014
Return-Path: <bookkeeper-dev-return-11569-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DD696105E7
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon,  3 Nov 2014 17:46:33 +0000 (UTC)
Received: (qmail 14818 invoked by uid 500); 3 Nov 2014 17:46:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 14782 invoked by uid 500); 3 Nov 2014 17:46:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 14771 invoked by uid 99); 3 Nov 2014 17:46:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Nov 2014 17:46:33 +0000
Date: Mon, 3 Nov 2014 17:46:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.399403.1415036793729@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14194783#comment-14194783 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12678958/0001-Made-ledger-metadata-immutable.patch] downloaded at Mon Nov  3 17:10:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:red}-1 FINDBUGS{color}
.    {color:red}-1{color} the patch seems to introduce 2 new Findbugs warning(s) in module(s) [bookkeeper-server]
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/804/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11570-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov  3 23:46:34 2014
Return-Path: <bookkeeper-dev-return-11570-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6707B17A4F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon,  3 Nov 2014 23:46:34 +0000 (UTC)
Received: (qmail 78943 invoked by uid 500); 3 Nov 2014 23:46:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 78906 invoked by uid 500); 3 Nov 2014 23:46:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 78894 invoked by uid 99); 3 Nov 2014 23:46:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 03 Nov 2014 23:46:34 +0000
Date: Mon, 3 Nov 2014 23:46:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.403682.1415058394131@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14195381#comment-14195381 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12678958/0001-Made-ledger-metadata-immutable.patch] downloaded at Mon Nov  3 23:10:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:red}-1 FINDBUGS{color}
.    {color:red}-1{color} the patch seems to introduce 2 new Findbugs warning(s) in module(s) [bookkeeper-server]
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/805/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11571-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov  4 00:37:34 2014
Return-Path: <bookkeeper-dev-return-11571-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B4E5117CF6
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue,  4 Nov 2014 00:37:34 +0000 (UTC)
Received: (qmail 13611 invoked by uid 500); 4 Nov 2014 00:37:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 13553 invoked by uid 500); 4 Nov 2014 00:37:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 13378 invoked by uid 99); 4 Nov 2014 00:37:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Nov 2014 00:37:34 +0000
Date: Tue, 4 Nov 2014 00:37:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.404408.1415061454244@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14195462#comment-14195462 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12678958/0001-Made-ledger-metadata-immutable.patch] downloaded at Tue Nov  4 00:01:05 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:red}-1 FINDBUGS{color}
.    {color:red}-1{color} the patch seems to introduce 2 new Findbugs warning(s) in module(s) [bookkeeper-server]
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/806/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11572-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov  4 01:13:35 2014
Return-Path: <bookkeeper-dev-return-11572-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 131D917E4C
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue,  4 Nov 2014 01:13:35 +0000 (UTC)
Received: (qmail 3289 invoked by uid 500); 4 Nov 2014 01:13:35 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 3256 invoked by uid 500); 4 Nov 2014 01:13:35 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 3245 invoked by uid 99); 4 Nov 2014 01:13:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Nov 2014 01:13:34 +0000
Date: Tue, 4 Nov 2014 01:13:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.404799.1415063614862@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14195514#comment-14195514 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12678958/0001-Made-ledger-metadata-immutable.patch] downloaded at Tue Nov  4 00:37:32 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:red}-1 FINDBUGS{color}
.    {color:red}-1{color} the patch seems to introduce 2 new Findbugs warning(s) in module(s) [bookkeeper-server]
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/807/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11573-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov  4 01:47:35 2014
Return-Path: <bookkeeper-dev-return-11573-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9938517EF2
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue,  4 Nov 2014 01:47:35 +0000 (UTC)
Received: (qmail 53983 invoked by uid 500); 4 Nov 2014 01:47:35 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 53946 invoked by uid 500); 4 Nov 2014 01:47:35 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 53877 invoked by uid 99); 4 Nov 2014 01:47:35 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 04 Nov 2014 01:47:35 +0000
Date: Tue, 4 Nov 2014 01:47:35 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12747755.1413216670000.404958.1415065655035@Atlassian.JIRA>
In-Reply-To: <JIRA.12747755.1413216670000@Atlassian.JIRA>
References: <JIRA.12747755.1413216670000@Atlassian.JIRA> <JIRA.12747755.1413216670623@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-792) Split bookkeeper client into a
 separate maven module
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-792?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14195546#comment-14195546 ] 

Hadoop QA commented on BOOKKEEPER-792:
--------------------------------------

Testing JIRA BOOKKEEPER-792


Patch [0001-Split-the-bookkeeper-client-from-the-server.patch|https://issues.apache.org/jira/secure/attachment/12674744/0001-Split-the-bookkeeper-client-from-the-server.patch] downloaded at Tue Nov  4 01:13:45 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 929
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/808/

> Split bookkeeper client into a separate maven module
> ----------------------------------------------------
>
>                 Key: BOOKKEEPER-792
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-792
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-Split-the-bookkeeper-client-from-the-server.patch, 0001-Split-the-bookkeeper-client-from-the-server.patch, 0001-Split-the-bookkeeper-client-from-the-server.patch
>
>
> Right now, to include bookkeeper as a dependency, you need to include org.apache.bookkeeper:bookkeeper-server
> This pulls in all the bookkeeper-server code, and all the server dependencies as well as the client. The server dependencies are larger than the client dependencies. For one thing, it pulls in jna and log4j which should never be pulled in from the client.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11574-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov  7 15:11:12 2014
Return-Path: <bookkeeper-dev-return-11574-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E8D9117ED4
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri,  7 Nov 2014 15:11:12 +0000 (UTC)
Received: (qmail 41130 invoked by uid 500); 7 Nov 2014 15:11:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 41074 invoked by uid 500); 7 Nov 2014 15:11:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 41063 invoked by uid 99); 7 Nov 2014 15:11:12 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 07 Nov 2014 15:11:12 +0000
Received: from mail-qc0-f173.google.com (mail-qc0-f173.google.com [209.85.216.173])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 4E8461A01AD
	for <bookkeeper-dev@zookeeper.apache.org>; Fri,  7 Nov 2014 15:10:23 +0000 (UTC)
Received: by mail-qc0-f173.google.com with SMTP id x3so2628159qcv.32
        for <bookkeeper-dev@zookeeper.apache.org>; Fri, 07 Nov 2014 07:11:10 -0800 (PST)
X-Gm-Message-State: ALoCoQnezTNs/+XIiLpLXf5aFm0B1ZsRxzNnO/e9zpGJahhx57/XmIsV4t6COyw7nLezu1qXJIzT
MIME-Version: 1.0
X-Received: by 10.224.10.195 with SMTP id q3mr18707731qaq.8.1415373070145;
 Fri, 07 Nov 2014 07:11:10 -0800 (PST)
Received: by 10.140.137.206 with HTTP; Fri, 7 Nov 2014 07:11:10 -0800 (PST)
X-Originating-IP: [213.27.241.137]
Date: Fri, 7 Nov 2014 16:11:10 +0100
Message-ID: <CAD=ttqTbAFOvnjnZ2saLiw-MMFP72u2yyptMDXTh4mvnUL4eMg@mail.gmail.com>
Subject: Zookeeper availability coupling in bookkeeper
From: Ivan Kelly <ivank@apache.org>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Content-Type: text/plain; charset=UTF-8

Hi folks,

Currently bookie lifetime is dependent on the zookeeper session which
the bookie was started with. This is bad, and unnecessary and
something that has causes us some downtime here. I have a fix for this
available, but before I put up the patch, I'd like to know if anyone
has also fixed this (I'm looking in the direction of Twitter here).
BOOKKEEPER-704 added a zookeeper client that survived session expiry
but this client was never wired into anything. I'm currently writing
some tests for this in the bookkeeper client.

@Sijie, do you guys already have more changes in this area. I'd like
to avoid duplicating work here.

Cheers,
Ivan

From bookkeeper-dev-return-11575-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 10 16:23:33 2014
Return-Path: <bookkeeper-dev-return-11575-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CF95E174EE
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 10 Nov 2014 16:23:33 +0000 (UTC)
Received: (qmail 27633 invoked by uid 500); 10 Nov 2014 16:23:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 27596 invoked by uid 500); 10 Nov 2014 16:23:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 27585 invoked by uid 99); 10 Nov 2014 16:23:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Nov 2014 16:23:33 +0000
Date: Mon, 10 Nov 2014 16:23:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.460916.1415636613610@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Created] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Ivan Kelly created BOOKKEEPER-796:
-------------------------------------

             Summary: Make bookkeeper client use reconnectable zookeeper wrapper
                 Key: BOOKKEEPER-796
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
             Project: Bookkeeper
          Issue Type: Bug
            Reporter: Ivan Kelly
            Assignee: Ivan Kelly
             Fix For: 4.4.0


BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11576-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 10 16:25:35 2014
Return-Path: <bookkeeper-dev-return-11576-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B2096174F9
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 10 Nov 2014 16:25:35 +0000 (UTC)
Received: (qmail 33106 invoked by uid 500); 10 Nov 2014 16:25:35 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 33068 invoked by uid 500); 10 Nov 2014 16:25:35 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 33056 invoked by uid 99); 10 Nov 2014 16:25:35 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Nov 2014 16:25:35 +0000
Date: Mon, 10 Nov 2014 16:25:35 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.460917.1415636734980@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-796:
----------------------------------
    Issue Type: Sub-task  (was: Bug)
        Parent: BOOKKEEPER-537

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11577-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 10 16:29:34 2014
Return-Path: <bookkeeper-dev-return-11577-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2DECE1751B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 10 Nov 2014 16:29:34 +0000 (UTC)
Received: (qmail 43598 invoked by uid 500); 10 Nov 2014 16:29:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 43561 invoked by uid 500); 10 Nov 2014 16:29:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 43549 invoked by uid 99); 10 Nov 2014 16:29:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Nov 2014 16:29:34 +0000
Date: Mon, 10 Nov 2014 16:29:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.460926.1415636973665@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-796:
----------------------------------
    Attachment: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11578-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 10 16:33:34 2014
Return-Path: <bookkeeper-dev-return-11578-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BC36E17564
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 10 Nov 2014 16:33:34 +0000 (UTC)
Received: (qmail 55666 invoked by uid 500); 10 Nov 2014 16:33:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 55634 invoked by uid 500); 10 Nov 2014 16:33:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 55519 invoked by uid 99); 10 Nov 2014 16:33:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Nov 2014 16:33:34 +0000
Date: Mon, 10 Nov 2014 16:33:34 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.460938.1415637214513@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14204954#comment-14204954 ] 

Ivan Kelly commented on BOOKKEEPER-796:
---------------------------------------

Patch has two parts. Firstly, it hooks ZookeeperClient into the bookkeeper client. This is all very straightforward.

Secondly, I added a thread in BookKeeperClusterTestCase, which kills the clients zookeeper session every 1 second. Tests run with this, and mostly pass, but there's some flakiness. All tests should succeed with this, but I think these are different fixes. One thing that is broken is that #close fails if it gets a MetadataVersionException. This is wrong. It should only fail if assumptions have changed. I think BOOKKEEPER-795 should fix this. Other tests fail because timeouts are too short, afaics. Having to retry metadata operations takes more time.

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11579-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 10 17:30:34 2014
Return-Path: <bookkeeper-dev-return-11579-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C9DAC178B2
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 10 Nov 2014 17:30:34 +0000 (UTC)
Received: (qmail 54266 invoked by uid 500); 10 Nov 2014 17:30:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 54227 invoked by uid 500); 10 Nov 2014 17:30:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 54215 invoked by uid 99); 10 Nov 2014 17:30:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 10 Nov 2014 17:30:34 +0000
Date: Mon, 10 Nov 2014 17:30:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.461343.1415640634461@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14205040#comment-14205040 ] 

Hadoop QA commented on BOOKKEEPER-796:
--------------------------------------

Testing JIRA BOOKKEEPER-796


Patch [0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch|https://issues.apache.org/jira/secure/attachment/12680596/0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch] downloaded at Mon Nov 10 16:30:40 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 929
.    Tests failed: 3
.    Tests errors: 9

.    The patch failed the following testcases:

.      testReadTimeout(org.apache.bookkeeper.client.TestReadTimeout)
.      testCloseDuringOp[0](org.apache.bookkeeper.client.BookKeeperTest)
.      testCloseDuringOp[1](org.apache.bookkeeper.client.BookKeeperTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/809/

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11580-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 11 04:07:34 2014
Return-Path: <bookkeeper-dev-return-11580-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5D52317751
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 11 Nov 2014 04:07:34 +0000 (UTC)
Received: (qmail 10350 invoked by uid 500); 11 Nov 2014 04:07:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 10310 invoked by uid 500); 11 Nov 2014 04:07:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 10299 invoked by uid 99); 11 Nov 2014 04:07:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Nov 2014 04:07:34 +0000
Date: Tue, 11 Nov 2014 04:07:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.466494.1415678854100@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14205918#comment-14205918 ] 

Hadoop QA commented on BOOKKEEPER-796:
--------------------------------------

Testing JIRA BOOKKEEPER-796


Patch [0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch|https://issues.apache.org/jira/secure/attachment/12680596/0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch] downloaded at Tue Nov 11 03:10:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 929
.    Tests failed: 3
.    Tests errors: 7

.    The patch failed the following testcases:

.      testReadTimeout(org.apache.bookkeeper.client.TestReadTimeout)
.      testCloseDuringOp[0](org.apache.bookkeeper.client.BookKeeperTest)
.      testCloseDuringOp[1](org.apache.bookkeeper.client.BookKeeperTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/810/

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11581-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 11 05:08:36 2014
Return-Path: <bookkeeper-dev-return-11581-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C535A1787D
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 11 Nov 2014 05:08:36 +0000 (UTC)
Received: (qmail 9698 invoked by uid 500); 11 Nov 2014 05:08:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 9656 invoked by uid 500); 11 Nov 2014 05:08:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 9644 invoked by uid 99); 11 Nov 2014 05:08:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Nov 2014 05:08:34 +0000
Date: Tue, 11 Nov 2014 05:08:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.466685.1415682514192@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14205950#comment-14205950 ] 

Hadoop QA commented on BOOKKEEPER-796:
--------------------------------------

Testing JIRA BOOKKEEPER-796


Patch [0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch|https://issues.apache.org/jira/secure/attachment/12680596/0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch] downloaded at Tue Nov 11 04:07:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 929
.    Tests failed: 3
.    Tests errors: 13

.    The patch failed the following testcases:

.      testReadTimeout(org.apache.bookkeeper.client.TestReadTimeout)
.      testCloseDuringOp[0](org.apache.bookkeeper.client.BookKeeperTest)
.      testCloseDuringOp[1](org.apache.bookkeeper.client.BookKeeperTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/811/

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11582-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 11 19:25:26 2014
Return-Path: <bookkeeper-dev-return-11582-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A2C7517D63
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 11 Nov 2014 19:25:26 +0000 (UTC)
Received: (qmail 95846 invoked by uid 500); 11 Nov 2014 19:25:26 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 95810 invoked by uid 500); 11 Nov 2014 19:25:26 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 95790 invoked by uid 99); 11 Nov 2014 19:25:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Nov 2014 19:25:26 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of guosijie@gmail.com designates 209.85.192.178 as permitted sender)
Received: from [209.85.192.178] (HELO mail-pd0-f178.google.com) (209.85.192.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 11 Nov 2014 19:24:59 +0000
Received: by mail-pd0-f178.google.com with SMTP id fp1so10613213pdb.37
        for <bookkeeper-dev@zookeeper.apache.org>; Tue, 11 Nov 2014 11:23:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=2jPiM2QSwXkOdQ7jbrFCoMet2jcDdz2hEiOyOpjiP08=;
        b=TuDumQRvnQuGQJJjqgHfmFuKkyBABdnoKZc3rfMRuVqW1WKwa0wZycCCHwrQg6DiY9
         2DakwlDRbcuZxy5N86IkQf/FbxP3R2Ocpe9j8gc+mxtaFV2/a/ByWi7ZrSA+DEKBrku9
         W8b6ONaPKeItYSCAtfDwevR9B0eJy/XV7EgmNeJMDQU/o456+LKXsOXVKGQ1iJlUUt7K
         ZJbYX+67NHpRkJf727tFjY/+OoVs468w9zHP1hpOKaifZuWArlxkcype3fzZ7UWz7PYN
         zoUj1mRLosrc+RXtlYHYbdHjdXxlgt1peDViIiG38LTyBq+d1rk/M8ZzTFbVzR9t9uIx
         IV2w==
MIME-Version: 1.0
X-Received: by 10.68.57.163 with SMTP id j3mr11645305pbq.163.1415733808036;
 Tue, 11 Nov 2014 11:23:28 -0800 (PST)
Received: by 10.70.44.106 with HTTP; Tue, 11 Nov 2014 11:23:27 -0800 (PST)
In-Reply-To: <CAD=ttqTbAFOvnjnZ2saLiw-MMFP72u2yyptMDXTh4mvnUL4eMg@mail.gmail.com>
References: <CAD=ttqTbAFOvnjnZ2saLiw-MMFP72u2yyptMDXTh4mvnUL4eMg@mail.gmail.com>
Date: Tue, 11 Nov 2014 11:23:27 -0800
Message-ID: <CAO2yDybtP0Qoh-Dg6-ectG=YkAV95fGRp-3CJRqOg2E14B-o3g@mail.gmail.com>
Subject: Re: Zookeeper availability coupling in bookkeeper
From: Sijie Guo <guosijie@gmail.com>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Content-Type: multipart/alternative; boundary=001a1137f9f4b9830d05079a36e2
X-Virus-Checked: Checked by ClamAV on apache.org

--001a1137f9f4b9830d05079a36e2
Content-Type: text/plain; charset=UTF-8

BOOKKEEPER-705 is what we handled the session expiry event on client &
server side.

- Sijie

On Fri, Nov 7, 2014 at 7:11 AM, Ivan Kelly <ivank@apache.org> wrote:

> Hi folks,
>
> Currently bookie lifetime is dependent on the zookeeper session which
> the bookie was started with. This is bad, and unnecessary and
> something that has causes us some downtime here. I have a fix for this
> available, but before I put up the patch, I'd like to know if anyone
> has also fixed this (I'm looking in the direction of Twitter here).
> BOOKKEEPER-704 added a zookeeper client that survived session expiry
> but this client was never wired into anything. I'm currently writing
> some tests for this in the bookkeeper client.
>
> @Sijie, do you guys already have more changes in this area. I'd like
> to avoid duplicating work here.
>
> Cheers,
> Ivan
>

--001a1137f9f4b9830d05079a36e2--

From bookkeeper-dev-return-11583-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 12 01:57:34 2014
Return-Path: <bookkeeper-dev-return-11583-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 875F9176F5
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 12 Nov 2014 01:57:34 +0000 (UTC)
Received: (qmail 19940 invoked by uid 500); 12 Nov 2014 01:57:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 19845 invoked by uid 500); 12 Nov 2014 01:57:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 19561 invoked by uid 99); 12 Nov 2014 01:57:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Nov 2014 01:57:34 +0000
Date: Wed, 12 Nov 2014 01:57:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.475672.1415757454052@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14207521#comment-14207521 ] 

Hadoop QA commented on BOOKKEEPER-796:
--------------------------------------

Testing JIRA BOOKKEEPER-796


Patch [0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch|https://issues.apache.org/jira/secure/attachment/12680596/0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch] downloaded at Wed Nov 12 01:00:21 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 929
.    Tests failed: 2
.    Tests errors: 10

.    The patch failed the following testcases:

.      testCloseDuringOp[0](org.apache.bookkeeper.client.BookKeeperTest)
.      testCloseDuringOp[1](org.apache.bookkeeper.client.BookKeeperTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/812/

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11584-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 12 16:33:22 2014
Return-Path: <bookkeeper-dev-return-11584-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2E76B9D1F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 12 Nov 2014 16:33:22 +0000 (UTC)
Received: (qmail 41771 invoked by uid 500); 12 Nov 2014 16:33:22 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 41735 invoked by uid 500); 12 Nov 2014 16:33:22 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 41716 invoked by uid 99); 12 Nov 2014 16:33:21 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Nov 2014 16:33:21 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id C58991DFF0E;
	Wed, 12 Nov 2014 16:33:24 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============8556216998108025839=="
MIME-Version: 1.0
Subject: Re: Review Request 27529: BOOKKEEPER-795 Race condition causes writes
 to hang if ledger is fences
From: fpj@apache.org
To: fpj@apache.org, "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Wed, 12 Nov 2014 16:33:24 -0000
Message-ID: <20141112163324.19819.11837@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: noreply@reviews.apache.org
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/27529/
X-Sender: noreply@reviews.apache.org
References: <20141103170236.10454.5921@reviews.apache.org>
In-Reply-To: <20141103170236.10454.5921@reviews.apache.org>
Reply-To: fpj@apache.org
X-ReviewRequest-Repository: bookkeeper-git

--===============8556216998108025839==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/27529/#review60997
-----------------------------------------------------------


I quite like the changes here, they make sense to me. I just have one clarification question and a small suggestion below.


bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java
<https://reviews.apache.org/r/27529/#comment102459>

    I'm a bit confused by the synchronization here. The implementation of handleBookieFailure with a different signature is synchronized but this one isn't. It sounds like handleBookieFailure(BookieFailureEvent failure) is invoked outside handleBookieFailure(final BookieSocketAddress addr, final int bookieIndex) and it isn't clear to me if the synchroization as proposed is right. Have you actually checked?



bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java
<https://reviews.apache.org/r/27529/#comment102460>

    Small suggestion: I'd rather call it tmpMetadata or something similar rather than numbering variables like this.


- fpj


On Nov. 3, 2014, 5:02 p.m., Ivan Kelly wrote:
> 
> -----------------------------------------------------------
> This is an automatically generated e-mail. To reply, visit:
> https://reviews.apache.org/r/27529/
> -----------------------------------------------------------
> 
> (Updated Nov. 3, 2014, 5:02 p.m.)
> 
> 
> Review request for bookkeeper.
> 
> 
> Bugs: BOOKKEEPER-795
>     https://issues.apache.org/jira/browse/BOOKKEEPER-795
> 
> 
> Repository: bookkeeper-git
> 
> 
> Description
> -------
> 
>     Made ledger metadata immutable
>     
>     Ensembles are now ImmutableMap<Long, ImmutableList<BookieSocketAddress>>.
>     The LedgerManager manager interface has changed to avoid implicitly
>     updating the version of a LedgerMetadata object. Recovery, Closing and
>     handling bookie failures have now changed, as there are no longer merge
>     operations. If a write to zookeeper fails, then
>     recovery/closing/failureHandling are retried with the new metadata,
>     provided that assumptions are not broken.
>     
>     The interesting changes are in LedgerHandle and LedgerMetadata.
>     
>     There are a lot of changes from ArrayList -> ImmutableList,List
>     Also a lot of changes from currentEnsemble -> getCurrentEnsemble.
>     
>     One test had to change. With the old code, if someone fenced a ledger,
>     closing would fail. This isn't always the case now. If there's lac of
>     the writing ledger matches the lastEntryId of the new metadata, then
>     close can succeed. ConditionalSetTest has changed to reflect this.
> 
> 
> Diffs
> -----
> 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java 18a801c 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java 3f2580f 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java fe223af 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragment.java 6aadb8a 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java 4501524 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java 7204d6c 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadata.java a20f34a 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java 7ed7aa2 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java 1b92d09 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java e548f3d 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedOp.java af21f44 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java 8de4092 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TryReadLastConfirmedOp.java 01b81c9 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java 0fc8afe 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/CleanupLedgerManager.java a873112 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java 2bc4258 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java 7f2df73 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java 7229028 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java 2510b89 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/BookieLedgerIndexer.java 1b4efaf 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java 02154e5 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/CompactionTest.java ef4cea8 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieRecoveryTest.java f18e159 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieWriteLedgerTest.java 7b77c48 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/ClientUtil.java dc43b2c 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerCloseTest.java eef56b0 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerHandleAdapter.java 9af527a 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerRecoveryTest.java f54cde1 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/SlowBookieTest.java 521d1e3 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerChecker.java eb61c21 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerFragmentReplication.java e4f744f 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java 2a6c71d 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestTryReadLastConfirmed.java ac0afb6 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestWatchEnsembleChange.java eb833a3 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/GcLedgersTest.java 19aab44 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/AuditorPeriodicBookieCheckTest.java 91aae77 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/BookieAutoRecoveryTest.java 72fd11c 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestAutoRecoveryAlongWithBookieServers.java e1ccf68 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestReplicationWorker.java d47e4b1 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java 9662777 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/test/ConditionalSetTest.java a06accd 
> 
> Diff: https://reviews.apache.org/r/27529/diff/
> 
> 
> Testing
> -------
> 
> All tests pass
> 
> 
> Thanks,
> 
> Ivan Kelly
> 
>


--===============8556216998108025839==--

From bookkeeper-dev-return-11585-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 12 18:54:27 2014
Return-Path: <bookkeeper-dev-return-11585-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9F620C532
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 12 Nov 2014 18:54:27 +0000 (UTC)
Received: (qmail 86480 invoked by uid 500); 12 Nov 2014 18:54:27 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 86444 invoked by uid 500); 12 Nov 2014 18:54:27 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 86433 invoked by uid 99); 12 Nov 2014 18:54:27 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 12 Nov 2014 18:54:27 +0000
Received: from mail-qc0-f179.google.com (mail-qc0-f179.google.com [209.85.216.179])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 216D31A01AD
	for <bookkeeper-dev@zookeeper.apache.org>; Wed, 12 Nov 2014 18:53:29 +0000 (UTC)
Received: by mail-qc0-f179.google.com with SMTP id i8so1637353qcq.24
        for <bookkeeper-dev@zookeeper.apache.org>; Wed, 12 Nov 2014 10:54:22 -0800 (PST)
X-Gm-Message-State: ALoCoQnVNgFjRZ6PZm94ZTr1D38e4eM0MI7G+a15/3v6tovzAVgSikAJtfCC1P6t2mPDZy+zTjhP
MIME-Version: 1.0
X-Received: by 10.229.214.5 with SMTP id gy5mr63046311qcb.18.1415818462236;
 Wed, 12 Nov 2014 10:54:22 -0800 (PST)
Received: by 10.140.128.87 with HTTP; Wed, 12 Nov 2014 10:54:22 -0800 (PST)
X-Originating-IP: [81.36.60.43]
In-Reply-To: <CAO2yDybtP0Qoh-Dg6-ectG=YkAV95fGRp-3CJRqOg2E14B-o3g@mail.gmail.com>
References: <CAD=ttqTbAFOvnjnZ2saLiw-MMFP72u2yyptMDXTh4mvnUL4eMg@mail.gmail.com>
	<CAO2yDybtP0Qoh-Dg6-ectG=YkAV95fGRp-3CJRqOg2E14B-o3g@mail.gmail.com>
Date: Wed, 12 Nov 2014 19:54:22 +0100
Message-ID: <CAD=ttqQOaSqXf=Y1z9F65ZFhUinej5WYXCrJGsvvXEVSHggZ5g@mail.gmail.com>
Subject: Re: Zookeeper availability coupling in bookkeeper
From: Ivan Kelly <ivank@apache.org>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Content-Type: text/plain; charset=UTF-8

Ah, I hadn't seen that that had a patch. Could you mark the jira's
which have a patch, as patch available. Even if the patch isn't ready
to go in, it'll give an idea of what code is available.

-Ivan

On 11 November 2014 20:23, Sijie Guo <guosijie@gmail.com> wrote:
> BOOKKEEPER-705 is what we handled the session expiry event on client &
> server side.
>
> - Sijie
>
> On Fri, Nov 7, 2014 at 7:11 AM, Ivan Kelly <ivank@apache.org> wrote:
>
>> Hi folks,
>>
>> Currently bookie lifetime is dependent on the zookeeper session which
>> the bookie was started with. This is bad, and unnecessary and
>> something that has causes us some downtime here. I have a fix for this
>> available, but before I put up the patch, I'd like to know if anyone
>> has also fixed this (I'm looking in the direction of Twitter here).
>> BOOKKEEPER-704 added a zookeeper client that survived session expiry
>> but this client was never wired into anything. I'm currently writing
>> some tests for this in the bookkeeper client.
>>
>> @Sijie, do you guys already have more changes in this area. I'd like
>> to avoid duplicating work here.
>>
>> Cheers,
>> Ivan
>>

From bookkeeper-dev-return-11586-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 13 11:22:04 2014
Return-Path: <bookkeeper-dev-return-11586-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CDF57FE39
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 13 Nov 2014 11:22:04 +0000 (UTC)
Received: (qmail 68502 invoked by uid 500); 13 Nov 2014 11:22:04 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 68465 invoked by uid 500); 13 Nov 2014 11:22:04 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 68446 invoked by uid 99); 13 Nov 2014 11:22:04 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Nov 2014 11:22:04 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id 775351D30A7;
	Thu, 13 Nov 2014 11:22:07 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============1079661107251729795=="
MIME-Version: 1.0
Subject: Re: Review Request 27529: BOOKKEEPER-795 Race condition causes writes
 to hang if ledger is fences
From: "Ivan Kelly" <ivank@apache.org>
To: fpj@apache.org, "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Thu, 13 Nov 2014 11:22:07 -0000
Message-ID: <20141113112207.9703.78254@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/27529/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
References: <20141112163324.19819.11837@reviews.apache.org>
In-Reply-To: <20141112163324.19819.11837@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>
X-ReviewRequest-Repository: bookkeeper-git

--===============1079661107251729795==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit



> On Nov. 12, 2014, 4:33 p.m., fpj wrote:
> > bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java, line 888
> > <https://reviews.apache.org/r/27529/diff/1/?file=747433#file747433line888>
> >
> >     I'm a bit confused by the synchronization here. The implementation of handleBookieFailure with a different signature is synchronized but this one isn't. It sounds like handleBookieFailure(BookieFailureEvent failure) is invoked outside handleBookieFailure(final BookieSocketAddress addr, final int bookieIndex) and it isn't clear to me if the synchroization as proposed is right. Have you actually checked?

#handleBookieFailure(BookieFailureEvent) doesn't actually mutate any shared state, so it doesn't need to be synchronized. #handleBookieFailure(BookieSocketAddress, int) modifies the failures set, which is the failures that are currently being handled. I could use a concurrentset here, but this is there's no blocking operations in handleBookieFailure in any case, and bookieFailureHandled calls unsetSuccessAndSendWriteRequest, which needs to be synchronized, so I'd prefer to leave it as is. I should rename #handleBookieFailure(BookieFailureEvent) though to avoid confusion.


> On Nov. 12, 2014, 4:33 p.m., fpj wrote:
> > bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java, line 982
> > <https://reviews.apache.org/r/27529/diff/1/?file=747433#file747433line982>
> >
> >     Small suggestion: I'd rather call it tmpMetadata or something similar rather than numbering variables like this.

Will rename. I actually plan to get rid of this code later by extracting version from the LedgerMetadata object completely, but this change was big enough as it was.


- Ivan


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/27529/#review60997
-----------------------------------------------------------


On Nov. 3, 2014, 5:02 p.m., Ivan Kelly wrote:
> 
> -----------------------------------------------------------
> This is an automatically generated e-mail. To reply, visit:
> https://reviews.apache.org/r/27529/
> -----------------------------------------------------------
> 
> (Updated Nov. 3, 2014, 5:02 p.m.)
> 
> 
> Review request for bookkeeper.
> 
> 
> Bugs: BOOKKEEPER-795
>     https://issues.apache.org/jira/browse/BOOKKEEPER-795
> 
> 
> Repository: bookkeeper-git
> 
> 
> Description
> -------
> 
>     Made ledger metadata immutable
>     
>     Ensembles are now ImmutableMap<Long, ImmutableList<BookieSocketAddress>>.
>     The LedgerManager manager interface has changed to avoid implicitly
>     updating the version of a LedgerMetadata object. Recovery, Closing and
>     handling bookie failures have now changed, as there are no longer merge
>     operations. If a write to zookeeper fails, then
>     recovery/closing/failureHandling are retried with the new metadata,
>     provided that assumptions are not broken.
>     
>     The interesting changes are in LedgerHandle and LedgerMetadata.
>     
>     There are a lot of changes from ArrayList -> ImmutableList,List
>     Also a lot of changes from currentEnsemble -> getCurrentEnsemble.
>     
>     One test had to change. With the old code, if someone fenced a ledger,
>     closing would fail. This isn't always the case now. If there's lac of
>     the writing ledger matches the lastEntryId of the new metadata, then
>     close can succeed. ConditionalSetTest has changed to reflect this.
> 
> 
> Diffs
> -----
> 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java 18a801c 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java 3f2580f 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java fe223af 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragment.java 6aadb8a 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java 4501524 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java 7204d6c 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadata.java a20f34a 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java 7ed7aa2 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java 1b92d09 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java e548f3d 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedOp.java af21f44 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java 8de4092 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TryReadLastConfirmedOp.java 01b81c9 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java 0fc8afe 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/CleanupLedgerManager.java a873112 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java 2bc4258 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java 7f2df73 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java 7229028 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java 2510b89 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/BookieLedgerIndexer.java 1b4efaf 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java 02154e5 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/CompactionTest.java ef4cea8 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieRecoveryTest.java f18e159 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieWriteLedgerTest.java 7b77c48 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/ClientUtil.java dc43b2c 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerCloseTest.java eef56b0 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerHandleAdapter.java 9af527a 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerRecoveryTest.java f54cde1 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/SlowBookieTest.java 521d1e3 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerChecker.java eb61c21 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerFragmentReplication.java e4f744f 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java 2a6c71d 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestTryReadLastConfirmed.java ac0afb6 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestWatchEnsembleChange.java eb833a3 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/GcLedgersTest.java 19aab44 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/AuditorPeriodicBookieCheckTest.java 91aae77 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/BookieAutoRecoveryTest.java 72fd11c 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestAutoRecoveryAlongWithBookieServers.java e1ccf68 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestReplicationWorker.java d47e4b1 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java 9662777 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/test/ConditionalSetTest.java a06accd 
> 
> Diff: https://reviews.apache.org/r/27529/diff/
> 
> 
> Testing
> -------
> 
> All tests pass
> 
> 
> Thanks,
> 
> Ivan Kelly
> 
>


--===============1079661107251729795==--

From bookkeeper-dev-return-11587-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 13 13:56:57 2014
Return-Path: <bookkeeper-dev-return-11587-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 86B7DC457
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 13 Nov 2014 13:56:57 +0000 (UTC)
Received: (qmail 65976 invoked by uid 500); 13 Nov 2014 13:56:57 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 65941 invoked by uid 500); 13 Nov 2014 13:56:57 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 65918 invoked by uid 99); 13 Nov 2014 13:56:57 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Nov 2014 13:56:57 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id 2D8D01D30A7;
	Thu, 13 Nov 2014 13:57:00 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============7964213657459446075=="
MIME-Version: 1.0
Subject: Re: Review Request 27529: BOOKKEEPER-795 Race condition causes writes
 to hang if ledger is fences
From: "Ivan Kelly" <ivank@apache.org>
To: fpj@apache.org, "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Thu, 13 Nov 2014 13:57:00 -0000
Message-ID: <20141113135700.11644.26123@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/27529/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
References: <20141103170236.10454.5921@reviews.apache.org>
In-Reply-To: <20141103170236.10454.5921@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>
X-ReviewRequest-Repository: bookkeeper-git

--===============7964213657459446075==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/27529/
-----------------------------------------------------------

(Updated Nov. 13, 2014, 1:56 p.m.)


Review request for bookkeeper.


Changes
-------

new patch addresses flavio's comments, and fixes a findbugs issue.


Bugs: BOOKKEEPER-795
    https://issues.apache.org/jira/browse/BOOKKEEPER-795


Repository: bookkeeper-git


Description
-------

    Made ledger metadata immutable
    
    Ensembles are now ImmutableMap<Long, ImmutableList<BookieSocketAddress>>.
    The LedgerManager manager interface has changed to avoid implicitly
    updating the version of a LedgerMetadata object. Recovery, Closing and
    handling bookie failures have now changed, as there are no longer merge
    operations. If a write to zookeeper fails, then
    recovery/closing/failureHandling are retried with the new metadata,
    provided that assumptions are not broken.
    
    The interesting changes are in LedgerHandle and LedgerMetadata.
    
    There are a lot of changes from ArrayList -> ImmutableList,List
    Also a lot of changes from currentEnsemble -> getCurrentEnsemble.
    
    One test had to change. With the old code, if someone fenced a ledger,
    closing would fail. This isn't always the case now. If there's lac of
    the writing ledger matches the lastEntryId of the new metadata, then
    close can succeed. ConditionalSetTest has changed to reflect this.


Diffs (updated)
-----

  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java 18a801c 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java 3f2580f 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java fe223af 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragment.java 6aadb8a 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java 4501524 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java 7204d6c 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadata.java a20f34a 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java 7ed7aa2 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java 1b92d09 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java e548f3d 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedOp.java af21f44 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java 8de4092 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TryReadLastConfirmedOp.java 01b81c9 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java 0fc8afe 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/CleanupLedgerManager.java a873112 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java 2bc4258 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java 7f2df73 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java 7229028 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java 2510b89 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/BookieLedgerIndexer.java 1b4efaf 
  bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java 02154e5 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/CompactionTest.java ef4cea8 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieRecoveryTest.java f18e159 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieWriteLedgerTest.java 7b77c48 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/ClientUtil.java dc43b2c 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerCloseTest.java eef56b0 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerHandleAdapter.java 9af527a 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerRecoveryTest.java f54cde1 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/SlowBookieTest.java 521d1e3 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerChecker.java eb61c21 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerFragmentReplication.java e4f744f 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java 2a6c71d 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestTryReadLastConfirmed.java ac0afb6 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestWatchEnsembleChange.java eb833a3 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/GcLedgersTest.java 19aab44 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/AuditorPeriodicBookieCheckTest.java 91aae77 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/BookieAutoRecoveryTest.java 72fd11c 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestAutoRecoveryAlongWithBookieServers.java e1ccf68 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestReplicationWorker.java d47e4b1 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java 9662777 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/ConditionalSetTest.java a06accd 

Diff: https://reviews.apache.org/r/27529/diff/


Testing
-------

All tests pass


Thanks,

Ivan Kelly


--===============7964213657459446075==--

From bookkeeper-dev-return-11588-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 13 13:58:34 2014
Return-Path: <bookkeeper-dev-return-11588-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1D289C47B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 13 Nov 2014 13:58:34 +0000 (UTC)
Received: (qmail 77436 invoked by uid 500); 13 Nov 2014 13:58:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 77399 invoked by uid 500); 13 Nov 2014 13:58:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 77387 invoked by uid 99); 13 Nov 2014 13:58:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Nov 2014 13:58:33 +0000
Date: Thu, 13 Nov 2014 13:58:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.490999.1415887113908@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-795:
----------------------------------
    Attachment: 0001-Made-ledger-metadata-immutable.patch

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11589-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 13 14:36:34 2014
Return-Path: <bookkeeper-dev-return-11589-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 12883C674
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 13 Nov 2014 14:36:34 +0000 (UTC)
Received: (qmail 323 invoked by uid 500); 13 Nov 2014 14:36:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 289 invoked by uid 500); 13 Nov 2014 14:36:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 278 invoked by uid 99); 13 Nov 2014 14:36:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Nov 2014 14:36:33 +0000
Date: Thu, 13 Nov 2014 14:36:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.491466.1415889393870@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14209838#comment-14209838 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12681335/0001-Made-ledger-metadata-immutable.patch] downloaded at Thu Nov 13 14:00:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/813/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11590-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 13 16:14:35 2014
Return-Path: <bookkeeper-dev-return-11590-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 00F53CAB9
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 13 Nov 2014 16:14:35 +0000 (UTC)
Received: (qmail 7091 invoked by uid 500); 13 Nov 2014 16:14:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 7063 invoked by uid 500); 13 Nov 2014 16:14:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 7052 invoked by uid 99); 13 Nov 2014 16:14:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Nov 2014 16:14:34 +0000
Date: Thu, 13 Nov 2014 16:14:34 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12678435.1384063961000.492152.1415895274788@Atlassian.JIRA>
In-Reply-To: <JIRA.12678435.1384063961000@Atlassian.JIRA>
References: <JIRA.12678435.1384063961000@Atlassian.JIRA> <JIRA.12678435.1384063961412@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-705) handle session expire event in
 bookie server & bookie watcher
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-705?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14209958#comment-14209958 ] 

Ivan Kelly commented on BOOKKEEPER-705:
---------------------------------------

Over a year later :/

I made an attempt to rebase, but it's not an easy rebase. There's a lot of stuff touched. It would probably be easier to split this in two, one for client and one for bookieside.

> handle session expire event in bookie server & bookie watcher
> -------------------------------------------------------------
>
>                 Key: BOOKKEEPER-705
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-705
>             Project: Bookkeeper
>          Issue Type: Sub-task
>          Components: bookkeeper-client, bookkeeper-server
>            Reporter: Sijie Guo
>            Assignee: Sijie Guo
>             Fix For: 4.4.0
>
>         Attachments: BOOKKEEPER-705.diff
>
>
> handling zookeeper session expire event in bookie server & bookie watcher.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11591-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 13 19:46:35 2014
Return-Path: <bookkeeper-dev-return-11591-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2C232F684
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 13 Nov 2014 19:46:35 +0000 (UTC)
Received: (qmail 24140 invoked by uid 500); 13 Nov 2014 19:46:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 24112 invoked by uid 500); 13 Nov 2014 19:46:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 24096 invoked by uid 99); 13 Nov 2014 19:46:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 13 Nov 2014 19:46:34 +0000
Date: Thu, 13 Nov 2014 19:46:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.493819.1415907994746@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14211205#comment-14211205 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12681335/0001-Made-ledger-metadata-immutable.patch] downloaded at Thu Nov 13 19:10:18 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/814/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11592-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 14 00:56:31 2014
Return-Path: <bookkeeper-dev-return-11592-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D996D105B6
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 14 Nov 2014 00:56:31 +0000 (UTC)
Received: (qmail 52037 invoked by uid 500); 14 Nov 2014 00:56:31 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 52007 invoked by uid 500); 14 Nov 2014 00:56:31 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 51995 invoked by uid 99); 14 Nov 2014 00:56:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 00:56:31 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of guosijie@gmail.com designates 209.85.192.176 as permitted sender)
Received: from [209.85.192.176] (HELO mail-pd0-f176.google.com) (209.85.192.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 00:56:05 +0000
Received: by mail-pd0-f176.google.com with SMTP id ft15so15520426pdb.7
        for <bookkeeper-dev@zookeeper.apache.org>; Thu, 13 Nov 2014 16:56:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=SK9+I/ra9E08Yxc3naSp5fzdFMeXYTFV8MVH32jYcDw=;
        b=1A1EviSNXqvrxAHCTN5Z/EKM02mqux7E+hU3nbmvMzUvJxvAu5FoK3NuXzyaO2t0T3
         XcEjOh3/NjXvyNceRTRU80Sxhvw2AvLZOgTrIph62nEaK0cEUQHUJWrLV0qgR3q8ERc+
         DDjFAj2fIPggBsREcT3OoJMZh3+xPVnZo24uFaj2KlSiJVgTlkZ6Di0K0FLKfAX2iRIp
         PBqvU3PlGXvZIhU5+TmgYk9KJUvktKfbtyjcJnXtVmymxCVW6QgmjLMv2Q70Bn0jvHdQ
         Sf5Kd48/toLAnwaGPFBqfLSuLV5cEay99S/J+Uqe1gUJBTOhhtNnI3AseyxGjAmgQ3PJ
         bTAA==
MIME-Version: 1.0
X-Received: by 10.68.239.71 with SMTP id vq7mr211467pbc.155.1415926563730;
 Thu, 13 Nov 2014 16:56:03 -0800 (PST)
Received: by 10.70.44.106 with HTTP; Thu, 13 Nov 2014 16:56:03 -0800 (PST)
Date: Thu, 13 Nov 2014 16:56:03 -0800
Message-ID: <CAO2yDyZo5AzYgE==k8C5bifA3Miv-2A9w+_-6aS+wa4zxRGcOw@mail.gmail.com>
Subject: Synchronous calls in asynchronous callbacks for bookie auto recovery
From: Sijie Guo <guosijie@gmail.com>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Content-Type: multipart/alternative; boundary=047d7b33da94dbfaf30507c7173b
X-Virus-Checked: Checked by ClamAV on apache.org

--047d7b33da94dbfaf30507c7173b
Content-Type: text/plain; charset=UTF-8

Hi guys:

I am revisiting the auto-recovery code. There were tons of synchronous
calls in asynchronous callbacks (zookeeper/bookkeeper callbacks), which
potentially will block the zookeeper/bookkeeper client worker threads.
Specifically there isn't  asynchronous method for
LedgerUnderreplicationManager interface. This is very bad practice.

Ivan/Rakesh, are you guys aware of this? I am going to make a change to
make it asynchronous. Any objections?

- Sijie

--047d7b33da94dbfaf30507c7173b--

From bookkeeper-dev-return-11593-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 14 02:46:34 2014
Return-Path: <bookkeeper-dev-return-11593-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E3C2210992
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 14 Nov 2014 02:46:33 +0000 (UTC)
Received: (qmail 65898 invoked by uid 500); 14 Nov 2014 02:46:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 65867 invoked by uid 500); 14 Nov 2014 02:46:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 65856 invoked by uid 99); 14 Nov 2014 02:46:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 02:46:33 +0000
Date: Fri, 14 Nov 2014 02:46:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.497047.1415933193713@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14211744#comment-14211744 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12681335/0001-Made-ledger-metadata-immutable.patch] downloaded at Fri Nov 14 02:10:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/815/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11594-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 14 03:43:35 2014
Return-Path: <bookkeeper-dev-return-11594-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D221210AEA
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 14 Nov 2014 03:43:35 +0000 (UTC)
Received: (qmail 39410 invoked by uid 500); 14 Nov 2014 03:43:35 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 39261 invoked by uid 500); 14 Nov 2014 03:43:35 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 38969 invoked by uid 99); 14 Nov 2014 03:43:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 03:43:34 +0000
Date: Fri, 14 Nov 2014 03:43:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.497254.1415936614878@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14211792#comment-14211792 ] 

Hadoop QA commented on BOOKKEEPER-796:
--------------------------------------

Testing JIRA BOOKKEEPER-796


Patch [0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch|https://issues.apache.org/jira/secure/attachment/12680596/0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch] downloaded at Fri Nov 14 02:46:35 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 929
.    Tests failed: 3
.    Tests errors: 8

.    The patch failed the following testcases:

.      testReadTimeout(org.apache.bookkeeper.client.TestReadTimeout)
.      testCloseDuringOp[0](org.apache.bookkeeper.client.BookKeeperTest)
.      testCloseDuringOp[1](org.apache.bookkeeper.client.BookKeeperTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/816/

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11595-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 14 10:48:22 2014
Return-Path: <bookkeeper-dev-return-11595-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1CE65C601
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 14 Nov 2014 10:48:22 +0000 (UTC)
Received: (qmail 99779 invoked by uid 500); 14 Nov 2014 10:48:20 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 99752 invoked by uid 500); 14 Nov 2014 10:48:20 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Delivered-To: moderator for bookkeeper-dev@zookeeper.apache.org
Received: (qmail 95304 invoked by uid 99); 14 Nov 2014 10:45:36 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=5.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=9WR2ZyErAX/Ad9MO8GArPwUsYjh1/7sEfomgeDvZh1o=;
        b=Yy/CahCAX+YSwZBhDbKsaqbCjcxDV6qngAN2PjW1R3Q/Mu63FLPLYiOQ/961XVyd0s
         YeqFGN/GHAzoA/7ZVoSScQGZDmrb9JXE89V6A8tnq/BMq2/bwiOOFTYdGEr+ss3UFyWf
         05vvoUA42x1TvZ2Jl2PTfuCAjH5oIYrpbUzy00U2OyOj9DYxC5LGXTOvnbGQYb8rN05d
         9PpCwD2Xhu93kcgwJ89P8IOBrcGUd/87H9QfOJ7n/LXqottXyPKf3A2NWrMtuyeF4ONE
         oDKZM0vvdeq/K+Eub4jIydHKZfAgMpg+lToeCyUAC39cEJO1v7JfQhyLiTE5/xtljow0
         OLCA==
X-Gm-Message-State: ALoCoQnVXfM4xBXbkYJfoFnQoi5YHTevUixVpNCGNNQNJp+3zhw3aqwqMcmvTZUgXKRx9jl3mDCR
MIME-Version: 1.0
X-Received: by 10.224.10.195 with SMTP id q3mr10740672qaq.8.1415961818081;
 Fri, 14 Nov 2014 02:43:38 -0800 (PST)
X-Originating-IP: [213.27.241.137]
In-Reply-To: <CAO2yDyZo5AzYgE==k8C5bifA3Miv-2A9w+_-6aS+wa4zxRGcOw@mail.gmail.com>
References: <CAO2yDyZo5AzYgE==k8C5bifA3Miv-2A9w+_-6aS+wa4zxRGcOw@mail.gmail.com>
Date: Fri, 14 Nov 2014 11:43:38 +0100
Message-ID: <CAD=ttqTFnMyMpB3q2Y1FFoga6ijyXtuxmOrHupqo-bhwpfRqZw@mail.gmail.com>
Subject: Re: Synchronous calls in asynchronous callbacks for bookie auto recovery
From: Ivan Kelly <ivan@ivankelly.net>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

I wasn't aware of this. No objections to changing it. In fact, I
actively encourage it.

-Ivan

On 14 November 2014 01:56, Sijie Guo <guosijie@gmail.com> wrote:
> Hi guys:
>
> I am revisiting the auto-recovery code. There were tons of synchronous
> calls in asynchronous callbacks (zookeeper/bookkeeper callbacks), which
> potentially will block the zookeeper/bookkeeper client worker threads.
> Specifically there isn't  asynchronous method for
> LedgerUnderreplicationManager interface. This is very bad practice.
>
> Ivan/Rakesh, are you guys aware of this? I am going to make a change to
> make it asynchronous. Any objections?
>
> - Sijie

From bookkeeper-dev-return-11596-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 14 10:55:34 2014
Return-Path: <bookkeeper-dev-return-11596-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 35F9AC649
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 14 Nov 2014 10:55:34 +0000 (UTC)
Received: (qmail 15553 invoked by uid 500); 14 Nov 2014 10:55:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 15517 invoked by uid 500); 14 Nov 2014 10:55:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 15372 invoked by uid 99); 14 Nov 2014 10:55:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 10:55:33 +0000
X-ASF-Spam-Status: No, hits=3.2 required=5.0
	tests=FORGED_YAHOO_RCVD,HTML_MESSAGE,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fpjunqueira@yahoo.com designates 72.30.239.142 as permitted sender)
Received: from [72.30.239.142] (HELO nm32-vm6.bullet.mail.bf1.yahoo.com) (72.30.239.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 10:55:06 +0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s2048; d=yahoo.com;
	b=TUBZ0kAuUsHpiBdAdpnI8PNtapD1FF53tUvBcHtmgj2ftLDwmTFIxhVV4mXeV08RHmgaltwr4c0JDayuLi2Y8MAgNz5DKLzQgD55eZNlKzzO1lNSb9T8WQmizsVW8hNNUuOWKhdJlNan9jcyOLYoiapUuet4skXdrN9pK/KvnxXmQ//MvfN7hKiprv4JeLDoHmO1eJgTlxanlCJ/ALMWQ0aD7tGqwWdNaKirEhRJGNBNrcyTLnXUOMhDYqs5pvCNHDjvz50TGOubJINQBto3x5MJKopKdqFe7qr94kk5x6Ixp0vXBZxCofPEGZ0k+98br8KYV3R56W4h3n/THJEu1A==;
Received: from [98.139.215.143] by nm32.bullet.mail.bf1.yahoo.com with NNFMP; 14 Nov 2014 10:54:02 -0000
Received: from [98.139.212.214] by tm14.bullet.mail.bf1.yahoo.com with NNFMP; 14 Nov 2014 10:54:02 -0000
Received: from [127.0.0.1] by omp1023.mail.bf1.yahoo.com with NNFMP; 14 Nov 2014 10:54:01 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 993577.88528.bm@omp1023.mail.bf1.yahoo.com
X-YMail-OSG: HQGBqpsVM1nbFthsDnhS2bO6TBgJH8nLV3WnJ3_8Uy_WqOTxAF47xBh_CCe5wv4
 X13uYWT7VqA7Bke90JwhhTcSrAi4W97CfNa617BKWQdML2abGA59Sf5hdTf_JEI.cbq2_suc7Men
 wwhGM5ipMTI0yOQuhDW1lfR.OjloydQcdr6_3iNmhNhLSIh6EprAytO6jyiihOPh1NYjjWsHbvOX
 _HU9hZbk.uBz27BAJhRXZ4nnbBCucyMv6k8Sg_ALjoNmnPYGhmO._Leq8dqGqV8dfEFJig3ogW_b
 ihVbj_vwHb_qvYoXwG.eiCOPYY7zy6a.saOfHj44Bnh9sfW_39kj42cbAcDgvk9QfMOZC.LB_RMC
 ijC4b8LgCFBuqAYw7nXlcYomP0Rg9BqM9sI93x_EypMgzp_o5ivz7sDiAhkRKiZ.L9lndwZDmXZD
 yR_laJSRGqrL_SapSC3ZzejEtF7dkvXQUCSIF4wD5sFvBiCd6YcNkdgb1Te3Vki6remU-
Received: by 66.196.80.193; Fri, 14 Nov 2014 10:54:01 +0000 
Date: Fri, 14 Nov 2014 10:54:01 +0000 (UTC)
From: Flavio Junqueira <fpjunqueira@yahoo.com.INVALID>
Reply-To: Flavio Junqueira <fpjunqueira@yahoo.com>
To: 
	"bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Message-ID: <1997452787.608387.1415962441224.JavaMail.yahoo@jws10657.mail.bf1.yahoo.com>
In-Reply-To: <CAD=ttqTFnMyMpB3q2Y1FFoga6ijyXtuxmOrHupqo-bhwpfRqZw@mail.gmail.com>
References: <CAD=ttqTFnMyMpB3q2Y1FFoga6ijyXtuxmOrHupqo-bhwpfRqZw@mail.gmail.com>
Subject: Re: Synchronous calls in asynchronous callbacks for bookie auto
 recovery
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_608386_260348905.1415962441221"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_608386_260348905.1415962441221
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Yeah, I had noticed the synchronous ZK calls. +1 for making them asynchrono=
us.
-Flavio=20

     On Friday, November 14, 2014 10:48 AM, Ivan Kelly <ivan@ivankelly.net>=
 wrote:
  =20
=20

 I wasn't aware of this. No objections to changing it. In fact, I
actively encourage it.

-Ivan

On 14 November 2014 01:56, Sijie Guo <guosijie@gmail.com> wrote:
> Hi guys:
>
> I am revisiting the auto-recovery code. There were tons of synchronous
> calls in asynchronous callbacks (zookeeper/bookkeeper callbacks), which
> potentially will block the zookeeper/bookkeeper client worker threads.
> Specifically there isn't=C2=A0 asynchronous method for
> LedgerUnderreplicationManager interface. This is very bad practice.
>
> Ivan/Rakesh, are you guys aware of this? I am going to make a change to
> make it asynchronous. Any objections?
>
> - Sijie


=20
   
------=_Part_608386_260348905.1415962441221--

From bookkeeper-dev-return-11597-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 14 19:04:24 2014
Return-Path: <bookkeeper-dev-return-11597-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A1F67FB8A
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 14 Nov 2014 19:04:24 +0000 (UTC)
Received: (qmail 76454 invoked by uid 500); 14 Nov 2014 19:04:24 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 76420 invoked by uid 500); 14 Nov 2014 19:04:24 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 76401 invoked by uid 99); 14 Nov 2014 19:04:24 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 14 Nov 2014 19:04:24 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id 0D99C1155B9;
	Fri, 14 Nov 2014 19:04:24 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============9058675723382163821=="
MIME-Version: 1.0
Subject: Re: Review Request 27529: BOOKKEEPER-795 Race condition causes writes
 to hang if ledger is fences
From: fpj@apache.org
To: fpj@apache.org, "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Fri, 14 Nov 2014 19:04:24 -0000
Message-ID: <20141114190424.1251.81562@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: noreply@reviews.apache.org
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/27529/
X-Sender: noreply@reviews.apache.org
References: <20141112163324.19819.11837@reviews.apache.org>
In-Reply-To: <20141112163324.19819.11837@reviews.apache.org>
Reply-To: fpj@apache.org
X-ReviewRequest-Repository: bookkeeper-git

--===============9058675723382163821==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit



> On Nov. 12, 2014, 4:33 p.m., fpj wrote:
> > I quite like the changes here, they make sense to me. I just have one clarification question and a small suggestion below.

I'm happy with the changes. Any other comment here or should I get this in?


> On Nov. 12, 2014, 4:33 p.m., fpj wrote:
> > bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java, line 888
> > <https://reviews.apache.org/r/27529/diff/1/?file=747433#file747433line888>
> >
> >     I'm a bit confused by the synchronization here. The implementation of handleBookieFailure with a different signature is synchronized but this one isn't. It sounds like handleBookieFailure(BookieFailureEvent failure) is invoked outside handleBookieFailure(final BookieSocketAddress addr, final int bookieIndex) and it isn't clear to me if the synchroization as proposed is right. Have you actually checked?
> 
> Ivan Kelly wrote:
>     #handleBookieFailure(BookieFailureEvent) doesn't actually mutate any shared state, so it doesn't need to be synchronized. #handleBookieFailure(BookieSocketAddress, int) modifies the failures set, which is the failures that are currently being handled. I could use a concurrentset here, but this is there's no blocking operations in handleBookieFailure in any case, and bookieFailureHandled calls unsetSuccessAndSendWriteRequest, which needs to be synchronized, so I'd prefer to leave it as is. I should rename #handleBookieFailure(BookieFailureEvent) though to avoid confusion.

Renaming sounds like a good idea indeed to avoid confusion.


- fpj


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/27529/#review60997
-----------------------------------------------------------


On Nov. 13, 2014, 1:56 p.m., Ivan Kelly wrote:
> 
> -----------------------------------------------------------
> This is an automatically generated e-mail. To reply, visit:
> https://reviews.apache.org/r/27529/
> -----------------------------------------------------------
> 
> (Updated Nov. 13, 2014, 1:56 p.m.)
> 
> 
> Review request for bookkeeper.
> 
> 
> Bugs: BOOKKEEPER-795
>     https://issues.apache.org/jira/browse/BOOKKEEPER-795
> 
> 
> Repository: bookkeeper-git
> 
> 
> Description
> -------
> 
>     Made ledger metadata immutable
>     
>     Ensembles are now ImmutableMap<Long, ImmutableList<BookieSocketAddress>>.
>     The LedgerManager manager interface has changed to avoid implicitly
>     updating the version of a LedgerMetadata object. Recovery, Closing and
>     handling bookie failures have now changed, as there are no longer merge
>     operations. If a write to zookeeper fails, then
>     recovery/closing/failureHandling are retried with the new metadata,
>     provided that assumptions are not broken.
>     
>     The interesting changes are in LedgerHandle and LedgerMetadata.
>     
>     There are a lot of changes from ArrayList -> ImmutableList,List
>     Also a lot of changes from currentEnsemble -> getCurrentEnsemble.
>     
>     One test had to change. With the old code, if someone fenced a ledger,
>     closing would fail. This isn't always the case now. If there's lac of
>     the writing ledger matches the lastEntryId of the new metadata, then
>     close can succeed. ConditionalSetTest has changed to reflect this.
> 
> 
> Diffs
> -----
> 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java 18a801c 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java 3f2580f 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java fe223af 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragment.java 6aadb8a 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java 4501524 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java 7204d6c 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadata.java a20f34a 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java 7ed7aa2 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java 1b92d09 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java e548f3d 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedOp.java af21f44 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java 8de4092 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TryReadLastConfirmedOp.java 01b81c9 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java 0fc8afe 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/CleanupLedgerManager.java a873112 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java 2bc4258 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java 7f2df73 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java 7229028 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java 2510b89 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/BookieLedgerIndexer.java 1b4efaf 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java 02154e5 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/CompactionTest.java ef4cea8 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieRecoveryTest.java f18e159 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieWriteLedgerTest.java 7b77c48 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/ClientUtil.java dc43b2c 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerCloseTest.java eef56b0 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerHandleAdapter.java 9af527a 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerRecoveryTest.java f54cde1 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/SlowBookieTest.java 521d1e3 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerChecker.java eb61c21 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerFragmentReplication.java e4f744f 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java 2a6c71d 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestTryReadLastConfirmed.java ac0afb6 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestWatchEnsembleChange.java eb833a3 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/GcLedgersTest.java 19aab44 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/AuditorPeriodicBookieCheckTest.java 91aae77 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/BookieAutoRecoveryTest.java 72fd11c 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestAutoRecoveryAlongWithBookieServers.java e1ccf68 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestReplicationWorker.java d47e4b1 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java 9662777 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/test/ConditionalSetTest.java a06accd 
> 
> Diff: https://reviews.apache.org/r/27529/diff/
> 
> 
> Testing
> -------
> 
> All tests pass
> 
> 
> Thanks,
> 
> Ivan Kelly
> 
>


--===============9058675723382163821==--

From bookkeeper-dev-return-11598-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 15 01:53:00 2014
Return-Path: <bookkeeper-dev-return-11598-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 53252105C9
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 15 Nov 2014 01:53:00 +0000 (UTC)
Received: (qmail 1188 invoked by uid 500); 15 Nov 2014 01:53:00 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 1153 invoked by uid 500); 15 Nov 2014 01:53:00 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 1135 invoked by uid 99); 15 Nov 2014 01:52:59 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Nov 2014 01:52:59 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id A383110BDAC;
	Sat, 15 Nov 2014 01:52:59 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============1366304076795695908=="
MIME-Version: 1.0
Subject: Re: Review Request 27529: BOOKKEEPER-795 Race condition causes writes
 to hang if ledger is fences
From: "Sijie Guo" <guosijie@gmail.com>
To: "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>,
 "Sijie Guo" <guosijie@gmail.com>
Date: Sat, 15 Nov 2014 01:52:59 -0000
Message-ID: <20141115015259.1251.40883@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Sijie Guo" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/27529/
X-Sender: "Sijie Guo" <noreply@reviews.apache.org>
References: <20141113135700.11644.26123@reviews.apache.org>
In-Reply-To: <20141113135700.11644.26123@reviews.apache.org>
Reply-To: "Sijie Guo" <guosijie@gmail.com>
X-ReviewRequest-Repository: bookkeeper-git

--===============1366304076795695908==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/27529/#review61600
-----------------------------------------------------------


I will review this over this weekend.

- Sijie Guo


On Nov. 13, 2014, 1:56 p.m., Ivan Kelly wrote:
> 
> -----------------------------------------------------------
> This is an automatically generated e-mail. To reply, visit:
> https://reviews.apache.org/r/27529/
> -----------------------------------------------------------
> 
> (Updated Nov. 13, 2014, 1:56 p.m.)
> 
> 
> Review request for bookkeeper.
> 
> 
> Bugs: BOOKKEEPER-795
>     https://issues.apache.org/jira/browse/BOOKKEEPER-795
> 
> 
> Repository: bookkeeper-git
> 
> 
> Description
> -------
> 
>     Made ledger metadata immutable
>     
>     Ensembles are now ImmutableMap<Long, ImmutableList<BookieSocketAddress>>.
>     The LedgerManager manager interface has changed to avoid implicitly
>     updating the version of a LedgerMetadata object. Recovery, Closing and
>     handling bookie failures have now changed, as there are no longer merge
>     operations. If a write to zookeeper fails, then
>     recovery/closing/failureHandling are retried with the new metadata,
>     provided that assumptions are not broken.
>     
>     The interesting changes are in LedgerHandle and LedgerMetadata.
>     
>     There are a lot of changes from ArrayList -> ImmutableList,List
>     Also a lot of changes from currentEnsemble -> getCurrentEnsemble.
>     
>     One test had to change. With the old code, if someone fenced a ledger,
>     closing would fail. This isn't always the case now. If there's lac of
>     the writing ledger matches the lastEntryId of the new metadata, then
>     close can succeed. ConditionalSetTest has changed to reflect this.
> 
> 
> Diffs
> -----
> 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java 18a801c 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java 3f2580f 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java fe223af 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragment.java 6aadb8a 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java 4501524 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java 7204d6c 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadata.java a20f34a 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java 7ed7aa2 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java 1b92d09 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java e548f3d 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedOp.java af21f44 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java 8de4092 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TryReadLastConfirmedOp.java 01b81c9 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java 0fc8afe 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/CleanupLedgerManager.java a873112 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java 2bc4258 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java 7f2df73 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java 7229028 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java 2510b89 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/BookieLedgerIndexer.java 1b4efaf 
>   bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java 02154e5 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/CompactionTest.java ef4cea8 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieRecoveryTest.java f18e159 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieWriteLedgerTest.java 7b77c48 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/ClientUtil.java dc43b2c 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerCloseTest.java eef56b0 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerHandleAdapter.java 9af527a 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerRecoveryTest.java f54cde1 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/SlowBookieTest.java 521d1e3 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerChecker.java eb61c21 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestLedgerFragmentReplication.java e4f744f 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestSpeculativeRead.java 2a6c71d 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestTryReadLastConfirmed.java ac0afb6 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestWatchEnsembleChange.java eb833a3 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/GcLedgersTest.java 19aab44 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/AuditorPeriodicBookieCheckTest.java 91aae77 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/BookieAutoRecoveryTest.java 72fd11c 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestAutoRecoveryAlongWithBookieServers.java e1ccf68 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/TestReplicationWorker.java d47e4b1 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java 9662777 
>   bookkeeper-server/src/test/java/org/apache/bookkeeper/test/ConditionalSetTest.java a06accd 
> 
> Diff: https://reviews.apache.org/r/27529/diff/
> 
> 
> Testing
> -------
> 
> All tests pass
> 
> 
> Thanks,
> 
> Ivan Kelly
> 
>


--===============1366304076795695908==--

From bookkeeper-dev-return-11599-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 15 17:06:37 2014
Return-Path: <bookkeeper-dev-return-11599-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D986AC75F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 15 Nov 2014 17:06:37 +0000 (UTC)
Received: (qmail 61991 invoked by uid 500); 15 Nov 2014 17:06:37 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 61961 invoked by uid 500); 15 Nov 2014 17:06:37 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 61949 invoked by uid 99); 15 Nov 2014 17:06:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Nov 2014 17:06:37 +0000
X-ASF-Spam-Status: No, hits=3.2 required=5.0
	tests=FORGED_YAHOO_RCVD,HTML_MESSAGE,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fpjunqueira@yahoo.com designates 98.139.212.179 as permitted sender)
Received: from [98.139.212.179] (HELO nm20.bullet.mail.bf1.yahoo.com) (98.139.212.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 15 Nov 2014 17:06:08 +0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s2048; d=yahoo.com;
	b=YXDxvEe3Ai8wabmja93xj/Ca2GIpMHQDFQsxRTPLi5I8Dry60NGCtRVMdjWd/bYvuF/mnEXkGh4cF7xhzhgRHQPEv9+lZspIVLVcaCxGdNmrtxBTjK79IaANA3SrQIWjApFQCmtm+t1usvHdiC2sIfT20P8Bvu+KYIajALA7SNhxN32aUJy0BHNw3r3RU2xp5y3kSp5MCOglgXtmmu+w7Or6bubTl/uJo7yPLOExYfDhQ4P/FPmiu/fDpNHX9PHZxlhfZVcDwFyMJPO8p0PO5ZTSW8lRIPIThYGdlMA7dONQPZ/s2RU2ZOtIRMIrvY2XdzGhQGvA3aeIB9DX0/Stow==;
Received: from [66.196.81.173] by nm20.bullet.mail.bf1.yahoo.com with NNFMP; 15 Nov 2014 17:04:01 -0000
Received: from [98.139.211.160] by tm19.bullet.mail.bf1.yahoo.com with NNFMP; 15 Nov 2014 17:04:01 -0000
Received: from [127.0.0.1] by smtp217.mail.bf1.yahoo.com with NNFMP; 15 Nov 2014 17:04:01 -0000
X-Yahoo-Newman-Id: 29718.13739.bm@smtp217.mail.bf1.yahoo.com
X-Yahoo-Newman-Property: ymail-3
X-YMail-OSG: LAzvKEoVM1mzXUXhYWp7E1t8eEFBjTzBnha7wGIqi8ON8aD
 rFAmx6aBDaRIh8xYrVr39AYZSx3kd5ZD7OC.lip0JjXy4BjBGKvkJxXjS5ts
 15uhInUmTztfyVYvq2GwnY7EzPlsN_nrWDoJRWqUf6ACWjIHnz2cuXwwEQAv
 TJIcwE71gg5jo.IQ9uGNbXeQ961_Q3GNui2yTiYY5.DWco.hOaWRXgnPizhE
 eeOW_Oi8j37gGQsMwHoqi.uP8YckOA74UWIR3sHxcg8w3UfBAM3wpI85edxF
 AG4r4Cxk1qP9x3G7_17qrDIVo5Tjx_BLyv_gy_bmFsxDIwhZ2JfL6JIa7CP1
 emb8B3uaTbhjJlqeEoys08zw05SXp1VD4MkIks0KuU.CZP14i3l7.AC1BWI5
 ug9s9ADA282EjKHfHs93SB94inGjJ7ID5pIWDo8U7Xv8cY4AdOWvxL4yZNNQ
 7SVP4DTX2cxODEv_g9LpXiXAhJCOkE5fV3v0XQF77NFTZdQ_JXA4bswnEpE6
 8zGqohQunR9zt_DFZPerBQoNXFA--
X-Yahoo-SMTP: HT5UJDeswBACWJPOeualxAa.da..S.fl
From: Flavio Junqueira <fpjunqueira@yahoo.com.INVALID>
Content-Type: multipart/alternative; boundary="Apple-Mail=_DD8EB9E7-A646-46D6-A10C-9544B1AF1C96"
Subject: NativeIO?
Message-Id: <AF30767E-4DBF-4F6D-A2B9-25EB8D19945D@yahoo.com>
Date: Sat, 15 Nov 2014 17:03:58 +0000
To: bookkeeper-dev <bookkeeper-dev@zookeeper.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 7.3 \(1878.6\))
X-Mailer: Apple Mail (2.1878.6)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail=_DD8EB9E7-A646-46D6-A10C-9544B1AF1C96
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=us-ascii

I just noticed this message when running on my mac laptop:

[BookieJournal-3183:NativeIO@43] - Unable to link C library. Native =
methods will be disabled.

Is it correct that I shouldn't have the expected posix calls or is it a =
problem with my installation, does anyone know?

-Flavio

--Apple-Mail=_DD8EB9E7-A646-46D6-A10C-9544B1AF1C96--

From bookkeeper-dev-return-11600-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov 16 06:27:34 2014
Return-Path: <bookkeeper-dev-return-11600-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0F33E101A4
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun, 16 Nov 2014 06:27:34 +0000 (UTC)
Received: (qmail 67515 invoked by uid 500); 16 Nov 2014 06:27:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 67479 invoked by uid 500); 16 Nov 2014 06:27:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 67468 invoked by uid 99); 16 Nov 2014 06:27:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 16 Nov 2014 06:27:33 +0000
Date: Sun, 16 Nov 2014 06:27:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.510194.1416119253777@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14213866#comment-14213866 ] 

Hadoop QA commented on BOOKKEEPER-796:
--------------------------------------

Testing JIRA BOOKKEEPER-796


Patch [0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch|https://issues.apache.org/jira/secure/attachment/12680596/0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch] downloaded at Sun Nov 16 05:30:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 929
.    Tests failed: 2
.    Tests errors: 6

.    The patch failed the following testcases:

.      testCloseDuringOp[0](org.apache.bookkeeper.client.BookKeeperTest)
.      testCloseDuringOp[1](org.apache.bookkeeper.client.BookKeeperTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/817/

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11601-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov 16 07:04:33 2014
Return-Path: <bookkeeper-dev-return-11601-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DAC4610289
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun, 16 Nov 2014 07:04:33 +0000 (UTC)
Received: (qmail 93355 invoked by uid 500); 16 Nov 2014 07:04:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 93320 invoked by uid 500); 16 Nov 2014 07:04:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 93309 invoked by uid 99); 16 Nov 2014 07:04:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 16 Nov 2014 07:04:33 +0000
Date: Sun, 16 Nov 2014 07:04:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.510303.1416121473712@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14213874#comment-14213874 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12681335/0001-Made-ledger-metadata-immutable.patch] downloaded at Sun Nov 16 06:27:57 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/818/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11602-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 17 11:17:38 2014
Return-Path: <bookkeeper-dev-return-11602-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B0AF7C473
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 17 Nov 2014 11:17:38 +0000 (UTC)
Received: (qmail 18931 invoked by uid 500); 17 Nov 2014 11:17:38 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 18902 invoked by uid 500); 17 Nov 2014 11:17:38 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 18891 invoked by uid 99); 17 Nov 2014 11:17:38 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Nov 2014 11:17:38 +0000
Received: from mail-lb0-f175.google.com (mail-lb0-f175.google.com [209.85.217.175])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id F1F141A02B8
	for <bookkeeper-dev@zookeeper.apache.org>; Mon, 17 Nov 2014 11:16:33 +0000 (UTC)
Received: by mail-lb0-f175.google.com with SMTP id n15so16035925lbi.34
        for <bookkeeper-dev@zookeeper.apache.org>; Mon, 17 Nov 2014 03:17:34 -0800 (PST)
X-Gm-Message-State: ALoCoQl6POip57GTgoE9uB4ZNs3Js2TimIjtDU+crAjvD1yrJUvd4bKbhjzJAosQVwXK3307B6LA
MIME-Version: 1.0
X-Received: by 10.112.63.70 with SMTP id e6mr9206438lbs.93.1416223054112; Mon,
 17 Nov 2014 03:17:34 -0800 (PST)
Received: by 10.112.31.47 with HTTP; Mon, 17 Nov 2014 03:17:34 -0800 (PST)
X-Originating-IP: [213.27.241.137]
In-Reply-To: <AF30767E-4DBF-4F6D-A2B9-25EB8D19945D@yahoo.com>
References: <AF30767E-4DBF-4F6D-A2B9-25EB8D19945D@yahoo.com>
Date: Mon, 17 Nov 2014 12:17:34 +0100
Message-ID: <CAD=ttqQXZLt5ksaG6KYiMrfzJZEuRJ6mBnNrJGx5-cTSePu7aA@mail.gmail.com>
Subject: Re: NativeIO?
From: Ivan Kelly <ivank@apache.org>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Content-Type: text/plain; charset=UTF-8

NativeIO is linux only i think, I don't think mac's have fadvise.

-Ivan

On 15 November 2014 18:03, Flavio Junqueira
<fpjunqueira@yahoo.com.invalid> wrote:
> I just noticed this message when running on my mac laptop:
>
> [BookieJournal-3183:NativeIO@43] - Unable to link C library. Native methods will be disabled.
>
> Is it correct that I shouldn't have the expected posix calls or is it a problem with my installation, does anyone know?
>
> -Flavio

From bookkeeper-dev-return-11603-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 17 12:27:21 2014
Return-Path: <bookkeeper-dev-return-11603-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7FC6AC65F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 17 Nov 2014 12:27:21 +0000 (UTC)
Received: (qmail 27814 invoked by uid 500); 17 Nov 2014 12:27:21 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 27778 invoked by uid 500); 17 Nov 2014 12:27:21 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 27762 invoked by uid 99); 17 Nov 2014 12:27:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Nov 2014 12:27:21 +0000
X-ASF-Spam-Status: No, hits=3.2 required=5.0
	tests=FORGED_YAHOO_RCVD,HTML_MESSAGE,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fpjunqueira@yahoo.com designates 98.139.212.181 as permitted sender)
Received: from [98.139.212.181] (HELO nm22.bullet.mail.bf1.yahoo.com) (98.139.212.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Nov 2014 12:26:52 +0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s2048; d=yahoo.com;
	b=DVx79bcqicTsKKwhZ9joVCLsvBB5gdl+PnZ9cIZwkcfl7urbxlJRC/yiuSneiJzbHPCf2ljx+e9IU+sUc9oc4L6fiW1UDyVNIZxmJvtCl2QeEY+WXCBxK+XNJ39x+JCnYIM6Ysjqt/lr6dkvcmwmE4I42rfgWFsvZNNCNZFQIgJCNpCRZl3OUaWnqRKF0Jn86KJxKHL7oOTAPns2vw+DZJdcLKdbo+IvOu1HXmacI73kNi8ZlMVV6q0bzodHjuziqF++5F/zMsfA/5MN7WwhPTAb5rPBiTcvbliO70qBUzgj/diIIvak+LYIf3E/FFUbyLDsDOdqx25vmlf77l70Ag==;
Received: from [98.139.215.141] by nm22.bullet.mail.bf1.yahoo.com with NNFMP; 17 Nov 2014 12:25:48 -0000
Received: from [98.139.212.200] by tm12.bullet.mail.bf1.yahoo.com with NNFMP; 17 Nov 2014 12:25:48 -0000
Received: from [127.0.0.1] by omp1009.mail.bf1.yahoo.com with NNFMP; 17 Nov 2014 12:25:48 -0000
X-Yahoo-Newman-Property: ymail-5
X-Yahoo-Newman-Id: 54669.7897.bm@omp1009.mail.bf1.yahoo.com
X-YMail-OSG: z98vcaQVM1kRGmQ_XL9Ee3yeQjqrMVEYJ0M66h4p904YdbtkLAgOPqi7IAO9SLm
 oq1jHMMOoSNG.c1rOnKJMhyNfu7YBVtNC9CKNN5zUyuSXaT0caMRhCLYP2vusqEMXiwwlUu4QYU_
 1DKElqaJ199CnKNjWj7tsvX11cNVFXGlnwzfpdZfncO_KtyKXw_hQMjQqnEpg7jitVj4BMG6g3ma
 tzzEOOQ0Qjh..CsXGHQmHlFKGRd2XRjkkOyEdnCBtNCoDpkdJNifRUmfOCcbA06zjBcUuBtcXoNo
 t.F2FdOfDKD.IrEwqgMq5LsPX_5p7VFwHOWB38HEhoVRWmM1SUR1bPrIzEG_fm_YtQpvq.9NxPmm
 RPG.iSs87cHWC4TqxbSQoj7wjb9OSDqdS6CT5yotw0wEsHt6gH7AYhRyn9br1O5Gx.pevjZK2abR
 2f.7mNYRU5gpvCfKBRNazXxGgd.jvEU2iFOjBs.9K29GzmwSi0RZScRm2RRP3yLQI8q4-
Received: by 66.196.81.106; Mon, 17 Nov 2014 12:25:47 +0000 
Date: Mon, 17 Nov 2014 12:25:38 +0000 (UTC)
From: Flavio Junqueira <fpjunqueira@yahoo.com.INVALID>
Reply-To: Flavio Junqueira <fpjunqueira@yahoo.com>
To: 
	"bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Message-ID: <296359416.1340360.1416227139000.JavaMail.yahoo@jws106116.mail.bf1.yahoo.com>
In-Reply-To: <CAD=ttqQXZLt5ksaG6KYiMrfzJZEuRJ6mBnNrJGx5-cTSePu7aA@mail.gmail.com>
References: <CAD=ttqQXZLt5ksaG6KYiMrfzJZEuRJ6mBnNrJGx5-cTSePu7aA@mail.gmail.com>
Subject: Re: NativeIO?
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1340358_1530981968.1416227138996"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1340358_1530981968.1416227138996
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

Right, that's what it looks like. I was reading that it is supposed to be posix compliant but not 100%, and I suppose these calls are in the missing part.
-Flavio 

     On Monday, November 17, 2014 11:17 AM, Ivan Kelly <ivank@apache.org> wrote:
   
 

 NativeIO is linux only i think, I don't think mac's have fadvise.

-Ivan

On 15 November 2014 18:03, Flavio Junqueira
<fpjunqueira@yahoo.com.invalid> wrote:
> I just noticed this message when running on my mac laptop:
>
> [BookieJournal-3183:NativeIO@43] - Unable to link C library. Native methods will be disabled.
>
> Is it correct that I shouldn't have the expected posix calls or is it a problem with my installation, does anyone know?
>
> -Flavio


 
    
------=_Part_1340358_1530981968.1416227138996--

From bookkeeper-dev-return-11604-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 17 14:58:21 2014
Return-Path: <bookkeeper-dev-return-11604-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A8F9ECC3A
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 17 Nov 2014 14:58:21 +0000 (UTC)
Received: (qmail 80369 invoked by uid 500); 17 Nov 2014 14:58:21 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 80334 invoked by uid 500); 17 Nov 2014 14:58:21 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 80318 invoked by uid 99); 17 Nov 2014 14:58:21 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Nov 2014 14:58:21 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id C3E2F1D398B;
	Mon, 17 Nov 2014 14:58:20 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============9121495477359423750=="
MIME-Version: 1.0
Subject: Review Request 28119: Documentation: The bookkeeper protocol
From: "Ivan Kelly" <ivank@apache.org>
To: "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Mon, 17 Nov 2014 14:58:20 -0000
Message-ID: <20141117145820.24716.70296@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/28119/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>

--===============9121495477359423750==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/28119/
-----------------------------------------------------------

Review request for bookkeeper.


Description
-------

A high level description of the bookkeeper protocol and the guarantees we provide.

I'll put this into textile before submitting, but I wanted to leave it in a more text readable format for review.


Diffs
-----


Diff: https://reviews.apache.org/r/28119/diff/


Testing
-------


File Attachments
----------------

bk_protocol.txt
  https://reviews.apache.org/media/uploaded/files/2014/11/17/f47f48e9-c284-4473-b4e9-584b24af7a14__bk_protocol.txt


Thanks,

Ivan Kelly


--===============9121495477359423750==--

From bookkeeper-dev-return-11605-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 17 16:23:20 2014
Return-Path: <bookkeeper-dev-return-11605-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 268DDCF9D
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 17 Nov 2014 16:23:20 +0000 (UTC)
Received: (qmail 35597 invoked by uid 500); 17 Nov 2014 16:23:19 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 35563 invoked by uid 500); 17 Nov 2014 16:23:19 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 35542 invoked by uid 99); 17 Nov 2014 16:23:19 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 17 Nov 2014 16:23:19 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id C56EE1D398B;
	Mon, 17 Nov 2014 16:23:18 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============6673812144413617714=="
MIME-Version: 1.0
Subject: Re: Review Request 28119: Documentation: The bookkeeper protocol
From: "Ivan Kelly" <ivank@apache.org>
To: "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Mon, 17 Nov 2014 16:23:18 -0000
Message-ID: <20141117162318.24716.61108@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/28119/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
References: <20141117145820.24716.70296@reviews.apache.org>
In-Reply-To: <20141117145820.24716.70296@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>

--===============6673812144413617714==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/28119/#review61733
-----------------------------------------------------------



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment54>

    I really should have spellchecked :/


- Ivan Kelly


On Nov. 17, 2014, 2:58 p.m., Ivan Kelly wrote:
> 
> -----------------------------------------------------------
> This is an automatically generated e-mail. To reply, visit:
> https://reviews.apache.org/r/28119/
> -----------------------------------------------------------
> 
> (Updated Nov. 17, 2014, 2:58 p.m.)
> 
> 
> Review request for bookkeeper.
> 
> 
> Description
> -------
> 
> A high level description of the bookkeeper protocol and the guarantees we provide.
> 
> I'll put this into textile before submitting, but I wanted to leave it in a more text readable format for review.
> 
> 
> Diffs
> -----
> 
> 
> Diff: https://reviews.apache.org/r/28119/diff/
> 
> 
> Testing
> -------
> 
> 
> File Attachments
> ----------------
> 
> bk_protocol.txt
>   https://reviews.apache.org/media/uploaded/files/2014/11/17/f47f48e9-c284-4473-b4e9-584b24af7a14__bk_protocol.txt
> 
> 
> Thanks,
> 
> Ivan Kelly
> 
>


--===============6673812144413617714==--

From bookkeeper-dev-return-11606-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 18 22:36:34 2014
Return-Path: <bookkeeper-dev-return-11606-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B5DD910D5B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 18 Nov 2014 22:36:34 +0000 (UTC)
Received: (qmail 28737 invoked by uid 500); 18 Nov 2014 22:36:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 28703 invoked by uid 500); 18 Nov 2014 22:36:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 28660 invoked by uid 99); 18 Nov 2014 22:36:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 18 Nov 2014 22:36:34 +0000
Date: Tue, 18 Nov 2014 22:36:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.529484.1416350194542@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14216944#comment-14216944 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12681335/0001-Made-ledger-metadata-immutable.patch] downloaded at Tue Nov 18 21:59:56 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/819/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11607-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 12:45:15 2014
Return-Path: <bookkeeper-dev-return-11607-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7788810B06
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 12:45:15 +0000 (UTC)
Received: (qmail 1978 invoked by uid 500); 19 Nov 2014 12:45:15 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 1962 invoked by uid 500); 19 Nov 2014 12:45:15 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 1949 invoked by uid 99); 19 Nov 2014 12:45:14 -0000
Received: from crius.apache.org (HELO crius) (140.211.11.14)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 12:45:14 +0000
Received: from crius.apache.org (localhost [127.0.0.1])
	by crius (Postfix) with ESMTP id A404DE00A1F
	for <bookkeeper-dev@zookeeper.apache.org>; Wed, 19 Nov 2014 12:45:13 +0000 (UTC)
Date: Wed, 19 Nov 2014 12:45:10 +0000 (UTC)
From: Apache Jenkins Server  <jenkins@builds.apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <1519301181.8113.1416401110097.JavaMail.jenkins@crius>
Subject: Build failed in Jenkins: bookkeeper-trunk #854
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: bookkeeper-trunk
X-Jenkins-Result: FAILURE

See <https://builds.apache.org/job/bookkeeper-trunk/854/>

------------------------------------------
[...truncated 1133 lines...]
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.808 sec
Running org.apache.hedwig.server.persistence.TestBookkeeperPersistenceManagerWhiteBox
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.181 sec
Running org.apache.hedwig.server.persistence.TestLocalDBPersistenceManagerBlackBox
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.712 sec
Running org.apache.hedwig.server.TestBackwardCompat
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.354 sec
Running org.apache.hedwig.server.delivery.TestThrottlingDelivery
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 22.887 sec
Running org.apache.hedwig.server.delivery.TestFIFODeliveryManager
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.512 sec
Running org.apache.hedwig.server.filter.TestMessageFilter
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 8.139 sec
Running org.apache.hedwig.server.meta.TestFactoryLayout
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.926 sec
Running org.apache.hedwig.server.meta.TestMetadataManager
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.406 sec
Running org.apache.hedwig.server.meta.TestMetadataManagerFactory
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.706 sec
Running org.apache.hedwig.server.topics.TestTopicBasedLoadShedder
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.248 sec
Running org.apache.hedwig.server.topics.TestZkTopicManager
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 14.861 sec
Running org.apache.hedwig.server.topics.TestMMTopicManager
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 29.682 sec
Running org.apache.hedwig.server.topics.TestHubInfo
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.282 sec
Running org.apache.hedwig.server.topics.TestHubLoad
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.271 sec
Running org.apache.hedwig.server.topics.TestConcurrentTopicAcquisition
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 7.2 sec
Running org.apache.hedwig.server.integration.TestHedwigRegion
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 126.749 sec
Running org.apache.hedwig.server.integration.TestHedwigHubProxy
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 39.158 sec
Running org.apache.hedwig.server.integration.TestHedwigHubSSL
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 66.22 sec
Running org.apache.hedwig.server.integration.TestHedwigHubRegular
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 37.785 sec
Running org.apache.hedwig.client.TestPubSubClient
Tests run: 36, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 33.273 sec
Running org.apache.hedwig.client.netty.TestMultiplexing
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 21.83 sec
Running org.apache.hedwig.client.TestSubAfterCloseSub
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.842 sec

Results :

Tests run: 317, Failures: 0, Errors: 0, Skipped: 0

[INFO] 
[INFO] --- maven-jar-plugin:2.3.1:jar (default-jar) @ hedwig-server ---
[INFO] Building jar: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/target/hedwig-server-4.4.0-SNAPSHOT.jar>
[INFO] 
[INFO] --- maven-dependency-plugin:2.8:copy-dependencies (default) @ hedwig-server ---
[INFO] Copying junit-4.8.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/junit-4.8.1.jar>
[INFO] Copying zookeeper-3.4.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/zookeeper-3.4.6.jar>
[INFO] Copying derby-10.8.2.2.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/derby-10.8.2.2.jar>
[INFO] Copying bookkeeper-server-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-server-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-logging-1.1.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-logging-1.1.1.jar>
[INFO] Copying slf4j-api-1.6.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/slf4j-api-1.6.4.jar>
[INFO] Copying commons-lang-2.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-lang-2.4.jar>
[INFO] Copying slf4j-log4j12-1.6.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/slf4j-log4j12-1.6.4.jar>
[INFO] Copying commons-collections-3.2.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-collections-3.2.1.jar>
[INFO] Copying hedwig-server-compat420-4.2.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat420-4.2.0.jar>
[INFO] Copying jline-0.9.94.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/jline-0.9.94.jar>
[INFO] Copying commons-beanutils-1.7.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-beanutils-1.7.0.jar>
[INFO] Copying bookkeeper-stats-api-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-stats-api-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-io-2.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-io-2.1.jar>
[INFO] Copying zookeeper-3.4.6-tests.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/zookeeper-3.4.6-tests.jar>
[INFO] Copying log4j-1.2.15.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/log4j-1.2.15.jar>
[INFO] Copying commons-configuration-1.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-configuration-1.6.jar>
[INFO] Copying commons-digester-1.8.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-digester-1.8.jar>
[INFO] Copying guava-13.0.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/guava-13.0.1.jar>
[INFO] Copying netty-3.9.4.Final.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/netty-3.9.4.Final.jar>
[INFO] Copying hedwig-client-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-client-4.4.0-SNAPSHOT.jar>
[INFO] Copying bookkeeper-server-4.4.0-SNAPSHOT-tests.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-server-4.4.0-SNAPSHOT-tests.jar>
[INFO] Copying hedwig-protocol-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-protocol-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-beanutils-core-1.8.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-beanutils-core-1.8.0.jar>
[INFO] Copying hedwig-server-compat400-4.0.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat400-4.0.0.jar>
[INFO] Copying jna-3.2.7.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/jna-3.2.7.jar>
[INFO] Copying hedwig-server-compat410-4.1.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat410-4.1.0.jar>
[INFO] Copying commons-cli-1.2.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-cli-1.2.jar>
[INFO] Copying protobuf-java-2.4.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/protobuf-java-2.4.1.jar>
[INFO] Copying commons-codec-1.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-codec-1.6.jar>
[INFO] 
[INFO] --- maven-jar-plugin:2.3.1:test-jar (default) @ hedwig-server ---
[INFO] Building jar: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/target/hedwig-server-4.4.0-SNAPSHOT-tests.jar>
[INFO] 
[INFO] >>> findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server >>>
[INFO] 
[INFO] --- findbugs-maven-plugin:2.5.2:findbugs (findbugs) @ hedwig-server ---
[INFO] Fork Value is true
     [java] The following classes needed for analysis were missing:
     [java]   com.google.protobuf.Parser
     [java] Missing classes: 1
[INFO] Done FindBugs Analysis....
[INFO] 
[INFO] <<< findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server <<<
[INFO] 
[INFO] --- findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server ---
[INFO] BugInstance size is 0
[INFO] Error size is 0
[INFO] No errors/warnings found
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building hedwig-client-jms 4.4.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-clean-plugin:2.4.1:clean (default-clean) @ hedwig-client-jms ---
[INFO] 
[INFO] --- apache-rat-plugin:0.7:check (default-cli) @ hedwig-client-jms ---
[INFO] Exclude: **/JmsHeader.java
[INFO] 
[INFO] --- javacc-maven-plugin:2.6:jjtree-javacc (jjtree-javacc) @ hedwig-client-jms ---
Java Compiler Compiler Version 5.0 (Tree Builder)
(type "jjtree" with no arguments for help)
Reading from file <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/src/main/grammar/javacc/selector_grammar.jjt> . . .
File "Node.java" does not exist.  Will create one.
File "SimpleNode.java" does not exist.  Will create one.
File "ASTOrExpr.java" does not exist.  Will create one.
File "ASTAndExpr.java" does not exist.  Will create one.
File "ASTNotExpr.java" does not exist.  Will create one.
File "ASTGreaterThan.java" does not exist.  Will create one.
File "ASTLessThan.java" does not exist.  Will create one.
File "ASTLessThanEqualTo.java" does not exist.  Will create one.
File "ASTGreaterThanEqualTo.java" does not exist.  Will create one.
File "ASTEqualTo.java" does not exist.  Will create one.
File "ASTNotEqualTo.java" does not exist.  Will create one.
File "ASTIsNullExpr.java" does not exist.  Will create one.
File "ASTBetweenExpr.java" does not exist.  Will create one.
File "ASTInExpr.java" does not exist.  Will create one.
File "ASTLikeExpr.java" does not exist.  Will create one.
File "ASTAddExpr.java" does not exist.  Will create one.
File "ASTSubExpr.java" does not exist.  Will create one.
File "ASTDivideExpr.java" does not exist.  Will create one.
File "ASTMultiplyExpr.java" does not exist.  Will create one.
File "ASTNegateExpr.java" does not exist.  Will create one.
File "ASTLookupExpr.java" does not exist.  Will create one.
File "ASTConstant.java" does not exist.  Will create one.
File "ASTStringVarargParams.java" does not exist.  Will create one.
File "SelectorParserTreeConstants.java" does not exist.  Will create one.
File "SelectorParserVisitor.java" does not exist.  Will create one.
File "JJTSelectorParserState.java" does not exist.  Will create one.
Annotated grammar generated successfully in <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/javacc-1416401093224/node/selector_grammar.jj>
Java Compiler Compiler Version 5.0 (Parser Generator)
(type "javacc" with no arguments for help)
Reading from file <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/javacc-1416401093224/node/selector_grammar.jj> . . .
Warning: Line 296, Column 3: Non-ASCII characters used in regular expression.
Please make sure you use the correct Reader when you create the parser, one that can handle your character set.
File "TokenMgrError.java" does not exist.  Will create one.
File "ParseException.java" does not exist.  Will create one.
File "Token.java" does not exist.  Will create one.
File "SimpleCharStream.java" does not exist.  Will create one.
Parser generated with 0 errors and 1 warnings.
[INFO] Processed 1 grammar
[INFO] 
[INFO] --- maven-remote-resources-plugin:1.1:process (default) @ hedwig-client-jms ---
[INFO] 
[INFO] --- maven-resources-plugin:2.4.3:resources (default-resources) @ hedwig-client-jms ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.0:compile (default-compile) @ hedwig-client-jms ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 76 source files to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/classes>
[INFO] 
[INFO] --- maven-resources-plugin:2.4.3:testResources (default-testResources) @ hedwig-client-jms ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/src/test/resources>
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.0:testCompile (default-testCompile) @ hedwig-client-jms ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 104 source files to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/test-classes>
[INFO] 
[INFO] --- maven-surefire-plugin:2.9:test (default-test) @ hedwig-client-jms ---
[INFO] Tests are skipped.
[INFO] 
[INFO] --- maven-surefire-plugin:2.9:test (unit-tests) @ hedwig-client-jms ---
[INFO] Surefire report directory: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/surefire-reports>

-------------------------------------------------------
 T E S T S
-------------------------------------------------------

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.hedwig.jms.selector.activemq.SelectorTest
Tests run: 19, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.241 sec
Running org.apache.hedwig.jms.selector.activemq.SelectorParserTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.213 sec
Running org.apache.hedwig.jms.selector.BasicSelectorGrammarTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.244 sec
Running org.apache.hedwig.jms.BasicJMSTest
Tests run: 3, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 3.22 sec <<< FAILURE!

Results :

Failed tests:   testSimpleChat(org.apache.hedwig.jms.BasicJMSTest): true

Tests run: 26, Failures: 1, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] bookkeeper ........................................ SUCCESS [  2.413 s]
[INFO] compability dependencies .......................... SUCCESS [  0.067 s]
[INFO] bookkeeper-server-compat400 ....................... SUCCESS [  4.234 s]
[INFO] bookkeeper-server-compat410 ....................... SUCCESS [  2.334 s]
[INFO] bookkeeper-server-compat420 ....................... SUCCESS [  2.659 s]
[INFO] hedwig-server-compat400 ........................... SUCCESS [  3.556 s]
[INFO] hedwig-server-compat410 ........................... SUCCESS [  3.730 s]
[INFO] hedwig-server-compat420 ........................... SUCCESS [  4.263 s]
[INFO] hedwig-protocol ................................... SUCCESS [ 25.328 s]
[INFO] Stats API for bookkeeper .......................... SUCCESS [  6.221 s]
[INFO] bookkeeper-server ................................. SUCCESS [14:22 min]
[INFO] hedwig-client ..................................... SUCCESS [ 16.259 s]
[INFO] hedwig-server ..................................... SUCCESS [12:12 min]
[INFO] hedwig-client-jms ................................. FAILURE [  7.198 s]
[INFO] bookkeeper-benchmark .............................. SKIPPED
[INFO] Stats provider for twitter-stats package .......... SKIPPED
[INFO] Stats provider for twitter-ostrich package ........ SKIPPED
[INFO] Stats provider for codahale metrics ............... SKIPPED
[INFO] bookkeeper-stats-providers ........................ SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 27:54 min
[INFO] Finished at: 2014-11-19T12:45:00+00:00
[INFO] Final Memory: 59M/762M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.9:test (unit-tests) on project hedwig-client-jms: There are test failures.
[ERROR] 
[ERROR] Please refer to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/surefire-reports> for the individual test results.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
[ERROR] 
[ERROR] After correcting the problems, you can resume the build with the command
[ERROR]   mvn <goals> -rf :hedwig-client-jms
Build step 'Execute shell' marked build as failure
Recording test results

From bookkeeper-dev-return-11608-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 13:38:34 2014
Return-Path: <bookkeeper-dev-return-11608-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 900F310CC9
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 13:38:34 +0000 (UTC)
Received: (qmail 7214 invoked by uid 500); 19 Nov 2014 13:38:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 7189 invoked by uid 500); 19 Nov 2014 13:38:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 7177 invoked by uid 99); 19 Nov 2014 13:38:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 13:38:33 +0000
Date: Wed, 19 Nov 2014 13:38:33 +0000 (UTC)
From: "Matthieu Morel (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756403.1416404299000.535336.1416404313757@Atlassian.JIRA>
In-Reply-To: <JIRA.12756403.1416404299000@Atlassian.JIRA>
References: <JIRA.12756403.1416404299000@Atlassian.JIRA> <JIRA.12756403.1416404299333@arcas>
Subject: [jira] [Created] (BOOKKEEPER-797) IllegalArgumentException when
 calling CodahaleOpStatsLogger#toOpStatsData()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Matthieu Morel created BOOKKEEPER-797:
-----------------------------------------

             Summary: IllegalArgumentException when calling CodahaleOpStatsLogger#toOpStatsData()
                 Key: BOOKKEEPER-797
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-797
             Project: Bookkeeper
          Issue Type: Bug
          Components: bookkeeper-stats
    Affects Versions: 4.3.0
            Reporter: Matthieu Morel
            Priority: Minor


The implementation of CodahaleOpStatsLogger#toOpStatsData() passes incorrect parameters to codahale's Snapshot#getValue method, resulting in the following runtime exception:

java.lang.IllegalArgumentException: 10.0 is not in [0..1]
	at com.codahale.metrics.Snapshot.getValue(Snapshot.java:52)
	at org.apache.bookkeeper.stats.CodahaleOpStatsLogger.toOpStatsData(CodahaleOpStatsLogger.java:64)
...

In order to pass quantiles as [0..1] values, as expected by codahale metrics library, we must divide parameters by 100 before passing them.





--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11609-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 13:40:34 2014
Return-Path: <bookkeeper-dev-return-11609-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CA55210CE5
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 13:40:34 +0000 (UTC)
Received: (qmail 13347 invoked by uid 500); 19 Nov 2014 13:40:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 13310 invoked by uid 500); 19 Nov 2014 13:40:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 13296 invoked by uid 99); 19 Nov 2014 13:40:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 13:40:34 +0000
Date: Wed, 19 Nov 2014 13:40:34 +0000 (UTC)
From: "Matthieu Morel (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756403.1416404299000.535353.1416404434640@Atlassian.JIRA>
In-Reply-To: <JIRA.12756403.1416404299000@Atlassian.JIRA>
References: <JIRA.12756403.1416404299000@Atlassian.JIRA> <JIRA.12756403.1416404299333@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-797) IllegalArgumentException when
 calling CodahaleOpStatsLogger#toOpStatsData()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-797?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Matthieu Morel updated BOOKKEEPER-797:
--------------------------------------
    Attachment: codahale-stats-opstats-fix.patch

Patch with test, generated using git diff --no-prefix

> IllegalArgumentException when calling CodahaleOpStatsLogger#toOpStatsData()
> ---------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-797
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-797
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-stats
>    Affects Versions: 4.3.0
>            Reporter: Matthieu Morel
>            Priority: Minor
>         Attachments: codahale-stats-opstats-fix.patch
>
>
> The implementation of CodahaleOpStatsLogger#toOpStatsData() passes incorrect parameters to codahale's Snapshot#getValue method, resulting in the following runtime exception:
> java.lang.IllegalArgumentException: 10.0 is not in [0..1]
> 	at com.codahale.metrics.Snapshot.getValue(Snapshot.java:52)
> 	at org.apache.bookkeeper.stats.CodahaleOpStatsLogger.toOpStatsData(CodahaleOpStatsLogger.java:64)
> ...
> In order to pass quantiles as [0..1] values, as expected by codahale metrics library, we must divide parameters by 100 before passing them.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11610-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 14:26:34 2014
Return-Path: <bookkeeper-dev-return-11610-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4860210E33
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 14:26:34 +0000 (UTC)
Received: (qmail 97175 invoked by uid 500); 19 Nov 2014 14:26:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 97141 invoked by uid 500); 19 Nov 2014 14:26:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 97121 invoked by uid 99); 19 Nov 2014 14:26:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 14:26:34 +0000
Date: Wed, 19 Nov 2014 14:26:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756403.1416404299000.535593.1416407194042@Atlassian.JIRA>
In-Reply-To: <JIRA.12756403.1416404299000@Atlassian.JIRA>
References: <JIRA.12756403.1416404299000@Atlassian.JIRA> <JIRA.12756403.1416404299333@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-797) IllegalArgumentException when
 calling CodahaleOpStatsLogger#toOpStatsData()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-797?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14217958#comment-14217958 ] 

Hadoop QA commented on BOOKKEEPER-797:
--------------------------------------

Testing JIRA BOOKKEEPER-797


Patch [codahale-stats-opstats-fix.patch|https://issues.apache.org/jira/secure/attachment/12682418/codahale-stats-opstats-fix.patch] downloaded at Wed Nov 19 13:50:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:red}-1 RAT{color}
.    {color:red}-1{color} the patch seems to introduce 1 new RAT warning(s)
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/820/

> IllegalArgumentException when calling CodahaleOpStatsLogger#toOpStatsData()
> ---------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-797
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-797
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-stats
>    Affects Versions: 4.3.0
>            Reporter: Matthieu Morel
>            Priority: Minor
>         Attachments: codahale-stats-opstats-fix.patch
>
>
> The implementation of CodahaleOpStatsLogger#toOpStatsData() passes incorrect parameters to codahale's Snapshot#getValue method, resulting in the following runtime exception:
> java.lang.IllegalArgumentException: 10.0 is not in [0..1]
> 	at com.codahale.metrics.Snapshot.getValue(Snapshot.java:52)
> 	at org.apache.bookkeeper.stats.CodahaleOpStatsLogger.toOpStatsData(CodahaleOpStatsLogger.java:64)
> ...
> In order to pass quantiles as [0..1] values, as expected by codahale metrics library, we must divide parameters by 100 before passing them.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11611-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 14:59:34 2014
Return-Path: <bookkeeper-dev-return-11611-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A975010EEF
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 14:59:34 +0000 (UTC)
Received: (qmail 64312 invoked by uid 500); 19 Nov 2014 14:59:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 64281 invoked by uid 500); 19 Nov 2014 14:59:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 64270 invoked by uid 99); 19 Nov 2014 14:59:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 14:59:34 +0000
Date: Wed, 19 Nov 2014 14:59:34 +0000 (UTC)
From: "Matthieu Morel (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756403.1416404299000.535702.1416409174470@Atlassian.JIRA>
In-Reply-To: <JIRA.12756403.1416404299000@Atlassian.JIRA>
References: <JIRA.12756403.1416404299000@Atlassian.JIRA> <JIRA.12756403.1416404299333@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-797) IllegalArgumentException when
 calling CodahaleOpStatsLogger#toOpStatsData()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-797?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Matthieu Morel updated BOOKKEEPER-797:
--------------------------------------
    Attachment: codahale-stats-opstats-fix.patch

Looks like the previous patch was missing some license headers in the test file

> IllegalArgumentException when calling CodahaleOpStatsLogger#toOpStatsData()
> ---------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-797
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-797
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-stats
>    Affects Versions: 4.3.0
>            Reporter: Matthieu Morel
>            Priority: Minor
>         Attachments: codahale-stats-opstats-fix.patch, codahale-stats-opstats-fix.patch
>
>
> The implementation of CodahaleOpStatsLogger#toOpStatsData() passes incorrect parameters to codahale's Snapshot#getValue method, resulting in the following runtime exception:
> java.lang.IllegalArgumentException: 10.0 is not in [0..1]
> 	at com.codahale.metrics.Snapshot.getValue(Snapshot.java:52)
> 	at org.apache.bookkeeper.stats.CodahaleOpStatsLogger.toOpStatsData(CodahaleOpStatsLogger.java:64)
> ...
> In order to pass quantiles as [0..1] values, as expected by codahale metrics library, we must divide parameters by 100 before passing them.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11612-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 15:07:34 2014
Return-Path: <bookkeeper-dev-return-11612-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4571410F2A
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 15:07:34 +0000 (UTC)
Received: (qmail 74884 invoked by uid 500); 19 Nov 2014 15:07:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 74844 invoked by uid 500); 19 Nov 2014 15:07:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 74777 invoked by uid 99); 19 Nov 2014 15:07:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 15:07:34 +0000
Date: Wed, 19 Nov 2014 15:07:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756421.1416409636000.535743.1416409653948@Atlassian.JIRA>
In-Reply-To: <JIRA.12756421.1416409636000@Atlassian.JIRA>
References: <JIRA.12756421.1416409636000@Atlassian.JIRA> <JIRA.12756421.1416409636416@arcas>
Subject: [jira] [Created] (BOOKKEEPER-798) Make website look more modern
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Ivan Kelly created BOOKKEEPER-798:
-------------------------------------

             Summary: Make website look more modern
                 Key: BOOKKEEPER-798
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-798
             Project: Bookkeeper
          Issue Type: Bug
            Reporter: Ivan Kelly
            Assignee: Ivan Kelly


The current website looks super old. This jira is to remedy the style. Changes to content will come later.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11613-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 15:10:34 2014
Return-Path: <bookkeeper-dev-return-11613-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0F76710F4B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 15:10:34 +0000 (UTC)
Received: (qmail 81754 invoked by uid 500); 19 Nov 2014 15:10:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 81709 invoked by uid 500); 19 Nov 2014 15:10:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 81696 invoked by uid 99); 19 Nov 2014 15:10:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 15:10:33 +0000
Date: Wed, 19 Nov 2014 15:10:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756421.1416409636000.535759.1416409833708@Atlassian.JIRA>
In-Reply-To: <JIRA.12756421.1416409636000@Atlassian.JIRA>
References: <JIRA.12756421.1416409636000@Atlassian.JIRA> <JIRA.12756421.1416409636416@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-798) Make website look more modern
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-798?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-798:
----------------------------------
    Attachment: 0001-Adding-bootstrap-resources-for-site-reboot.patch
                0001-Make-site-use-bootstrap.patch

Adding two patches, as the bookkeeper site is spread over two places.

The new site uses bootstrap (a twitter library), and thus looks like a lot of other sites, but at least it looks new.

Have a gawk: http://bk.ivankelly.net/bookkeeper

> Make website look more modern
> -----------------------------
>
>                 Key: BOOKKEEPER-798
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-798
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>         Attachments: 0001-Adding-bootstrap-resources-for-site-reboot.patch, 0001-Make-site-use-bootstrap.patch
>
>
> The current website looks super old. This jira is to remedy the style. Changes to content will come later.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11614-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 15:36:35 2014
Return-Path: <bookkeeper-dev-return-11614-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 766A910047
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 15:36:35 +0000 (UTC)
Received: (qmail 49694 invoked by uid 500); 19 Nov 2014 15:36:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 49626 invoked by uid 500); 19 Nov 2014 15:36:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 49475 invoked by uid 99); 19 Nov 2014 15:36:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 15:36:34 +0000
Date: Wed, 19 Nov 2014 15:36:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756403.1416404299000.536000.1416411394708@Atlassian.JIRA>
In-Reply-To: <JIRA.12756403.1416404299000@Atlassian.JIRA>
References: <JIRA.12756403.1416404299000@Atlassian.JIRA> <JIRA.12756403.1416404299333@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-797) IllegalArgumentException when
 calling CodahaleOpStatsLogger#toOpStatsData()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-797?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14218033#comment-14218033 ] 

Hadoop QA commented on BOOKKEEPER-797:
--------------------------------------

Testing JIRA BOOKKEEPER-797


Patch [codahale-stats-opstats-fix.patch|https://issues.apache.org/jira/secure/attachment/12682422/codahale-stats-opstats-fix.patch] downloaded at Wed Nov 19 15:00:21 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/821/

> IllegalArgumentException when calling CodahaleOpStatsLogger#toOpStatsData()
> ---------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-797
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-797
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-stats
>    Affects Versions: 4.3.0
>            Reporter: Matthieu Morel
>            Priority: Minor
>         Attachments: codahale-stats-opstats-fix.patch, codahale-stats-opstats-fix.patch
>
>
> The implementation of CodahaleOpStatsLogger#toOpStatsData() passes incorrect parameters to codahale's Snapshot#getValue method, resulting in the following runtime exception:
> java.lang.IllegalArgumentException: 10.0 is not in [0..1]
> 	at com.codahale.metrics.Snapshot.getValue(Snapshot.java:52)
> 	at org.apache.bookkeeper.stats.CodahaleOpStatsLogger.toOpStatsData(CodahaleOpStatsLogger.java:64)
> ...
> In order to pass quantiles as [0..1] values, as expected by codahale metrics library, we must divide parameters by 100 before passing them.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11615-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 15:41:35 2014
Return-Path: <bookkeeper-dev-return-11615-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E964310072
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 15:41:35 +0000 (UTC)
Received: (qmail 62986 invoked by uid 500); 19 Nov 2014 15:41:35 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 62956 invoked by uid 500); 19 Nov 2014 15:41:35 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 62944 invoked by uid 99); 19 Nov 2014 15:41:35 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 15:41:35 +0000
Date: Wed, 19 Nov 2014 15:41:35 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756421.1416409636000.536017.1416411695478@Atlassian.JIRA>
In-Reply-To: <JIRA.12756421.1416409636000@Atlassian.JIRA>
References: <JIRA.12756421.1416409636000@Atlassian.JIRA> <JIRA.12756421.1416409636416@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-798) Make website look more modern
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-798?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14218036#comment-14218036 ] 

Hadoop QA commented on BOOKKEEPER-798:
--------------------------------------

Testing JIRA BOOKKEEPER-798


Patch [0001-Adding-bootstrap-resources-for-site-reboot.patch|https://issues.apache.org/jira/secure/attachment/12682425/0001-Adding-bootstrap-resources-for-site-reboot.patch] downloaded at Wed Nov 19 15:37:08 UTC 2014

----------------------------

{color:red}-1{color} Patch failed to apply to head of branch

----------------------------

> Make website look more modern
> -----------------------------
>
>                 Key: BOOKKEEPER-798
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-798
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>         Attachments: 0001-Adding-bootstrap-resources-for-site-reboot.patch, 0001-Make-site-use-bootstrap.patch
>
>
> The current website looks super old. This jira is to remedy the style. Changes to content will come later.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11616-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 17:24:34 2014
Return-Path: <bookkeeper-dev-return-11616-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 28D25105A8
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 17:24:34 +0000 (UTC)
Received: (qmail 58485 invoked by uid 500); 19 Nov 2014 17:24:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 58450 invoked by uid 500); 19 Nov 2014 17:24:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 58434 invoked by uid 99); 19 Nov 2014 17:24:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 17:24:34 +0000
Date: Wed, 19 Nov 2014 17:24:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756421.1416409636000.536890.1416417873976@Atlassian.JIRA>
In-Reply-To: <JIRA.12756421.1416409636000@Atlassian.JIRA>
References: <JIRA.12756421.1416409636000@Atlassian.JIRA> <JIRA.12756421.1416409636416@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-798) Make website look more modern
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-798?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14218179#comment-14218179 ] 

Hadoop QA commented on BOOKKEEPER-798:
--------------------------------------

Testing JIRA BOOKKEEPER-798


Patch [0001-Adding-bootstrap-resources-for-site-reboot.patch|https://issues.apache.org/jira/secure/attachment/12682425/0001-Adding-bootstrap-resources-for-site-reboot.patch] downloaded at Wed Nov 19 17:20:22 UTC 2014

----------------------------

{color:red}-1{color} Patch failed to apply to head of branch

----------------------------

> Make website look more modern
> -----------------------------
>
>                 Key: BOOKKEEPER-798
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-798
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>         Attachments: 0001-Adding-bootstrap-resources-for-site-reboot.patch, 0001-Make-site-use-bootstrap.patch
>
>
> The current website looks super old. This jira is to remedy the style. Changes to content will come later.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11617-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 17:45:08 2014
Return-Path: <bookkeeper-dev-return-11617-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B6EB1106B9
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 17:45:08 +0000 (UTC)
Received: (qmail 6864 invoked by uid 500); 19 Nov 2014 17:45:08 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 6827 invoked by uid 500); 19 Nov 2014 17:45:08 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 6816 invoked by uid 99); 19 Nov 2014 17:45:08 -0000
Received: from crius.apache.org (HELO crius) (140.211.11.14)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 17:45:08 +0000
Received: from crius.apache.org (localhost [127.0.0.1])
	by crius (Postfix) with ESMTP id 78A06E00A1F
	for <bookkeeper-dev@zookeeper.apache.org>; Wed, 19 Nov 2014 17:45:05 +0000 (UTC)
Date: Wed, 19 Nov 2014 17:45:04 +0000 (UTC)
From: Apache Jenkins Server  <jenkins@builds.apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <612375570.8174.1416419104004.JavaMail.jenkins@crius>
In-Reply-To: <1519301181.8113.1416401110097.JavaMail.jenkins@crius>
References: <1519301181.8113.1416401110097.JavaMail.jenkins@crius>
Subject: Jenkins build is back to normal : bookkeeper-trunk #855
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: bookkeeper-trunk
X-Jenkins-Result: SUCCESS

See <https://builds.apache.org/job/bookkeeper-trunk/855/changes>


From bookkeeper-dev-return-11618-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 17:45:34 2014
Return-Path: <bookkeeper-dev-return-11618-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2F32C106BA
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 17:45:34 +0000 (UTC)
Received: (qmail 7338 invoked by uid 500); 19 Nov 2014 17:45:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 7301 invoked by uid 500); 19 Nov 2014 17:45:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 7286 invoked by uid 99); 19 Nov 2014 17:45:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 17:45:34 +0000
Date: Wed, 19 Nov 2014 17:45:33 +0000 (UTC)
From: "Hudson (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756403.1416404299000.537137.1416419133960@Atlassian.JIRA>
In-Reply-To: <JIRA.12756403.1416404299000@Atlassian.JIRA>
References: <JIRA.12756403.1416404299000@Atlassian.JIRA> <JIRA.12756403.1416404299333@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-797) IllegalArgumentException when
 calling CodahaleOpStatsLogger#toOpStatsData()
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-797?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14218212#comment-14218212 ] 

Hudson commented on BOOKKEEPER-797:
-----------------------------------

SUCCESS: Integrated in bookkeeper-trunk #855 (See [https://builds.apache.org/job/bookkeeper-trunk/855/])
BOOKKEEPER-797: IllegalArgumentException when calling CodahaleOpStatsLogger#toOpStatsData() (ivank: rev 1640597)
* /zookeeper/bookkeeper/trunk/CHANGES.txt
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/pom.xml
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/CodahaleOpStatsLogger.java
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/src/test
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/src/test/java
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/src/test/java/org
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/src/test/java/org/apache
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/src/test/java/org/apache/bookkeeper
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/src/test/java/org/apache/bookkeeper/stats
* /zookeeper/bookkeeper/trunk/bookkeeper-stats-providers/codahale-metrics-provider/src/test/java/org/apache/bookkeeper/stats/CodahaleOpStatsTest.java


> IllegalArgumentException when calling CodahaleOpStatsLogger#toOpStatsData()
> ---------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-797
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-797
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-stats
>    Affects Versions: 4.3.0
>            Reporter: Matthieu Morel
>            Assignee: Matthieu Morel
>            Priority: Minor
>             Fix For: 4.4.0
>
>         Attachments: codahale-stats-opstats-fix.patch, codahale-stats-opstats-fix.patch
>
>
> The implementation of CodahaleOpStatsLogger#toOpStatsData() passes incorrect parameters to codahale's Snapshot#getValue method, resulting in the following runtime exception:
> java.lang.IllegalArgumentException: 10.0 is not in [0..1]
> 	at com.codahale.metrics.Snapshot.getValue(Snapshot.java:52)
> 	at org.apache.bookkeeper.stats.CodahaleOpStatsLogger.toOpStatsData(CodahaleOpStatsLogger.java:64)
> ...
> In order to pass quantiles as [0..1] values, as expected by codahale metrics library, we must divide parameters by 100 before passing them.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11619-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 19 21:55:17 2014
Return-Path: <bookkeeper-dev-return-11619-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 80D811016A
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 19 Nov 2014 21:55:17 +0000 (UTC)
Received: (qmail 38715 invoked by uid 500); 19 Nov 2014 21:55:17 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 38678 invoked by uid 500); 19 Nov 2014 21:55:17 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 38653 invoked by uid 99); 19 Nov 2014 21:55:17 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 19 Nov 2014 21:55:17 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id 6DE5C1167DE;
	Wed, 19 Nov 2014 21:55:16 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============3106185594199872833=="
MIME-Version: 1.0
Subject: Re: Review Request 28119: Documentation: The bookkeeper protocol
From: fpj@apache.org
To: fpj@apache.org, "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Wed, 19 Nov 2014 21:55:16 -0000
Message-ID: <20141119215516.15353.7588@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: noreply@reviews.apache.org
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/28119/
X-Sender: noreply@reviews.apache.org
References: <20141117145820.24716.70296@reviews.apache.org>
In-Reply-To: <20141117145820.24716.70296@reviews.apache.org>
Reply-To: fpj@apache.org

--===============3106185594199872833==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/28119/#review62233
-----------------------------------------------------------


This is good, I have a few comments in the case you want to incorporate some of those.


File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment55>

    primitive



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment56>

    provided



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment57>

    compare-and swap is more common.



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment58>

    The term typically used to refer to a single client writing is single-writer (as opposed to multi-writer). In fact, acronyms like SWSR (single writer, single reader) or SWMR (single writer, multiple reader) are used in the literature. BK is SWMR.



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment59>

    Since you referred to a "consistent store with CAS" above, you may want to say that you need such a store to be able to elect a leader, like ZK.



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment60>

    "... it must read executing the following steps:"



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment61>

    Why 2 ledgers instead of 1?



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment62>

    In this fencing here the ledger-level fencing we have internally or something else? It isn't clear if the developer of an app on top of BK needs to do anything for the fencing to happen of if this text is simply explaining what happens under the hood.



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment63>

    It would be nice to explain why we have Q_w. Q_w is the number of total replicas of a record we expect to have, but we only really wait for Q_a before responding to the application.
    
    Understood that there is more discussion about this below, but since you mention Q_a, it might be nice to mention Q_w as well for completeness.



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment64>

    One of the great advantages of being single-writer is that we can rely on the writer to assign the entry ids. Otherwise, we would need a sequencer per ledger.



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment65>

    Refer to the next section for an explanation of why a concurrent write to the metadata could happen.



File Attachment: bk_protocol.txt - bk_protocol.txt
<https://reviews.apache.org//r/28119/#fcomment66>

    we send an error?


- fpj


On Nov. 17, 2014, 2:58 p.m., Ivan Kelly wrote:
> 
> -----------------------------------------------------------
> This is an automatically generated e-mail. To reply, visit:
> https://reviews.apache.org/r/28119/
> -----------------------------------------------------------
> 
> (Updated Nov. 17, 2014, 2:58 p.m.)
> 
> 
> Review request for bookkeeper.
> 
> 
> Description
> -------
> 
> A high level description of the bookkeeper protocol and the guarantees we provide.
> 
> I'll put this into textile before submitting, but I wanted to leave it in a more text readable format for review.
> 
> 
> Diffs
> -----
> 
> 
> Diff: https://reviews.apache.org/r/28119/diff/
> 
> 
> Testing
> -------
> 
> 
> File Attachments
> ----------------
> 
> bk_protocol.txt
>   https://reviews.apache.org/media/uploaded/files/2014/11/17/f47f48e9-c284-4473-b4e9-584b24af7a14__bk_protocol.txt
> 
> 
> Thanks,
> 
> Ivan Kelly
> 
>


--===============3106185594199872833==--

From bookkeeper-dev-return-11620-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 20 12:24:36 2014
Return-Path: <bookkeeper-dev-return-11620-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8860ECC39
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 20 Nov 2014 12:24:36 +0000 (UTC)
Received: (qmail 39112 invoked by uid 500); 20 Nov 2014 12:24:36 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 39081 invoked by uid 500); 20 Nov 2014 12:24:36 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 39068 invoked by uid 99); 20 Nov 2014 12:24:36 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 20 Nov 2014 12:24:36 +0000
Date: Thu, 20 Nov 2014 12:24:36 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756421.1416409636000.543590.1416486276289@Atlassian.JIRA>
In-Reply-To: <JIRA.12756421.1416409636000@Atlassian.JIRA>
References: <JIRA.12756421.1416409636000@Atlassian.JIRA> <JIRA.12756421.1416409636416@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-798) Make website look more modern
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-798?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14219321#comment-14219321 ] 

Hadoop QA commented on BOOKKEEPER-798:
--------------------------------------

Testing JIRA BOOKKEEPER-798


Patch [0001-Adding-bootstrap-resources-for-site-reboot.patch|https://issues.apache.org/jira/secure/attachment/12682425/0001-Adding-bootstrap-resources-for-site-reboot.patch] downloaded at Thu Nov 20 12:20:24 UTC 2014

----------------------------

{color:red}-1{color} Patch failed to apply to head of branch

----------------------------

> Make website look more modern
> -----------------------------
>
>                 Key: BOOKKEEPER-798
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-798
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>         Attachments: 0001-Adding-bootstrap-resources-for-site-reboot.patch, 0001-Make-site-use-bootstrap.patch
>
>
> The current website looks super old. This jira is to remedy the style. Changes to content will come later.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11621-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 11:33:34 2014
Return-Path: <bookkeeper-dev-return-11621-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1CE51CE97
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 11:33:34 +0000 (UTC)
Received: (qmail 21517 invoked by uid 500); 21 Nov 2014 11:33:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 21488 invoked by uid 500); 21 Nov 2014 11:33:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 21477 invoked by uid 99); 21 Nov 2014 11:33:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 11:33:33 +0000
Date: Fri, 21 Nov 2014 11:33:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.553149.1416569613611@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Created] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Ivan Kelly created BOOKKEEPER-799:
-------------------------------------

             Summary: Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
                 Key: BOOKKEEPER-799
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
             Project: Bookkeeper
          Issue Type: Bug
            Reporter: Ivan Kelly
            Assignee: Ivan Kelly
            Priority: Blocker
             Fix For: 4.4.0, 4.2.4


The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.

The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.

The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.

Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 




--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11622-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 11:38:34 2014
Return-Path: <bookkeeper-dev-return-11622-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 395DACEAC
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 11:38:34 +0000 (UTC)
Received: (qmail 28946 invoked by uid 500); 21 Nov 2014 11:38:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 28909 invoked by uid 500); 21 Nov 2014 11:38:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 28898 invoked by uid 99); 21 Nov 2014 11:38:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 11:38:34 +0000
Date: Fri, 21 Nov 2014 11:38:34 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.553169.1416569914012@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-799:
----------------------------------
    Attachment: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch

Fix is to check each write quorum after each response. If there is no write quorum with |ackQuorum| nodes available, then it is not possible for a writer to form a quorum without at least one of the nodes we have heard a response from.

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11623-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 11:40:35 2014
Return-Path: <bookkeeper-dev-return-11623-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 830AECEB1
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 11:40:35 +0000 (UTC)
Received: (qmail 32047 invoked by uid 500); 21 Nov 2014 11:40:35 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 32014 invoked by uid 500); 21 Nov 2014 11:40:35 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 31991 invoked by uid 99); 21 Nov 2014 11:40:35 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 11:40:35 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id EEF581DDEE3;
	Fri, 21 Nov 2014 11:40:33 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============8149934647594339536=="
MIME-Version: 1.0
Subject: Review Request 28326: BOOKKEEPER-799 Distribution schedule coverage
 sets
 don't take gaps in response lists into account when writequorum > ackquorum
From: "Ivan Kelly" <ivank@apache.org>
To: "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Fri, 21 Nov 2014 11:40:33 -0000
Message-ID: <20141121114033.16171.56261@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/28326/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>
X-ReviewRequest-Repository: bookkeeper-git

--===============8149934647594339536==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/28326/
-----------------------------------------------------------

Review request for bookkeeper.


Bugs: BOOKKEEPER-799
    https://issues.apache.org/jira/browse/BOOKKEEPER-799


Repository: bookkeeper-git


Description
-------

Fix is to check each write quorum after each response. If there is no write quorum with |ackQuorum| nodes available, then it is not possible for a writer to form a quorum without at least one of the nodes we have heard a response from.


Diffs
-----

  bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RoundRobinDistributionSchedule.java b34ff75 
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/RoundRobinDistributionScheduleTest.java ce9aab9 

Diff: https://reviews.apache.org/r/28326/diff/


Testing
-------


Thanks,

Ivan Kelly


--===============8149934647594339536==--

From bookkeeper-dev-return-11624-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 11:41:34 2014
Return-Path: <bookkeeper-dev-return-11624-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 79C65CEB6
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 11:41:34 +0000 (UTC)
Received: (qmail 38490 invoked by uid 500); 21 Nov 2014 11:41:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 38448 invoked by uid 500); 21 Nov 2014 11:41:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 38436 invoked by uid 99); 21 Nov 2014 11:41:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 11:41:33 +0000
Date: Fri, 21 Nov 2014 11:41:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.553172.1416570093637@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14220801#comment-14220801 ] 

Ivan Kelly commented on BOOKKEEPER-799:
---------------------------------------

https://reviews.apache.org/r/28326/

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11625-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 12:57:34 2014
Return-Path: <bookkeeper-dev-return-11625-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 276FE10109
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 12:57:34 +0000 (UTC)
Received: (qmail 62961 invoked by uid 500); 21 Nov 2014 12:57:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 62919 invoked by uid 500); 21 Nov 2014 12:57:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 62907 invoked by uid 99); 21 Nov 2014 12:57:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 12:57:33 +0000
Date: Fri, 21 Nov 2014 12:57:33 +0000 (UTC)
From: "Flavio Junqueira (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.553446.1416574653839@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14220866#comment-14220866 ] 

Flavio Junqueira commented on BOOKKEEPER-799:
---------------------------------------------

Good catch! Write quorums are defined in a round-robin fashion so there is no gap in the sequence of ordered server ids for a write quorum, but since an ack quorum can be a subset of a write quorum, an ack quorum might have gaps in the sequence of bookies ids.

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11626-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 13:22:34 2014
Return-Path: <bookkeeper-dev-return-11626-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 74B49101E6
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 13:22:34 +0000 (UTC)
Received: (qmail 8405 invoked by uid 500); 21 Nov 2014 13:22:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 8371 invoked by uid 500); 21 Nov 2014 13:22:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 8358 invoked by uid 99); 21 Nov 2014 13:22:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 13:22:34 +0000
Date: Fri, 21 Nov 2014 13:22:34 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.553584.1416576154225@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-799:
----------------------------------
    Fix Version/s: 4.3.1

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11627-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 13:23:34 2014
Return-Path: <bookkeeper-dev-return-11627-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 62B0E101EF
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 13:23:34 +0000 (UTC)
Received: (qmail 9840 invoked by uid 500); 21 Nov 2014 13:23:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 9802 invoked by uid 500); 21 Nov 2014 13:23:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 9749 invoked by uid 99); 21 Nov 2014 13:23:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 13:23:34 +0000
Date: Fri, 21 Nov 2014 13:23:34 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.553589.1416576214166@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14220892#comment-14220892 ] 

Ivan Kelly commented on BOOKKEEPER-799:
---------------------------------------

I think that once this is in we should roll a 4.2.4 and 4.3.1 release. I'd like to wait until TLP stuff is set up first though. Branches are much easier to deal with in git.

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11628-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 13:30:34 2014
Return-Path: <bookkeeper-dev-return-11628-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 18E5F10230
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 13:30:34 +0000 (UTC)
Received: (qmail 30950 invoked by uid 500); 21 Nov 2014 13:30:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 30913 invoked by uid 500); 21 Nov 2014 13:30:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 30900 invoked by uid 99); 21 Nov 2014 13:30:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 13:30:33 +0000
Date: Fri, 21 Nov 2014 13:30:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.553626.1416576633643@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Created] (BOOKKEEPER-800) Expose whether a ledger is closed
 or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Ivan Kelly created BOOKKEEPER-800:
-------------------------------------

             Summary: Expose whether a ledger is closed or not
                 Key: BOOKKEEPER-800
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
             Project: Bookkeeper
          Issue Type: Bug
            Reporter: Ivan Kelly
            Assignee: Ivan Kelly
             Fix For: 4.4.0, 4.3.1, 4.2.4


On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.

This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11629-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 13:38:33 2014
Return-Path: <bookkeeper-dev-return-11629-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D02771025A
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 13:38:33 +0000 (UTC)
Received: (qmail 39027 invoked by uid 500); 21 Nov 2014 13:38:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 38985 invoked by uid 500); 21 Nov 2014 13:38:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 38973 invoked by uid 99); 21 Nov 2014 13:38:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 13:38:33 +0000
Date: Fri, 21 Nov 2014 13:38:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.553648.1416577113649@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-800) Expose whether a ledger is closed
 or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-800:
----------------------------------
    Attachment: 0001-Expose-whether-a-ledger-has-been-closed.patch

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11630-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 13:38:33 2014
Return-Path: <bookkeeper-dev-return-11630-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E52841025B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 13:38:33 +0000 (UTC)
Received: (qmail 39097 invoked by uid 500); 21 Nov 2014 13:38:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 39068 invoked by uid 500); 21 Nov 2014 13:38:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 38986 invoked by uid 99); 21 Nov 2014 13:38:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 13:38:33 +0000
Date: Fri, 21 Nov 2014 13:38:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.553649.1416577113729@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-800) Expose whether a ledger is
 closed or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14220912#comment-14220912 ] 

Ivan Kelly commented on BOOKKEEPER-800:
---------------------------------------

patch is trivial

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11631-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 14:17:34 2014
Return-Path: <bookkeeper-dev-return-11631-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5D762103E7
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 14:17:34 +0000 (UTC)
Received: (qmail 763 invoked by uid 500); 21 Nov 2014 14:17:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 727 invoked by uid 500); 21 Nov 2014 14:17:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 716 invoked by uid 99); 21 Nov 2014 14:17:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 14:17:34 +0000
Date: Fri, 21 Nov 2014 14:17:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.553837.1416579454168@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14220952#comment-14220952 ] 

Hadoop QA commented on BOOKKEEPER-799:
--------------------------------------

Testing JIRA BOOKKEEPER-799


Patch [0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch|https://issues.apache.org/jira/secure/attachment/12682858/0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch] downloaded at Fri Nov 21 13:40:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 931
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/825/

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11632-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 14:24:35 2014
Return-Path: <bookkeeper-dev-return-11632-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EFA6710411
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 14:24:34 +0000 (UTC)
Received: (qmail 10958 invoked by uid 500); 21 Nov 2014 14:24:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 10917 invoked by uid 500); 21 Nov 2014 14:24:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 10905 invoked by uid 99); 21 Nov 2014 14:24:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 14:24:33 +0000
Date: Fri, 21 Nov 2014 14:24:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.553858.1416579873940@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-800) Expose whether a ledger is
 closed or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14220962#comment-14220962 ] 

Hadoop QA commented on BOOKKEEPER-800:
--------------------------------------

Testing JIRA BOOKKEEPER-800


Patch [0001-Expose-whether-a-ledger-has-been-closed.patch|https://issues.apache.org/jira/secure/attachment/12682881/0001-Expose-whether-a-ledger-has-been-closed.patch] downloaded at Fri Nov 21 14:17:18 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:red}-1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:red}-1{color} patch does not compile
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color} - patch does not compile, cannot run testcases
{color:red}-1 DISTRO{color}
.    {color:red}-1{color} distro tarball fails with the patch

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/826/

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11633-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:09:34 2014
Return-Path: <bookkeeper-dev-return-11633-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 001F610806
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:09:33 +0000 (UTC)
Received: (qmail 46639 invoked by uid 500); 21 Nov 2014 16:09:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 46601 invoked by uid 500); 21 Nov 2014 16:09:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 46589 invoked by uid 99); 21 Nov 2014 16:09:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:09:33 +0000
Date: Fri, 21 Nov 2014 16:09:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.554561.1416586173801@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-800) Expose whether a ledger is closed
 or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-800:
----------------------------------
    Attachment: 0001-Expose-whether-a-ledger-has-been-closed.patch

Had forgotten to commit a change locally.

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch, 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11634-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:46:34 2014
Return-Path: <bookkeeper-dev-return-11634-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7DF0D10932
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:46:34 +0000 (UTC)
Received: (qmail 31963 invoked by uid 500); 21 Nov 2014 16:46:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 31931 invoked by uid 500); 21 Nov 2014 16:46:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 31785 invoked by uid 99); 21 Nov 2014 16:46:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:46:34 +0000
Date: Fri, 21 Nov 2014 16:46:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.554664.1416588394082@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-800) Expose whether a ledger is
 closed or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221104#comment-14221104 ] 

Hadoop QA commented on BOOKKEEPER-800:
--------------------------------------

Testing JIRA BOOKKEEPER-800


Patch [0001-Expose-whether-a-ledger-has-been-closed.patch|https://issues.apache.org/jira/secure/attachment/12682903/0001-Expose-whether-a-ledger-has-been-closed.patch] downloaded at Fri Nov 21 16:10:22 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/827/

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch, 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11635-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:51:34 2014
Return-Path: <bookkeeper-dev-return-11635-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3B6F31096B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:51:34 +0000 (UTC)
Received: (qmail 40494 invoked by uid 500); 21 Nov 2014 16:51:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 40455 invoked by uid 500); 21 Nov 2014 16:51:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 40262 invoked by uid 99); 21 Nov 2014 16:51:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:51:33 +0000
Date: Fri, 21 Nov 2014 16:51:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757015.1416588670000.554689.1416588693921@Atlassian.JIRA>
In-Reply-To: <JIRA.12757015.1416588670000@Atlassian.JIRA>
References: <JIRA.12757015.1416588670000@Atlassian.JIRA> <JIRA.12757015.1416588670139@arcas>
Subject: [jira] [Created] (BOOKKEEPER-801) Bookkeeper client tutorial
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Ivan Kelly created BOOKKEEPER-801:
-------------------------------------

             Summary: Bookkeeper client tutorial
                 Key: BOOKKEEPER-801
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-801
             Project: Bookkeeper
          Issue Type: Bug
            Reporter: Ivan Kelly
            Assignee: Ivan Kelly
             Fix For: 4.4.0


Taking the tutorial from https://github.com/ivankelly/bookkeeper-tutorial and adding it to the bookkeeper docs.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11636-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:53:34 2014
Return-Path: <bookkeeper-dev-return-11636-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6B89E1097D
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:53:34 +0000 (UTC)
Received: (qmail 48848 invoked by uid 500); 21 Nov 2014 16:53:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 48821 invoked by uid 500); 21 Nov 2014 16:53:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 48809 invoked by uid 99); 21 Nov 2014 16:53:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:53:34 +0000
Date: Fri, 21 Nov 2014 16:53:34 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757015.1416588670000.554695.1416588814138@Atlassian.JIRA>
In-Reply-To: <JIRA.12757015.1416588670000@Atlassian.JIRA>
References: <JIRA.12757015.1416588670000@Atlassian.JIRA> <JIRA.12757015.1416588670139@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-801) Bookkeeper client tutorial
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-801?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-801:
----------------------------------
    Attachment: 0001-Bookkeeper-tutorial.patch

Postprocessing it looks like: http://bk.ivankelly.net/bookkeeper/docs/trunk/bookkeeperTutorial.html

> Bookkeeper client tutorial
> --------------------------
>
>                 Key: BOOKKEEPER-801
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-801
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-Bookkeeper-tutorial.patch
>
>
> Taking the tutorial from https://github.com/ivankelly/bookkeeper-tutorial and adding it to the bookkeeper docs.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11637-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:55:49 2014
Return-Path: <bookkeeper-dev-return-11637-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8C6311098D
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:55:49 +0000 (UTC)
Received: (qmail 56492 invoked by uid 500); 21 Nov 2014 16:55:49 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 56459 invoked by uid 500); 21 Nov 2014 16:55:49 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 56444 invoked by uid 99); 21 Nov 2014 16:55:49 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:55:49 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id 526FB1FB754;
	Fri, 21 Nov 2014 16:55:48 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============0975184541443487912=="
MIME-Version: 1.0
Subject: Review Request 28333: bookkeeper client tutorial
From: "Ivan Kelly" <ivank@apache.org>
To: "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Fri, 21 Nov 2014 16:55:48 -0000
Message-ID: <20141121165548.15325.63301@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/28333/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>
X-ReviewRequest-Repository: bookkeeper-git

--===============0975184541443487912==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/28333/
-----------------------------------------------------------

Review request for bookkeeper.


Bugs: BOOKKEEPER-801
    https://issues.apache.org/jira/browse/BOOKKEEPER-801


Repository: bookkeeper-git


Description
-------

bookkeeper client tutorial


Diffs
-----

  doc/bookkeeperTutorial.textile PRE-CREATION 

Diff: https://reviews.apache.org/r/28333/diff/


Testing
-------


Thanks,

Ivan Kelly


--===============0975184541443487912==--

From bookkeeper-dev-return-11638-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:56:34 2014
Return-Path: <bookkeeper-dev-return-11638-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E4D9610996
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:56:33 +0000 (UTC)
Received: (qmail 61440 invoked by uid 500); 21 Nov 2014 16:56:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 61404 invoked by uid 500); 21 Nov 2014 16:56:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 61392 invoked by uid 99); 21 Nov 2014 16:56:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:56:33 +0000
Date: Fri, 21 Nov 2014 16:56:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757015.1416588670000.554706.1416588993632@Atlassian.JIRA>
In-Reply-To: <JIRA.12757015.1416588670000@Atlassian.JIRA>
References: <JIRA.12757015.1416588670000@Atlassian.JIRA> <JIRA.12757015.1416588670139@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-801) Bookkeeper client tutorial
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-801?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221116#comment-14221116 ] 

Ivan Kelly commented on BOOKKEEPER-801:
---------------------------------------

https://reviews.apache.org/r/28333/

> Bookkeeper client tutorial
> --------------------------
>
>                 Key: BOOKKEEPER-801
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-801
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-Bookkeeper-tutorial.patch
>
>
> Taking the tutorial from https://github.com/ivankelly/bookkeeper-tutorial and adding it to the bookkeeper docs.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11639-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:56:34 2014
Return-Path: <bookkeeper-dev-return-11639-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1327010998
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:56:34 +0000 (UTC)
Received: (qmail 61525 invoked by uid 500); 21 Nov 2014 16:56:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 61491 invoked by uid 500); 21 Nov 2014 16:56:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 61480 invoked by uid 99); 21 Nov 2014 16:56:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:56:33 +0000
Date: Fri, 21 Nov 2014 16:56:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.554708.1416588993888@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Created] (BOOKKEEPER-802) Bookkeeper protocol documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Ivan Kelly created BOOKKEEPER-802:
-------------------------------------

             Summary: Bookkeeper protocol documentation
                 Key: BOOKKEEPER-802
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
             Project: Bookkeeper
          Issue Type: Bug
            Reporter: Ivan Kelly
            Assignee: Ivan Kelly
             Fix For: 4.4.0






--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11640-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:57:34 2014
Return-Path: <bookkeeper-dev-return-11640-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D7FA31099B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:57:33 +0000 (UTC)
Received: (qmail 62010 invoked by uid 500); 21 Nov 2014 16:57:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 61965 invoked by uid 500); 21 Nov 2014 16:57:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 61953 invoked by uid 99); 21 Nov 2014 16:57:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:57:33 +0000
Date: Fri, 21 Nov 2014 16:57:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.554709.1416589053654@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-802) Bookkeeper protocol documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-802?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-802:
----------------------------------
    Description: We need a precise description of the bookkeeper protocol and the guarantees therein.

> Bookkeeper protocol documentation
> ---------------------------------
>
>                 Key: BOOKKEEPER-802
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>
> We need a precise description of the bookkeeper protocol and the guarantees therein.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11641-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:58:34 2014
Return-Path: <bookkeeper-dev-return-11641-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0A034109A7
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:58:34 +0000 (UTC)
Received: (qmail 64899 invoked by uid 500); 21 Nov 2014 16:58:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 64856 invoked by uid 500); 21 Nov 2014 16:58:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 64840 invoked by uid 99); 21 Nov 2014 16:58:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:58:33 +0000
Date: Fri, 21 Nov 2014 16:58:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.554712.1416589113679@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-802) Bookkeeper protocol documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-802?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-802:
----------------------------------
    Attachment: 0002-Protocol.patch

Preview: http://bk.ivankelly.net/bookkeeper/docs/trunk/bookkeeperProtocol.html

> Bookkeeper protocol documentation
> ---------------------------------
>
>                 Key: BOOKKEEPER-802
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0002-Protocol.patch
>
>
> We need a precise description of the bookkeeper protocol and the guarantees therein.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11642-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:58:47 2014
Return-Path: <bookkeeper-dev-return-11642-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CA6C3109A9
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:58:47 +0000 (UTC)
Received: (qmail 65544 invoked by uid 500); 21 Nov 2014 16:58:47 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 65509 invoked by uid 500); 21 Nov 2014 16:58:47 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 65486 invoked by uid 99); 21 Nov 2014 16:58:47 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:58:47 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id 2A5A71FB754;
	Fri, 21 Nov 2014 16:58:46 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============5926214530126546016=="
MIME-Version: 1.0
Subject: Review Request 28334: Bookkeeper protocol
From: "Ivan Kelly" <ivank@apache.org>
To: "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Fri, 21 Nov 2014 16:58:46 -0000
Message-ID: <20141121165846.15325.96377@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/28334/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>
X-ReviewRequest-Repository: bookkeeper-git

--===============5926214530126546016==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/28334/
-----------------------------------------------------------

Review request for bookkeeper.


Bugs: BOOKKEEPER-802
    https://issues.apache.org/jira/browse/BOOKKEEPER-802


Repository: bookkeeper-git


Description
-------

description of bookkeeper protocol


Diffs
-----

  doc/bookkeeperProtocol.textile PRE-CREATION 

Diff: https://reviews.apache.org/r/28334/diff/


Testing
-------


Thanks,

Ivan Kelly


--===============5926214530126546016==--

From bookkeeper-dev-return-11643-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 16:59:34 2014
Return-Path: <bookkeeper-dev-return-11643-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 59E0E109B7
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 16:59:34 +0000 (UTC)
Received: (qmail 67883 invoked by uid 500); 21 Nov 2014 16:59:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 67840 invoked by uid 500); 21 Nov 2014 16:59:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 67620 invoked by uid 99); 21 Nov 2014 16:59:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 16:59:33 +0000
Date: Fri, 21 Nov 2014 16:59:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.554723.1416589173918@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-802) Bookkeeper protocol
 documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-802?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221120#comment-14221120 ] 

Ivan Kelly commented on BOOKKEEPER-802:
---------------------------------------

https://reviews.apache.org/r/28334/

> Bookkeeper protocol documentation
> ---------------------------------
>
>                 Key: BOOKKEEPER-802
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0002-Protocol.patch
>
>
> We need a precise description of the bookkeeper protocol and the guarantees therein.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11644-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 17:00:39 2014
Return-Path: <bookkeeper-dev-return-11644-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B3263109C7
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 17:00:39 +0000 (UTC)
Received: (qmail 69101 invoked by uid 500); 21 Nov 2014 17:00:39 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 68988 invoked by uid 500); 21 Nov 2014 17:00:39 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 68720 invoked by uid 99); 21 Nov 2014 17:00:39 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 17:00:39 +0000
Date: Fri, 21 Nov 2014 17:00:39 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757019.1416589224000.554729.1416589239162@Atlassian.JIRA>
In-Reply-To: <JIRA.12757019.1416589224000@Atlassian.JIRA>
References: <JIRA.12757019.1416589224000@Atlassian.JIRA> <JIRA.12757019.1416589224219@arcas>
Subject: [jira] [Created] (BOOKKEEPER-803) Guide for making a replicated log
 out of ledgers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Ivan Kelly created BOOKKEEPER-803:
-------------------------------------

             Summary: Guide for making a replicated log out of ledgers
                 Key: BOOKKEEPER-803
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-803
             Project: Bookkeeper
          Issue Type: Bug
            Reporter: Ivan Kelly
            Assignee: Ivan Kelly
             Fix For: 4.4.0


We need a guide to show people how to create a replicated log out of ledgers, as ledgers on their own aren't enough.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11645-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 17:01:34 2014
Return-Path: <bookkeeper-dev-return-11645-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A220F109CA
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 17:01:34 +0000 (UTC)
Received: (qmail 70014 invoked by uid 500); 21 Nov 2014 17:01:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 69972 invoked by uid 500); 21 Nov 2014 17:01:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 69960 invoked by uid 99); 21 Nov 2014 17:01:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 17:01:34 +0000
Date: Fri, 21 Nov 2014 17:01:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757019.1416589224000.554732.1416589293680@Atlassian.JIRA>
In-Reply-To: <JIRA.12757019.1416589224000@Atlassian.JIRA>
References: <JIRA.12757019.1416589224000@Atlassian.JIRA> <JIRA.12757019.1416589224219@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-803) Guide for making a replicated log
 out of ledgers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-803?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-803:
----------------------------------
    Attachment: 0003-Ledgers-2-logs.patch

Preview: http://bk.ivankelly.net/bookkeeper/docs/trunk/bookkeeperLedgers2Logs.html

> Guide for making a replicated log out of ledgers
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-803
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-803
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0003-Ledgers-2-logs.patch
>
>
> We need a guide to show people how to create a replicated log out of ledgers, as ledgers on their own aren't enough.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11646-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 17:02:41 2014
Return-Path: <bookkeeper-dev-return-11646-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AF578109D4
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 17:02:41 +0000 (UTC)
Received: (qmail 73174 invoked by uid 500); 21 Nov 2014 17:02:41 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 73140 invoked by uid 500); 21 Nov 2014 17:02:41 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 73125 invoked by uid 99); 21 Nov 2014 17:02:41 -0000
Received: from reviews-vm.apache.org (HELO reviews.apache.org) (140.211.11.40)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 17:02:41 +0000
Received: from reviews.apache.org (localhost [127.0.0.1])
	by reviews.apache.org (Postfix) with ESMTP id 5F4751FB754;
	Fri, 21 Nov 2014 17:02:40 +0000 (UTC)
Content-Type: multipart/alternative;
 boundary="===============5696020109812916043=="
MIME-Version: 1.0
Subject: Review Request 28335: Making logs out of ledgers
From: "Ivan Kelly" <ivank@apache.org>
To: "Ivan Kelly" <ivank@apache.org>,
 "bookkeeper" <bookkeeper-dev@zookeeper.apache.org>
Date: Fri, 21 Nov 2014 17:02:40 -0000
Message-ID: <20141121170240.15353.28915@reviews.apache.org>
X-ReviewBoard-URL: https://reviews.apache.org
Auto-Submitted: auto-generated
Sender: "Ivan Kelly" <noreply@reviews.apache.org>
X-ReviewGroup: bookkeeper
X-ReviewRequest-URL: https://reviews.apache.org/r/28335/
X-Sender: "Ivan Kelly" <noreply@reviews.apache.org>
Reply-To: "Ivan Kelly" <ivank@apache.org>
X-ReviewRequest-Repository: bookkeeper-git

--===============5696020109812916043==
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 7bit


-----------------------------------------------------------
This is an automatically generated e-mail. To reply, visit:
https://reviews.apache.org/r/28335/
-----------------------------------------------------------

Review request for bookkeeper.


Bugs: BOOKKEEPER-803
    https://issues.apache.org/jira/browse/BOOKKEEPER-803


Repository: bookkeeper-git


Description
-------

A document on how to use ledgers.


Diffs
-----

  doc/bookkeeperLedgers2Logs.textile PRE-CREATION 

Diff: https://reviews.apache.org/r/28335/diff/


Testing
-------


Thanks,

Ivan Kelly


--===============5696020109812916043==--

From bookkeeper-dev-return-11647-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 17:03:33 2014
Return-Path: <bookkeeper-dev-return-11647-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CBFA3109DE
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 17:03:33 +0000 (UTC)
Received: (qmail 73919 invoked by uid 500); 21 Nov 2014 17:03:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 73881 invoked by uid 500); 21 Nov 2014 17:03:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 73868 invoked by uid 99); 21 Nov 2014 17:03:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 17:03:33 +0000
Date: Fri, 21 Nov 2014 17:03:33 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757019.1416589224000.554750.1416589413634@Atlassian.JIRA>
In-Reply-To: <JIRA.12757019.1416589224000@Atlassian.JIRA>
References: <JIRA.12757019.1416589224000@Atlassian.JIRA> <JIRA.12757019.1416589224219@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-803) Guide for making a replicated
 log out of ledgers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-803?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221127#comment-14221127 ] 

Ivan Kelly commented on BOOKKEEPER-803:
---------------------------------------

https://reviews.apache.org/r/28335/

> Guide for making a replicated log out of ledgers
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-803
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-803
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0003-Ledgers-2-logs.patch
>
>
> We need a guide to show people how to create a replicated log out of ledgers, as ledgers on their own aren't enough.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11648-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 17:36:34 2014
Return-Path: <bookkeeper-dev-return-11648-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4E19310AF3
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 17:36:34 +0000 (UTC)
Received: (qmail 78268 invoked by uid 500); 21 Nov 2014 17:36:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 78175 invoked by uid 500); 21 Nov 2014 17:36:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 78007 invoked by uid 99); 21 Nov 2014 17:36:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 17:36:33 +0000
Date: Fri, 21 Nov 2014 17:36:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.554918.1416591393897@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-802) Bookkeeper protocol
 documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-802?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221153#comment-14221153 ] 

Hadoop QA commented on BOOKKEEPER-802:
--------------------------------------

Testing JIRA BOOKKEEPER-802


Patch [0002-Protocol.patch|https://issues.apache.org/jira/secure/attachment/12682909/0002-Protocol.patch] downloaded at Fri Nov 21 17:00:20 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/828/

> Bookkeeper protocol documentation
> ---------------------------------
>
>                 Key: BOOKKEEPER-802
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0002-Protocol.patch
>
>
> We need a precise description of the bookkeeper protocol and the guarantees therein.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11649-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 18:12:34 2014
Return-Path: <bookkeeper-dev-return-11649-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5813110C2D
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 18:12:34 +0000 (UTC)
Received: (qmail 63055 invoked by uid 500); 21 Nov 2014 18:12:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 63019 invoked by uid 500); 21 Nov 2014 18:12:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 63006 invoked by uid 99); 21 Nov 2014 18:12:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 18:12:34 +0000
Date: Fri, 21 Nov 2014 18:12:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757015.1416588670000.555093.1416593554175@Atlassian.JIRA>
In-Reply-To: <JIRA.12757015.1416588670000@Atlassian.JIRA>
References: <JIRA.12757015.1416588670000@Atlassian.JIRA> <JIRA.12757015.1416588670139@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-801) Bookkeeper client tutorial
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-801?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221183#comment-14221183 ] 

Hadoop QA commented on BOOKKEEPER-801:
--------------------------------------

Testing JIRA BOOKKEEPER-801


Patch [0001-Bookkeeper-tutorial.patch|https://issues.apache.org/jira/secure/attachment/12682908/0001-Bookkeeper-tutorial.patch] downloaded at Fri Nov 21 17:36:44 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/829/

> Bookkeeper client tutorial
> --------------------------
>
>                 Key: BOOKKEEPER-801
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-801
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-Bookkeeper-tutorial.patch
>
>
> Taking the tutorial from https://github.com/ivankelly/bookkeeper-tutorial and adding it to the bookkeeper docs.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11650-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 18:48:34 2014
Return-Path: <bookkeeper-dev-return-11650-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2D76910D84
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 18:48:34 +0000 (UTC)
Received: (qmail 53039 invoked by uid 500); 21 Nov 2014 18:48:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 52998 invoked by uid 500); 21 Nov 2014 18:48:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 52985 invoked by uid 99); 21 Nov 2014 18:48:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 18:48:34 +0000
Date: Fri, 21 Nov 2014 18:48:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757019.1416589224000.555352.1416595713982@Atlassian.JIRA>
In-Reply-To: <JIRA.12757019.1416589224000@Atlassian.JIRA>
References: <JIRA.12757019.1416589224000@Atlassian.JIRA> <JIRA.12757019.1416589224219@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-803) Guide for making a replicated
 log out of ledgers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-803?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221239#comment-14221239 ] 

Hadoop QA commented on BOOKKEEPER-803:
--------------------------------------

Testing JIRA BOOKKEEPER-803


Patch [0003-Ledgers-2-logs.patch|https://issues.apache.org/jira/secure/attachment/12682911/0003-Ledgers-2-logs.patch] downloaded at Fri Nov 21 18:12:49 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 852
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/830/

> Guide for making a replicated log out of ledgers
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-803
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-803
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0003-Ledgers-2-logs.patch
>
>
> We need a guide to show people how to create a replicated log out of ledgers, as ledgers on their own aren't enough.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11651-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 19:25:34 2014
Return-Path: <bookkeeper-dev-return-11651-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BAF691119B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 19:25:34 +0000 (UTC)
Received: (qmail 28555 invoked by uid 500); 21 Nov 2014 19:25:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 28524 invoked by uid 500); 21 Nov 2014 19:25:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 28513 invoked by uid 99); 21 Nov 2014 19:25:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 19:25:34 +0000
Date: Fri, 21 Nov 2014 19:25:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757019.1416589224000.555687.1416597934548@Atlassian.JIRA>
In-Reply-To: <JIRA.12757019.1416589224000@Atlassian.JIRA>
References: <JIRA.12757019.1416589224000@Atlassian.JIRA> <JIRA.12757019.1416589224219@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-803) Guide for making a replicated
 log out of ledgers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-803?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221308#comment-14221308 ] 

Hadoop QA commented on BOOKKEEPER-803:
--------------------------------------

Testing JIRA BOOKKEEPER-803


Patch [0003-Ledgers-2-logs.patch|https://issues.apache.org/jira/secure/attachment/12682911/0003-Ledgers-2-logs.patch] downloaded at Fri Nov 21 18:50:22 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/831/

> Guide for making a replicated log out of ledgers
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-803
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-803
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0003-Ledgers-2-logs.patch
>
>
> We need a guide to show people how to create a replicated log out of ledgers, as ledgers on their own aren't enough.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11652-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 20:01:34 2014
Return-Path: <bookkeeper-dev-return-11652-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 828F81729B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 20:01:34 +0000 (UTC)
Received: (qmail 31663 invoked by uid 500); 21 Nov 2014 20:01:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 31632 invoked by uid 500); 21 Nov 2014 20:01:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 31621 invoked by uid 99); 21 Nov 2014 20:01:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 20:01:34 +0000
Date: Fri, 21 Nov 2014 20:01:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757015.1416588670000.555920.1416600094061@Atlassian.JIRA>
In-Reply-To: <JIRA.12757015.1416588670000@Atlassian.JIRA>
References: <JIRA.12757015.1416588670000@Atlassian.JIRA> <JIRA.12757015.1416588670139@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-801) Bookkeeper client tutorial
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-801?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221351#comment-14221351 ] 

Hadoop QA commented on BOOKKEEPER-801:
--------------------------------------

Testing JIRA BOOKKEEPER-801


Patch [0001-Bookkeeper-tutorial.patch|https://issues.apache.org/jira/secure/attachment/12682908/0001-Bookkeeper-tutorial.patch] downloaded at Fri Nov 21 19:25:44 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/832/

> Bookkeeper client tutorial
> --------------------------
>
>                 Key: BOOKKEEPER-801
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-801
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-Bookkeeper-tutorial.patch
>
>
> Taking the tutorial from https://github.com/ivankelly/bookkeeper-tutorial and adding it to the bookkeeper docs.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11653-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 20:37:34 2014
Return-Path: <bookkeeper-dev-return-11653-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7398317466
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 20:37:34 +0000 (UTC)
Received: (qmail 10614 invoked by uid 500); 21 Nov 2014 20:37:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 10588 invoked by uid 500); 21 Nov 2014 20:37:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 10476 invoked by uid 99); 21 Nov 2014 20:37:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 20:37:34 +0000
Date: Fri, 21 Nov 2014 20:37:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.556085.1416602254227@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-802) Bookkeeper protocol
 documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-802?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221390#comment-14221390 ] 

Hadoop QA commented on BOOKKEEPER-802:
--------------------------------------

Testing JIRA BOOKKEEPER-802


Patch [0002-Protocol.patch|https://issues.apache.org/jira/secure/attachment/12682909/0002-Protocol.patch] downloaded at Fri Nov 21 20:01:13 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/833/

> Bookkeeper protocol documentation
> ---------------------------------
>
>                 Key: BOOKKEEPER-802
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0002-Protocol.patch
>
>
> We need a precise description of the bookkeeper protocol and the guarantees therein.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11654-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 21:13:34 2014
Return-Path: <bookkeeper-dev-return-11654-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4988E175F8
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 21:13:34 +0000 (UTC)
Received: (qmail 4031 invoked by uid 500); 21 Nov 2014 21:13:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 3991 invoked by uid 500); 21 Nov 2014 21:13:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 3979 invoked by uid 99); 21 Nov 2014 21:13:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 21:13:34 +0000
Date: Fri, 21 Nov 2014 21:13:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.556343.1416604414103@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-800) Expose whether a ledger is
 closed or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221438#comment-14221438 ] 

Hadoop QA commented on BOOKKEEPER-800:
--------------------------------------

Testing JIRA BOOKKEEPER-800


Patch [0001-Expose-whether-a-ledger-has-been-closed.patch|https://issues.apache.org/jira/secure/attachment/12682903/0001-Expose-whether-a-ledger-has-been-closed.patch] downloaded at Fri Nov 21 20:37:14 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/834/

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch, 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11655-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 21 21:48:34 2014
Return-Path: <bookkeeper-dev-return-11655-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CA7A4177E3
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 21 Nov 2014 21:48:34 +0000 (UTC)
Received: (qmail 78191 invoked by uid 500); 21 Nov 2014 21:48:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 78154 invoked by uid 500); 21 Nov 2014 21:48:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 78143 invoked by uid 99); 21 Nov 2014 21:48:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 21 Nov 2014 21:48:34 +0000
Date: Fri, 21 Nov 2014 21:48:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.556503.1416606514274@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221471#comment-14221471 ] 

Hadoop QA commented on BOOKKEEPER-799:
--------------------------------------

Testing JIRA BOOKKEEPER-799


Patch [0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch|https://issues.apache.org/jira/secure/attachment/12682858/0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch] downloaded at Fri Nov 21 21:13:05 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 931
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/835/

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11656-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 00:06:34 2014
Return-Path: <bookkeeper-dev-return-11656-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 128DB17B99
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 00:06:34 +0000 (UTC)
Received: (qmail 32096 invoked by uid 500); 22 Nov 2014 00:06:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 32058 invoked by uid 500); 22 Nov 2014 00:06:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 32046 invoked by uid 99); 22 Nov 2014 00:06:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 00:06:33 +0000
Date: Sat, 22 Nov 2014 00:06:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.557487.1416614793885@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221620#comment-14221620 ] 

Hadoop QA commented on BOOKKEEPER-799:
--------------------------------------

Testing JIRA BOOKKEEPER-799


Patch [0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch|https://issues.apache.org/jira/secure/attachment/12682858/0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch] downloaded at Fri Nov 21 23:30:17 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 931
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/836/

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11657-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 00:42:34 2014
Return-Path: <bookkeeper-dev-return-11657-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1856A17C6F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 00:42:34 +0000 (UTC)
Received: (qmail 92868 invoked by uid 500); 22 Nov 2014 00:42:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 92833 invoked by uid 500); 22 Nov 2014 00:42:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 92820 invoked by uid 99); 22 Nov 2014 00:42:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 00:42:33 +0000
Date: Sat, 22 Nov 2014 00:42:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.557660.1416616953910@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-800) Expose whether a ledger is
 closed or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221652#comment-14221652 ] 

Hadoop QA commented on BOOKKEEPER-800:
--------------------------------------

Testing JIRA BOOKKEEPER-800


Patch [0001-Expose-whether-a-ledger-has-been-closed.patch|https://issues.apache.org/jira/secure/attachment/12682903/0001-Expose-whether-a-ledger-has-been-closed.patch] downloaded at Sat Nov 22 00:06:02 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/837/

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch, 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11658-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 01:17:34 2014
Return-Path: <bookkeeper-dev-return-11658-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 382B817DB7
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 01:17:34 +0000 (UTC)
Received: (qmail 61169 invoked by uid 500); 22 Nov 2014 01:17:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 61131 invoked by uid 500); 22 Nov 2014 01:17:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 60953 invoked by uid 99); 22 Nov 2014 01:17:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 01:17:34 +0000
Date: Sat, 22 Nov 2014 01:17:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.557955.1416619054040@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-802) Bookkeeper protocol
 documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-802?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221694#comment-14221694 ] 

Hadoop QA commented on BOOKKEEPER-802:
--------------------------------------

Testing JIRA BOOKKEEPER-802


Patch [0002-Protocol.patch|https://issues.apache.org/jira/secure/attachment/12682909/0002-Protocol.patch] downloaded at Sat Nov 22 00:41:59 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/838/

> Bookkeeper protocol documentation
> ---------------------------------
>
>                 Key: BOOKKEEPER-802
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0002-Protocol.patch
>
>
> We need a precise description of the bookkeeper protocol and the guarantees therein.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11659-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 01:53:34 2014
Return-Path: <bookkeeper-dev-return-11659-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A8EE617E9C
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 01:53:34 +0000 (UTC)
Received: (qmail 10277 invoked by uid 500); 22 Nov 2014 01:53:34 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 10239 invoked by uid 500); 22 Nov 2014 01:53:34 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 10227 invoked by uid 99); 22 Nov 2014 01:53:34 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 01:53:34 +0000
Date: Sat, 22 Nov 2014 01:53:34 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757015.1416588670000.558234.1416621214293@Atlassian.JIRA>
In-Reply-To: <JIRA.12757015.1416588670000@Atlassian.JIRA>
References: <JIRA.12757015.1416588670000@Atlassian.JIRA> <JIRA.12757015.1416588670139@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-801) Bookkeeper client tutorial
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-801?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221737#comment-14221737 ] 

Hadoop QA commented on BOOKKEEPER-801:
--------------------------------------

Testing JIRA BOOKKEEPER-801


Patch [0001-Bookkeeper-tutorial.patch|https://issues.apache.org/jira/secure/attachment/12682908/0001-Bookkeeper-tutorial.patch] downloaded at Sat Nov 22 01:17:48 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/839/

> Bookkeeper client tutorial
> --------------------------
>
>                 Key: BOOKKEEPER-801
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-801
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-Bookkeeper-tutorial.patch
>
>
> Taking the tutorial from https://github.com/ivankelly/bookkeeper-tutorial and adding it to the bookkeeper docs.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11660-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 02:29:34 2014
Return-Path: <bookkeeper-dev-return-11660-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E493D17F59
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 02:29:33 +0000 (UTC)
Received: (qmail 51971 invoked by uid 500); 22 Nov 2014 02:29:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 51931 invoked by uid 500); 22 Nov 2014 02:29:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 51918 invoked by uid 99); 22 Nov 2014 02:29:33 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 02:29:33 +0000
Date: Sat, 22 Nov 2014 02:29:33 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757019.1416589224000.558415.1416623373752@Atlassian.JIRA>
In-Reply-To: <JIRA.12757019.1416589224000@Atlassian.JIRA>
References: <JIRA.12757019.1416589224000@Atlassian.JIRA> <JIRA.12757019.1416589224219@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-803) Guide for making a replicated
 log out of ledgers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-803?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14221759#comment-14221759 ] 

Hadoop QA commented on BOOKKEEPER-803:
--------------------------------------

Testing JIRA BOOKKEEPER-803


Patch [0003-Ledgers-2-logs.patch|https://issues.apache.org/jira/secure/attachment/12682911/0003-Ledgers-2-logs.patch] downloaded at Sat Nov 22 01:53:38 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/840/

> Guide for making a replicated log out of ledgers
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-803
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-803
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0003-Ledgers-2-logs.patch
>
>
> We need a guide to show people how to create a replicated log out of ledgers, as ledgers on their own aren't enough.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11661-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 12:45:31 2014
Return-Path: <bookkeeper-dev-return-11661-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E58F4CA0B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 12:45:30 +0000 (UTC)
Received: (qmail 61690 invoked by uid 500); 22 Nov 2014 12:45:30 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 61654 invoked by uid 500); 22 Nov 2014 12:45:30 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 61642 invoked by uid 99); 22 Nov 2014 12:45:29 -0000
Received: from crius.apache.org (HELO crius) (140.211.11.14)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 12:45:29 +0000
Received: from crius.apache.org (localhost [127.0.0.1])
	by crius (Postfix) with ESMTP id 045A6E00073
	for <bookkeeper-dev@zookeeper.apache.org>; Sat, 22 Nov 2014 12:45:28 +0000 (UTC)
Date: Sat, 22 Nov 2014 12:45:26 +0000 (UTC)
From: Apache Jenkins Server  <jenkins@builds.apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <1735336221.9015.1416660326060.JavaMail.jenkins@crius>
Subject: Build failed in Jenkins: bookkeeper-trunk #858
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: bookkeeper-trunk
X-Jenkins-Result: FAILURE

See <https://builds.apache.org/job/bookkeeper-trunk/858/>

------------------------------------------
[...truncated 1133 lines...]
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.748 sec
Running org.apache.hedwig.server.persistence.TestBookkeeperPersistenceManagerWhiteBox
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.198 sec
Running org.apache.hedwig.server.persistence.TestLocalDBPersistenceManagerBlackBox
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.735 sec
Running org.apache.hedwig.server.TestBackwardCompat
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.407 sec
Running org.apache.hedwig.server.delivery.TestThrottlingDelivery
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 22.928 sec
Running org.apache.hedwig.server.delivery.TestFIFODeliveryManager
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.508 sec
Running org.apache.hedwig.server.filter.TestMessageFilter
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 8.382 sec
Running org.apache.hedwig.server.meta.TestFactoryLayout
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.886 sec
Running org.apache.hedwig.server.meta.TestMetadataManager
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.406 sec
Running org.apache.hedwig.server.meta.TestMetadataManagerFactory
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.82 sec
Running org.apache.hedwig.server.topics.TestTopicBasedLoadShedder
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.654 sec
Running org.apache.hedwig.server.topics.TestZkTopicManager
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.011 sec
Running org.apache.hedwig.server.topics.TestMMTopicManager
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 29.699 sec
Running org.apache.hedwig.server.topics.TestHubInfo
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.274 sec
Running org.apache.hedwig.server.topics.TestHubLoad
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.268 sec
Running org.apache.hedwig.server.topics.TestConcurrentTopicAcquisition
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 7.029 sec
Running org.apache.hedwig.server.integration.TestHedwigRegion
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 127.522 sec
Running org.apache.hedwig.server.integration.TestHedwigHubProxy
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 39.408 sec
Running org.apache.hedwig.server.integration.TestHedwigHubSSL
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 66.673 sec
Running org.apache.hedwig.server.integration.TestHedwigHubRegular
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 38.268 sec
Running org.apache.hedwig.client.TestPubSubClient
Tests run: 36, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 33.147 sec
Running org.apache.hedwig.client.netty.TestMultiplexing
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 21.884 sec
Running org.apache.hedwig.client.TestSubAfterCloseSub
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.858 sec

Results :

Tests run: 317, Failures: 0, Errors: 0, Skipped: 0

[INFO] 
[INFO] --- maven-jar-plugin:2.3.1:jar (default-jar) @ hedwig-server ---
[INFO] Building jar: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/target/hedwig-server-4.4.0-SNAPSHOT.jar>
[INFO] 
[INFO] --- maven-dependency-plugin:2.8:copy-dependencies (default) @ hedwig-server ---
[INFO] Copying junit-4.8.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/junit-4.8.1.jar>
[INFO] Copying zookeeper-3.4.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/zookeeper-3.4.6.jar>
[INFO] Copying derby-10.8.2.2.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/derby-10.8.2.2.jar>
[INFO] Copying bookkeeper-server-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-server-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-logging-1.1.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-logging-1.1.1.jar>
[INFO] Copying slf4j-api-1.6.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/slf4j-api-1.6.4.jar>
[INFO] Copying commons-lang-2.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-lang-2.4.jar>
[INFO] Copying slf4j-log4j12-1.6.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/slf4j-log4j12-1.6.4.jar>
[INFO] Copying commons-collections-3.2.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-collections-3.2.1.jar>
[INFO] Copying hedwig-server-compat420-4.2.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat420-4.2.0.jar>
[INFO] Copying jline-0.9.94.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/jline-0.9.94.jar>
[INFO] Copying commons-beanutils-1.7.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-beanutils-1.7.0.jar>
[INFO] Copying bookkeeper-stats-api-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-stats-api-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-io-2.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-io-2.1.jar>
[INFO] Copying zookeeper-3.4.6-tests.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/zookeeper-3.4.6-tests.jar>
[INFO] Copying log4j-1.2.15.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/log4j-1.2.15.jar>
[INFO] Copying commons-configuration-1.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-configuration-1.6.jar>
[INFO] Copying commons-digester-1.8.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-digester-1.8.jar>
[INFO] Copying guava-13.0.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/guava-13.0.1.jar>
[INFO] Copying netty-3.9.4.Final.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/netty-3.9.4.Final.jar>
[INFO] Copying hedwig-client-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-client-4.4.0-SNAPSHOT.jar>
[INFO] Copying bookkeeper-server-4.4.0-SNAPSHOT-tests.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-server-4.4.0-SNAPSHOT-tests.jar>
[INFO] Copying hedwig-protocol-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-protocol-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-beanutils-core-1.8.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-beanutils-core-1.8.0.jar>
[INFO] Copying hedwig-server-compat400-4.0.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat400-4.0.0.jar>
[INFO] Copying jna-3.2.7.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/jna-3.2.7.jar>
[INFO] Copying hedwig-server-compat410-4.1.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat410-4.1.0.jar>
[INFO] Copying commons-cli-1.2.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-cli-1.2.jar>
[INFO] Copying protobuf-java-2.4.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/protobuf-java-2.4.1.jar>
[INFO] Copying commons-codec-1.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-codec-1.6.jar>
[INFO] 
[INFO] --- maven-jar-plugin:2.3.1:test-jar (default) @ hedwig-server ---
[INFO] Building jar: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/target/hedwig-server-4.4.0-SNAPSHOT-tests.jar>
[INFO] 
[INFO] >>> findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server >>>
[INFO] 
[INFO] --- findbugs-maven-plugin:2.5.2:findbugs (findbugs) @ hedwig-server ---
[INFO] Fork Value is true
     [java] The following classes needed for analysis were missing:
     [java]   com.google.protobuf.Parser
     [java] Missing classes: 1
[INFO] Done FindBugs Analysis....
[INFO] 
[INFO] <<< findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server <<<
[INFO] 
[INFO] --- findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server ---
[INFO] BugInstance size is 0
[INFO] Error size is 0
[INFO] No errors/warnings found
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building hedwig-client-jms 4.4.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-clean-plugin:2.4.1:clean (default-clean) @ hedwig-client-jms ---
[INFO] 
[INFO] --- apache-rat-plugin:0.7:check (default-cli) @ hedwig-client-jms ---
[INFO] Exclude: **/JmsHeader.java
[INFO] 
[INFO] --- javacc-maven-plugin:2.6:jjtree-javacc (jjtree-javacc) @ hedwig-client-jms ---
Java Compiler Compiler Version 5.0 (Tree Builder)
(type "jjtree" with no arguments for help)
Reading from file <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/src/main/grammar/javacc/selector_grammar.jjt> . . .
File "Node.java" does not exist.  Will create one.
File "SimpleNode.java" does not exist.  Will create one.
File "ASTOrExpr.java" does not exist.  Will create one.
File "ASTAndExpr.java" does not exist.  Will create one.
File "ASTNotExpr.java" does not exist.  Will create one.
File "ASTGreaterThan.java" does not exist.  Will create one.
File "ASTLessThan.java" does not exist.  Will create one.
File "ASTLessThanEqualTo.java" does not exist.  Will create one.
File "ASTGreaterThanEqualTo.java" does not exist.  Will create one.
File "ASTEqualTo.java" does not exist.  Will create one.
File "ASTNotEqualTo.java" does not exist.  Will create one.
File "ASTIsNullExpr.java" does not exist.  Will create one.
File "ASTBetweenExpr.java" does not exist.  Will create one.
File "ASTInExpr.java" does not exist.  Will create one.
File "ASTLikeExpr.java" does not exist.  Will create one.
File "ASTAddExpr.java" does not exist.  Will create one.
File "ASTSubExpr.java" does not exist.  Will create one.
File "ASTDivideExpr.java" does not exist.  Will create one.
File "ASTMultiplyExpr.java" does not exist.  Will create one.
File "ASTNegateExpr.java" does not exist.  Will create one.
File "ASTLookupExpr.java" does not exist.  Will create one.
File "ASTConstant.java" does not exist.  Will create one.
File "ASTStringVarargParams.java" does not exist.  Will create one.
File "SelectorParserTreeConstants.java" does not exist.  Will create one.
File "SelectorParserVisitor.java" does not exist.  Will create one.
File "JJTSelectorParserState.java" does not exist.  Will create one.
Annotated grammar generated successfully in <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/javacc-1416660306135/node/selector_grammar.jj>
Java Compiler Compiler Version 5.0 (Parser Generator)
(type "javacc" with no arguments for help)
Reading from file <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/javacc-1416660306135/node/selector_grammar.jj> . . .
Warning: Line 296, Column 3: Non-ASCII characters used in regular expression.
Please make sure you use the correct Reader when you create the parser, one that can handle your character set.
File "TokenMgrError.java" does not exist.  Will create one.
File "ParseException.java" does not exist.  Will create one.
File "Token.java" does not exist.  Will create one.
File "SimpleCharStream.java" does not exist.  Will create one.
Parser generated with 0 errors and 1 warnings.
[INFO] Processed 1 grammar
[INFO] 
[INFO] --- maven-remote-resources-plugin:1.1:process (default) @ hedwig-client-jms ---
[INFO] 
[INFO] --- maven-resources-plugin:2.4.3:resources (default-resources) @ hedwig-client-jms ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.0:compile (default-compile) @ hedwig-client-jms ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 76 source files to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/classes>
[INFO] 
[INFO] --- maven-resources-plugin:2.4.3:testResources (default-testResources) @ hedwig-client-jms ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/src/test/resources>
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.0:testCompile (default-testCompile) @ hedwig-client-jms ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 104 source files to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/test-classes>
[INFO] 
[INFO] --- maven-surefire-plugin:2.9:test (default-test) @ hedwig-client-jms ---
[INFO] Tests are skipped.
[INFO] 
[INFO] --- maven-surefire-plugin:2.9:test (unit-tests) @ hedwig-client-jms ---
[INFO] Surefire report directory: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/surefire-reports>

-------------------------------------------------------
 T E S T S
-------------------------------------------------------

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.hedwig.jms.selector.activemq.SelectorTest
Tests run: 19, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.238 sec
Running org.apache.hedwig.jms.selector.activemq.SelectorParserTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.214 sec
Running org.apache.hedwig.jms.selector.BasicSelectorGrammarTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.245 sec
Running org.apache.hedwig.jms.BasicJMSTest
Tests run: 3, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 3.241 sec <<< FAILURE!

Results :

Failed tests:   testSimpleChat(org.apache.hedwig.jms.BasicJMSTest): true

Tests run: 26, Failures: 1, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] bookkeeper ........................................ SUCCESS [  2.340 s]
[INFO] compability dependencies .......................... SUCCESS [  0.066 s]
[INFO] bookkeeper-server-compat400 ....................... SUCCESS [  4.130 s]
[INFO] bookkeeper-server-compat410 ....................... SUCCESS [  2.319 s]
[INFO] bookkeeper-server-compat420 ....................... SUCCESS [  2.606 s]
[INFO] hedwig-server-compat400 ........................... SUCCESS [  3.600 s]
[INFO] hedwig-server-compat410 ........................... SUCCESS [  3.722 s]
[INFO] hedwig-server-compat420 ........................... SUCCESS [  4.196 s]
[INFO] hedwig-protocol ................................... SUCCESS [ 24.162 s]
[INFO] Stats API for bookkeeper .......................... SUCCESS [  6.450 s]
[INFO] bookkeeper-server ................................. SUCCESS [14:26 min]
[INFO] hedwig-client ..................................... SUCCESS [ 14.433 s]
[INFO] hedwig-server ..................................... SUCCESS [12:16 min]
[INFO] hedwig-client-jms ................................. FAILURE [  7.156 s]
[INFO] bookkeeper-benchmark .............................. SKIPPED
[INFO] Stats provider for twitter-stats package .......... SKIPPED
[INFO] Stats provider for twitter-ostrich package ........ SKIPPED
[INFO] Stats provider for codahale metrics ............... SKIPPED
[INFO] bookkeeper-stats-providers ........................ SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 27:58 min
[INFO] Finished at: 2014-11-22T12:45:12+00:00
[INFO] Final Memory: 58M/641M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.9:test (unit-tests) on project hedwig-client-jms: There are test failures.
[ERROR] 
[ERROR] Please refer to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/surefire-reports> for the individual test results.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
[ERROR] 
[ERROR] After correcting the problems, you can resume the build with the command
[ERROR]   mvn <goals> -rf :hedwig-client-jms
Build step 'Execute shell' marked build as failure
Recording test results

From bookkeeper-dev-return-11662-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 21:06:12 2014
Return-Path: <bookkeeper-dev-return-11662-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D8BAD10AD2
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 21:06:12 +0000 (UTC)
Received: (qmail 64422 invoked by uid 500); 22 Nov 2014 21:06:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 64383 invoked by uid 500); 22 Nov 2014 21:06:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 64372 invoked by uid 99); 22 Nov 2014 21:06:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 21:06:12 +0000
Date: Sat, 22 Nov 2014 21:06:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757019.1416589224000.729.1416690372680@Atlassian.JIRA>
In-Reply-To: <JIRA.12757019.1416589224000@Atlassian.JIRA>
References: <JIRA.12757019.1416589224000@Atlassian.JIRA> <JIRA.12757019.1416589224219@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-803) Guide for making a replicated
 log out of ledgers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-803?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222183#comment-14222183 ] 

Hadoop QA commented on BOOKKEEPER-803:
--------------------------------------

Testing JIRA BOOKKEEPER-803


Patch [0003-Ledgers-2-logs.patch|https://issues.apache.org/jira/secure/attachment/12682911/0003-Ledgers-2-logs.patch] downloaded at Sat Nov 22 20:30:20 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/841/

> Guide for making a replicated log out of ledgers
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-803
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-803
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0003-Ledgers-2-logs.patch
>
>
> We need a guide to show people how to create a replicated log out of ledgers, as ledgers on their own aren't enough.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11663-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 21:43:12 2014
Return-Path: <bookkeeper-dev-return-11663-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C481010B56
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 21:43:12 +0000 (UTC)
Received: (qmail 1676 invoked by uid 500); 22 Nov 2014 21:43:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 1632 invoked by uid 500); 22 Nov 2014 21:43:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 1428 invoked by uid 99); 22 Nov 2014 21:43:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 21:43:12 +0000
Date: Sat, 22 Nov 2014 21:43:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757015.1416588670000.857.1416692592583@Atlassian.JIRA>
In-Reply-To: <JIRA.12757015.1416588670000@Atlassian.JIRA>
References: <JIRA.12757015.1416588670000@Atlassian.JIRA> <JIRA.12757015.1416588670139@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-801) Bookkeeper client tutorial
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-801?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222190#comment-14222190 ] 

Hadoop QA commented on BOOKKEEPER-801:
--------------------------------------

Testing JIRA BOOKKEEPER-801


Patch [0001-Bookkeeper-tutorial.patch|https://issues.apache.org/jira/secure/attachment/12682908/0001-Bookkeeper-tutorial.patch] downloaded at Sat Nov 22 21:06:16 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/842/

> Bookkeeper client tutorial
> --------------------------
>
>                 Key: BOOKKEEPER-801
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-801
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-Bookkeeper-tutorial.patch
>
>
> Taking the tutorial from https://github.com/ivankelly/bookkeeper-tutorial and adding it to the bookkeeper docs.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11664-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 22:19:12 2014
Return-Path: <bookkeeper-dev-return-11664-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D160210C59
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 22:19:12 +0000 (UTC)
Received: (qmail 38062 invoked by uid 500); 22 Nov 2014 22:19:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 38026 invoked by uid 500); 22 Nov 2014 22:19:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 38015 invoked by uid 99); 22 Nov 2014 22:19:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 22:19:12 +0000
Date: Sat, 22 Nov 2014 22:19:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.1003.1416694752451@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-802) Bookkeeper protocol
 documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-802?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222217#comment-14222217 ] 

Hadoop QA commented on BOOKKEEPER-802:
--------------------------------------

Testing JIRA BOOKKEEPER-802


Patch [0002-Protocol.patch|https://issues.apache.org/jira/secure/attachment/12682909/0002-Protocol.patch] downloaded at Sat Nov 22 21:43:13 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 929
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/843/

> Bookkeeper protocol documentation
> ---------------------------------
>
>                 Key: BOOKKEEPER-802
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0002-Protocol.patch
>
>
> We need a precise description of the bookkeeper protocol and the guarantees therein.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11665-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 22:55:12 2014
Return-Path: <bookkeeper-dev-return-11665-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E4D8710D36
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 22:55:12 +0000 (UTC)
Received: (qmail 77207 invoked by uid 500); 22 Nov 2014 22:55:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 77156 invoked by uid 500); 22 Nov 2014 22:55:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 77141 invoked by uid 99); 22 Nov 2014 22:55:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 22:55:12 +0000
Date: Sat, 22 Nov 2014 22:55:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.1101.1416696912679@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-800) Expose whether a ledger is
 closed or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222238#comment-14222238 ] 

Hadoop QA commented on BOOKKEEPER-800:
--------------------------------------

Testing JIRA BOOKKEEPER-800


Patch [0001-Expose-whether-a-ledger-has-been-closed.patch|https://issues.apache.org/jira/secure/attachment/12682903/0001-Expose-whether-a-ledger-has-been-closed.patch] downloaded at Sat Nov 22 22:18:38 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/844/

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch, 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11666-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 23:30:21 2014
Return-Path: <bookkeeper-dev-return-11666-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0E3EA10E0D
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 23:30:21 +0000 (UTC)
Received: (qmail 17534 invoked by uid 500); 22 Nov 2014 23:30:15 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 17503 invoked by uid 500); 22 Nov 2014 23:30:15 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 17487 invoked by uid 99); 22 Nov 2014 23:30:15 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 23:30:15 +0000
Date: Sat, 22 Nov 2014 23:30:15 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.1242.1416699015706@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222250#comment-14222250 ] 

Hadoop QA commented on BOOKKEEPER-799:
--------------------------------------

Testing JIRA BOOKKEEPER-799


Patch [0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch|https://issues.apache.org/jira/secure/attachment/12682858/0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch] downloaded at Sat Nov 22 22:54:32 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 931
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/845/

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11667-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sat Nov 22 23:34:14 2014
Return-Path: <bookkeeper-dev-return-11667-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1243310E27
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sat, 22 Nov 2014 23:34:13 +0000 (UTC)
Received: (qmail 22686 invoked by uid 500); 22 Nov 2014 23:34:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 22657 invoked by uid 500); 22 Nov 2014 23:34:13 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 22412 invoked by uid 99); 22 Nov 2014 23:34:13 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 22 Nov 2014 23:34:13 +0000
Date: Sat, 22 Nov 2014 23:34:13 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756421.1416409636000.1264.1416699253687@Atlassian.JIRA>
In-Reply-To: <JIRA.12756421.1416409636000@Atlassian.JIRA>
References: <JIRA.12756421.1416409636000@Atlassian.JIRA> <JIRA.12756421.1416409636416@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-798) Make website look more modern
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-798?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222255#comment-14222255 ] 

Hadoop QA commented on BOOKKEEPER-798:
--------------------------------------

Testing JIRA BOOKKEEPER-798


Patch [0001-Adding-bootstrap-resources-for-site-reboot.patch|https://issues.apache.org/jira/secure/attachment/12682425/0001-Adding-bootstrap-resources-for-site-reboot.patch] downloaded at Sat Nov 22 23:30:26 UTC 2014

----------------------------

{color:red}-1{color} Patch failed to apply to head of branch

----------------------------

> Make website look more modern
> -----------------------------
>
>                 Key: BOOKKEEPER-798
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-798
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>         Attachments: 0001-Adding-bootstrap-resources-for-site-reboot.patch, 0001-Make-site-use-bootstrap.patch
>
>
> The current website looks super old. This jira is to remedy the style. Changes to content will come later.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11668-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov 23 00:10:13 2014
Return-Path: <bookkeeper-dev-return-11668-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 609B010ED5
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun, 23 Nov 2014 00:10:13 +0000 (UTC)
Received: (qmail 56655 invoked by uid 500); 23 Nov 2014 00:10:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 56618 invoked by uid 500); 23 Nov 2014 00:10:13 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 56607 invoked by uid 99); 23 Nov 2014 00:10:13 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 00:10:13 +0000
Date: Sun, 23 Nov 2014 00:10:13 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12750774.1414419503000.1289.1416701413189@Atlassian.JIRA>
In-Reply-To: <JIRA.12750774.1414419503000@Atlassian.JIRA>
References: <JIRA.12750774.1414419503000@Atlassian.JIRA> <JIRA.12750774.1414419503985@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-795) Race condition causes writes to
 hang if ledger is fences
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-795?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222261#comment-14222261 ] 

Hadoop QA commented on BOOKKEEPER-795:
--------------------------------------

Testing JIRA BOOKKEEPER-795


Patch [0001-Made-ledger-metadata-immutable.patch|https://issues.apache.org/jira/secure/attachment/12681335/0001-Made-ledger-metadata-immutable.patch] downloaded at Sat Nov 22 23:34:14 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 20 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 931
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/847/

> Race condition causes writes to hang if ledger is fences
> --------------------------------------------------------
>
>                 Key: BOOKKEEPER-795
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-795
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0
>
>         Attachments: 0001-Demonstrate-race-condition.patch, 0001-Made-ledger-metadata-immutable.patch, 0001-Made-ledger-metadata-immutable.patch, TEST-org.apache.bookkeeper.client.LedgerCloseTest.xml
>
>
> If a ledger is fenced while the write is still writing to it, some of the writes will fail to ever complete.
> I've attached the log of this happening along with a test case that will trigger the behaviour.
> What appears to be happening is that when the fence occurs, the first write after the fence gets an unrecoverable error, so tries to close the ledger. Closing the ledger sets the closed flag on the ledger metadata, and tries to write it, which fails as the metadata in zookeeper was modified by the fencing operation, so the close op fails, resets the closed status for a moment, a write operation gets through, which then fails with a fencing error, so we try to close the ledger, but the other close operation has since closed the ledger in our metadata, so nothing happens, and the write hangs forever.
> There's a number of issues here, but foremost, the ledger metadata that the handle is using should only ever represent what is actually in zookeeper. Having various parts of the code flipping bits just explodes the state space. The LedgerMetadata object itself should be immutable, and should only be modified, as a local variable, using a builder, before writing to zookeeper. Only when the zookeeper operation succeeds should we update the reference which LedgerHandle has access to.
> There's also a problem in how we handle pendingaddops when we close. Really it shouldn't be possible for a write op to get through after a closure, but we should be defensive here and error out anything that has gotten through, adding a big old log message to alert us that this cases that shouldn't happen, is happening.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11669-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov 23 01:09:12 2014
Return-Path: <bookkeeper-dev-return-11669-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D412B111D4
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun, 23 Nov 2014 01:09:12 +0000 (UTC)
Received: (qmail 94799 invoked by uid 500); 23 Nov 2014 01:09:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 94754 invoked by uid 500); 23 Nov 2014 01:09:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 94743 invoked by uid 99); 23 Nov 2014 01:09:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 01:09:12 +0000
Date: Sun, 23 Nov 2014 01:09:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12754180.1415636603000.1312.1416704952636@Atlassian.JIRA>
In-Reply-To: <JIRA.12754180.1415636603000@Atlassian.JIRA>
References: <JIRA.12754180.1415636603000@Atlassian.JIRA> <JIRA.12754180.1415636603622@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-796) Make bookkeeper client use
 reconnectable zookeeper wrapper
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-796?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222267#comment-14222267 ] 

Hadoop QA commented on BOOKKEEPER-796:
--------------------------------------

Testing JIRA BOOKKEEPER-796


Patch [0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch|https://issues.apache.org/jira/secure/attachment/12680596/0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch] downloaded at Sun Nov 23 00:10:16 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 2 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 4
.    Tests errors: 9

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)
.      testReadTimeout(org.apache.bookkeeper.client.TestReadTimeout)
.      testCloseDuringOp[0](org.apache.bookkeeper.client.BookKeeperTest)
.      testCloseDuringOp[1](org.apache.bookkeeper.client.BookKeeperTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/848/

> Make bookkeeper client use reconnectable zookeeper wrapper
> ----------------------------------------------------------
>
>                 Key: BOOKKEEPER-796
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-796
>             Project: Bookkeeper
>          Issue Type: Sub-task
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-BOOKKEEPER-796-Make-bookkeeper-client-use-reconnecta.patch
>
>
> BOOKKEEPER-704 introduced a reconnectable zookeeper wrapper. This patch is to make the bookkeeper client use it.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11670-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov 23 10:26:51 2014
Return-Path: <bookkeeper-dev-return-11670-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F136817751
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun, 23 Nov 2014 10:26:50 +0000 (UTC)
Received: (qmail 18520 invoked by uid 500); 23 Nov 2014 10:26:50 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 18484 invoked by uid 500); 23 Nov 2014 10:26:50 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 18471 invoked by uid 99); 23 Nov 2014 10:26:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 10:26:50 +0000
X-ASF-Spam-Status: No, hits=1.0 required=5.0
	tests=FORGED_YAHOO_RCVD,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fpjunqueira@yahoo.com designates 216.109.114.67 as permitted sender)
Received: from [216.109.114.67] (HELO nm50.bullet.mail.bf1.yahoo.com) (216.109.114.67)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 10:26:43 +0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s2048; d=yahoo.com;
	b=ToS0Mr92ffr20ZmHPsag0GExpLNJQuMca62d9deGfR06TdrrKxaaACCfICJtCM4ln+n08SKFhwzhNQ2Xv0/l2NCit5VMm1QskzCo5BNRWgYMaV1hywaHSgDIhdX3vFYooiCmWT4aeIOeWVaWjHhZMaP2fpwY88XUQpsc6/dMpHGLNUO0xtmWcwVtPtE0BWkFn7GemwOWV9MLt99rz3qrDrTwBWHzKXidHJ7s3Yu6IRCuXWdz8ZAcmEvZ7HJKWiLCBkypl41bKTvmOhnBCq3hlBdn3hAxML5t2ZfE8Q8tEZYLR1VXCbva9R/w/ThcySpwL42ZyAKiHoTMElvxnGIWrA==;
Received: from [66.196.81.171] by nm50.bullet.mail.bf1.yahoo.com with NNFMP; 23 Nov 2014 10:26:21 -0000
Received: from [68.142.230.70] by tm17.bullet.mail.bf1.yahoo.com with NNFMP; 23 Nov 2014 10:26:21 -0000
Received: from [127.0.0.1] by smtp227.mail.bf1.yahoo.com with NNFMP; 23 Nov 2014 10:26:21 -0000
X-Yahoo-Newman-Id: 667742.54916.bm@smtp227.mail.bf1.yahoo.com
X-Yahoo-Newman-Property: ymail-3
X-YMail-OSG: 1Bs3Uf0VM1ktmDahXUL1VHgvcrlg0zBOxHKpTZiN84dXUKI
 QiFokwtzAzWXClV6QkWfF_3plqC6q1TnU5v69DiQz3.lTKmEf9fRzBRcyFo2
 nRdFjJUOAWDJfoeiOA0TxPZaRHyVPR7YLIet19BycwxGidXPocW7ne14Cx4r
 Mh7rnj2kXLdPV0PV6zuxMCUQIjyX21lNRlIERlV4d7_SKE2wF_pIG_NNtwkQ
 rj2IkYbzWLOJedsAOh3BUkHCHBvYrim2olzKcE77jU4sW9IMCNaOc.G_M.km
 yMhDfa.bL8VJd83kG2CSMUdhOPfqLLz6Wz00p8bBeFk5CnwEnOsYM1ZfroOX
 x0pd42XqZ6HB30gC_tr7edwYpK1vfJaEw0MfEflCS8SAybSrPbo7LZVZgBv3
 vv96VrhfaatyOzzfKrP7tAyNhvlD4yNpkcT9FAz6XTUsOZ8_tFl_RKx1nSjP
 NYH9XEqZnXBASYyjiA9Lx9PzbmA1cBX87RtMQEgE5V19rEvKRrvz3khoo_Rx
 .Ok5Q1uLlEJzcXjNOJP8ZycjvzeU-
X-Yahoo-SMTP: HT5UJDeswBACWJPOeualxAa.da..S.fl
From: Flavio Junqueira <fpjunqueira@yahoo.com.INVALID>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: Apache BookKeeper TLP!
Message-Id: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
Date: Sun, 23 Nov 2014 10:26:17 +0000
To: bookkeeper-dev <bookkeeper-dev@zookeeper.apache.org>,
 bookkeeper-user@zookeeper.apache.org,
 user@zookeeper.apache.org,
 DevZooKeeper <dev@zookeeper.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 8.1 \(1993\))
X-Mailer: Apple Mail (2.1993)
X-Virus-Checked: Checked by ClamAV on apache.org

I just wanted to share that the board approved our proposal to make =
Apache BookKeeper a top-level project. I'm thrilled with the news and I =
want to thank everyone for the support, especially the ZooKeeper =
community for hosting the project. The BookKeeper community will start =
working on the transition right away.

-Flavio=

From bookkeeper-dev-return-11671-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov 23 12:47:05 2014
Return-Path: <bookkeeper-dev-return-11671-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0CEF2178D9
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun, 23 Nov 2014 12:47:05 +0000 (UTC)
Received: (qmail 21259 invoked by uid 500); 23 Nov 2014 12:47:05 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 21218 invoked by uid 500); 23 Nov 2014 12:47:04 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 21207 invoked by uid 99); 23 Nov 2014 12:47:04 -0000
Received: from crius.apache.org (HELO crius) (140.211.11.14)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 12:47:04 +0000
Received: from crius.apache.org (localhost [127.0.0.1])
	by crius (Postfix) with ESMTP id 707E7E000D0
	for <bookkeeper-dev@zookeeper.apache.org>; Sun, 23 Nov 2014 12:47:04 +0000 (UTC)
Date: Sun, 23 Nov 2014 12:47:04 +0000 (UTC)
From: Apache Jenkins Server  <jenkins@builds.apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <1174325521.9221.1416746824458.JavaMail.jenkins@crius>
In-Reply-To: <1735336221.9015.1416660326060.JavaMail.jenkins@crius>
References: <1735336221.9015.1416660326060.JavaMail.jenkins@crius>
Subject: Jenkins build is back to normal : bookkeeper-trunk #859
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: bookkeeper-trunk
X-Jenkins-Result: SUCCESS

See <https://builds.apache.org/job/bookkeeper-trunk/859/>


From bookkeeper-dev-return-11672-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov 23 13:44:29 2014
Return-Path: <bookkeeper-dev-return-11672-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B818417950
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun, 23 Nov 2014 13:44:29 +0000 (UTC)
Received: (qmail 56157 invoked by uid 500); 23 Nov 2014 13:44:28 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 56051 invoked by uid 500); 23 Nov 2014 13:44:28 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 55732 invoked by uid 99); 23 Nov 2014 13:44:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 13:44:28 +0000
X-ASF-Spam-Status: No, hits=0.7 required=5.0
	tests=RCVD_IN_DNSWL_NONE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 98.139.253.104 is neither permitted nor denied by domain of jiannan@yahoo-inc.com)
Received: from [98.139.253.104] (HELO mrout1-b.corp.bf1.yahoo.com) (98.139.253.104)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 13:44:24 +0000
Received: from GQ1-EX10-CAHT02.y.corp.yahoo.com (gq1-ex10-caht02.corp.gq1.yahoo.com [10.73.118.81])
	by mrout1-b.corp.bf1.yahoo.com (8.14.4/8.14.4/y.out) with ESMTP id sANDfMZn064604
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL);
	Sun, 23 Nov 2014 05:41:23 -0800 (PST)
Received: from GQ1-EX10-DRMB06.y.corp.yahoo.com ([fe80::5149:1cf:ea47:f574])
 by GQ1-EX10-CAHT02.y.corp.yahoo.com ([::1]) with mapi id 14.03.0195.001; Sun,
 23 Nov 2014 05:41:21 -0800
From: Jiannan Wang <jiannan@yahoo-inc.com.INVALID>
To: "bookkeeper-dev@zookeeper.apache.org"
	<bookkeeper-dev@zookeeper.apache.org>,
        "bookkeeper-user@zookeeper.apache.org"
	<bookkeeper-user@zookeeper.apache.org>,
        "user@zookeeper.apache.org"
	<user@zookeeper.apache.org>,
        DevZooKeeper <dev@zookeeper.apache.org>
Subject: Re: Apache BookKeeper TLP!
Thread-Topic: Apache BookKeeper TLP!
Thread-Index: AQHQBwgH/CSN31Rq30WhbR4KTV6645xvRHwA
Date: Sun, 23 Nov 2014 13:41:21 +0000
Message-ID: <D0980389.15C9E%jiannan@yahoo-inc.com>
References: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
In-Reply-To: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
user-agent: Microsoft-MacOutlook/14.4.6.141106
x-originating-ip: [10.82.145.185]
Content-Type: text/plain; charset="us-ascii"
Content-ID: <C120B94686D79A40B6E5F0993B09211C@yforest.corp.yahoo.com>
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Milter-Version: master.31+4-gbc07cd5+
X-CLX-ID: 750083001
X-Virus-Checked: Checked by ClamAV on apache.org

Awesome, wonderful news! Hope the BookKeeper project could have deeper
impact to the industry and go further.

Regards,
Jiannan

On 11/23/14, 6:26 PM, "Flavio Junqueira" <fpjunqueira@yahoo.com.INVALID>
wrote:

>I just wanted to share that the board approved our proposal to make
>Apache BookKeeper a top-level project. I'm thrilled with the news and I
>want to thank everyone for the support, especially the ZooKeeper
>community for hosting the project. The BookKeeper community will start
>working on the transition right away.
>
>-Flavio


From bookkeeper-dev-return-11673-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Sun Nov 23 20:45:28 2014
Return-Path: <bookkeeper-dev-return-11673-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4FEEFC1B2
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Sun, 23 Nov 2014 20:45:28 +0000 (UTC)
Received: (qmail 96419 invoked by uid 500); 23 Nov 2014 20:45:27 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 96264 invoked by uid 500); 23 Nov 2014 20:45:27 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 95974 invoked by uid 99); 23 Nov 2014 20:45:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 20:45:26 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rakeshr.apache@gmail.com designates 209.85.218.52 as permitted sender)
Received: from [209.85.218.52] (HELO mail-oi0-f52.google.com) (209.85.218.52)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 23 Nov 2014 20:45:22 +0000
Received: by mail-oi0-f52.google.com with SMTP id h136so5789295oig.39
        for <multiple recipients>; Sun, 23 Nov 2014 12:45:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        bh=xtSA3H5ZcCu6y/GFIF5tttivCaT6+7/MMax0oglg/tA=;
        b=PyEUt89pDzWe3iysG3jslvXbeUQchn/kiXxY9z0sZdgyNRo0c/RNvTvbYZuEjBAzyT
         opex/hfA7nIPO50IcuU3f4xIIlbyNVBl1qDoeUPLj0dwfHh4bYa7iWzYHHx94u+tkhKG
         xMyYKYrhmGmLJxdQHwTVWlCvpFuTKDLf8PR8AiTBpPRHUHG9MKxzSSCJFz4udigMNOpV
         GBfvGWjOm9xxk2wmiJwXk55wKgD4j8/O495HI+cKWO2Z/g7FweKv6B8JPehWmTTnsW9Y
         ZuQlhncJi+N69OB/nfarNER8o0jHL3H44IRO83FtKpt74GqhGH+NMj9nCwVCtrJExbZP
         GHug==
MIME-Version: 1.0
X-Received: by 10.182.130.162 with SMTP id of2mr9235746obb.52.1416775502060;
 Sun, 23 Nov 2014 12:45:02 -0800 (PST)
Received: by 10.76.21.16 with HTTP; Sun, 23 Nov 2014 12:45:02 -0800 (PST)
In-Reply-To: <D0980389.15C9E%jiannan@yahoo-inc.com>
References: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
	<D0980389.15C9E%jiannan@yahoo-inc.com>
Date: Mon, 24 Nov 2014 02:15:02 +0530
Message-ID: <CAHB_t6qe2xy3cMfuFPcL=s3bpgG4jTNQqCDEvBpxR+YB3mEKAA@mail.gmail.com>
Subject: Re: Apache BookKeeper TLP!
From: Rakesh Radhakrishnan <rakeshr.apache@gmail.com>
To: "bookkeeper-user@zookeeper.apache.org" <bookkeeper-user@zookeeper.apache.org>
Cc: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>, 
	"user@zookeeper.apache.org" <user@zookeeper.apache.org>, DevZooKeeper <dev@zookeeper.apache.org>, 
	rakeshr <rakeshr@huawei.com>
Content-Type: multipart/alternative; boundary=089e013cbb2c86e05205088cc02e
X-Virus-Checked: Checked by ClamAV on apache.org

--089e013cbb2c86e05205088cc02e
Content-Type: text/plain; charset=UTF-8

Great News! Congrats all the contributors and users for the continuous
effort.


Best Regards,
Rakesh

On Sun, Nov 23, 2014 at 7:11 PM, Jiannan Wang <jiannan@yahoo-inc.com> wrote:

> Awesome, wonderful news! Hope the BookKeeper project could have deeper
> impact to the industry and go further.
>
> Regards,
> Jiannan
>
> On 11/23/14, 6:26 PM, "Flavio Junqueira" <fpjunqueira@yahoo.com.INVALID>
> wrote:
>
> >I just wanted to share that the board approved our proposal to make
> >Apache BookKeeper a top-level project. I'm thrilled with the news and I
> >want to thank everyone for the support, especially the ZooKeeper
> >community for hosting the project. The BookKeeper community will start
> >working on the transition right away.
> >
> >-Flavio
>
>

--089e013cbb2c86e05205088cc02e--

From bookkeeper-dev-return-11674-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 02:43:27 2014
Return-Path: <bookkeeper-dev-return-11674-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 29412C96E
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 02:43:27 +0000 (UTC)
Received: (qmail 26129 invoked by uid 500); 24 Nov 2014 02:43:26 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 26062 invoked by uid 500); 24 Nov 2014 02:43:26 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 26022 invoked by uid 99); 24 Nov 2014 02:43:26 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 02:43:26 +0000
Received: from mail-lb0-f176.google.com (mail-lb0-f176.google.com [209.85.217.176])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 8F2511A048C;
	Mon, 24 Nov 2014 02:43:18 +0000 (UTC)
Received: by mail-lb0-f176.google.com with SMTP id p9so5548782lbv.21
        for <multiple recipients>; Sun, 23 Nov 2014 18:43:23 -0800 (PST)
X-Received: by 10.112.170.7 with SMTP id ai7mr18237115lbc.67.1416797003701;
 Sun, 23 Nov 2014 18:43:23 -0800 (PST)
MIME-Version: 1.0
Received: by 10.25.157.144 with HTTP; Sun, 23 Nov 2014 18:42:43 -0800 (PST)
In-Reply-To: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
References: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
From: Patrick Hunt <phunt@apache.org>
Date: Sun, 23 Nov 2014 18:42:43 -0800
Message-ID: <CANLc_9J2rbq1NkEZPSiZdGRGk5oNfSeE1dZTRiDHv71uW1S55w@mail.gmail.com>
Subject: Re: Apache BookKeeper TLP!
To: DevZooKeeper <dev@zookeeper.apache.org>
Cc: bookkeeper-dev <bookkeeper-dev@zookeeper.apache.org>, 
	"bookkeeper-user@zookeeper.apache.org" <bookkeeper-user@zookeeper.apache.org>, 
	UserZooKeeper <user@zookeeper.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Great news, kudos to the Bookkeeper community!

Regards,

Patrick

On Sun, Nov 23, 2014 at 2:26 AM, Flavio Junqueira
<fpjunqueira@yahoo.com.invalid> wrote:
> I just wanted to share that the board approved our proposal to make Apach=
e BookKeeper a top-level project. I'm thrilled with the news and I want to =
thank everyone for the support, especially the ZooKeeper community for host=
ing the project. The BookKeeper community will start working on the transit=
ion right away.
>
> -Flavio

From bookkeeper-dev-return-11675-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 03:24:27 2014
Return-Path: <bookkeeper-dev-return-11675-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AE288CA73
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 03:24:27 +0000 (UTC)
Received: (qmail 69181 invoked by uid 500); 24 Nov 2014 03:24:26 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 68889 invoked by uid 500); 24 Nov 2014 03:24:26 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 68721 invoked by uid 99); 24 Nov 2014 03:24:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 03:24:26 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of g.kishore@gmail.com designates 74.125.82.45 as permitted sender)
Received: from [74.125.82.45] (HELO mail-wg0-f45.google.com) (74.125.82.45)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 03:24:20 +0000
Received: by mail-wg0-f45.google.com with SMTP id b13so11073359wgh.32
        for <multiple recipients>; Sun, 23 Nov 2014 19:22:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        bh=X0ZS6/5VDvpDGOlRtzNlLKnzh52RUNv+NJ0YhUOwSJ4=;
        b=TXlYUvovBfqe2IABft5DQPvWeJhHkfKt6bmG3fIRHtKw8ZS9Ks8mfeeZ00XVSxdNmX
         IoWwzKFRY6qaKkEriKl5AcBsK97QIGr8Pvx2IbNgo+JzKC0zOwNbpGE3Am9KxjKSlEzz
         pTTmFNem92QOvjPhW+csnb9AYRuekHN+yDIFgoF22x//QduQCyVbE8PGMhmo4ntfQvPe
         6jnDMklEowtw3WE0MiIDBi5VGdvIW4Pm1mzlf8R+Zns0NuiiX2/mSgAUUniYixrIKWgE
         e6RftRp/wOu6p1zvO0LHBCbUvuPbA6WlgTlTMLJnBhLchd/sT0kHuTtvAnY1qMcH9OSI
         0xvg==
MIME-Version: 1.0
X-Received: by 10.180.75.237 with SMTP id f13mr17269131wiw.69.1416799349802;
 Sun, 23 Nov 2014 19:22:29 -0800 (PST)
Received: by 10.194.57.130 with HTTP; Sun, 23 Nov 2014 19:22:29 -0800 (PST)
In-Reply-To: <CANLc_9J2rbq1NkEZPSiZdGRGk5oNfSeE1dZTRiDHv71uW1S55w@mail.gmail.com>
References: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
	<CANLc_9J2rbq1NkEZPSiZdGRGk5oNfSeE1dZTRiDHv71uW1S55w@mail.gmail.com>
Date: Sun, 23 Nov 2014 19:22:29 -0800
Message-ID: <CABaj-QaJC1ckJUn0vidac933xxO3ku2b9HzB=9sw2aF1RSynBw@mail.gmail.com>
Subject: Re: Apache BookKeeper TLP!
From: kishore g <g.kishore@gmail.com>
To: "dev@zookeeper.apache.org" <dev@zookeeper.apache.org>
Cc: bookkeeper-dev <bookkeeper-dev@zookeeper.apache.org>, 
	"bookkeeper-user@zookeeper.apache.org" <bookkeeper-user@zookeeper.apache.org>, 
	UserZooKeeper <user@zookeeper.apache.org>
Content-Type: multipart/alternative; boundary=f46d043894e5f68be80508924d44
X-Virus-Checked: Checked by ClamAV on apache.org

--f46d043894e5f68be80508924d44
Content-Type: text/plain; charset=UTF-8

Congrats!.

On Sun, Nov 23, 2014 at 6:42 PM, Patrick Hunt <phunt@apache.org> wrote:

> Great news, kudos to the Bookkeeper community!
>
> Regards,
>
> Patrick
>
> On Sun, Nov 23, 2014 at 2:26 AM, Flavio Junqueira
> <fpjunqueira@yahoo.com.invalid> wrote:
> > I just wanted to share that the board approved our proposal to make
> Apache BookKeeper a top-level project. I'm thrilled with the news and I
> want to thank everyone for the support, especially the ZooKeeper community
> for hosting the project. The BookKeeper community will start working on the
> transition right away.
> >
> > -Flavio
>

--f46d043894e5f68be80508924d44--

From bookkeeper-dev-return-11676-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 12:03:45 2014
Return-Path: <bookkeeper-dev-return-11676-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C58FD1072A
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 12:03:45 +0000 (UTC)
Received: (qmail 67469 invoked by uid 500); 24 Nov 2014 12:03:45 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 67434 invoked by uid 500); 24 Nov 2014 12:03:45 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 67423 invoked by uid 99); 24 Nov 2014 12:03:45 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 12:03:45 +0000
Received: from mail-lb0-f181.google.com (mail-lb0-f181.google.com [209.85.217.181])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id D6C6E1A04A2
	for <bookkeeper-dev@zookeeper.apache.org>; Mon, 24 Nov 2014 12:03:36 +0000 (UTC)
Received: by mail-lb0-f181.google.com with SMTP id 10so2456833lbg.26
        for <bookkeeper-dev@zookeeper.apache.org>; Mon, 24 Nov 2014 04:03:43 -0800 (PST)
X-Gm-Message-State: ALoCoQn1Vr/ikDJin0EzdnxRrUNj67Z5ey1sFfQmsvT/onAdrqQFT/Dw7pqvuI1g1OENwDrHKpVV
MIME-Version: 1.0
X-Received: by 10.112.132.67 with SMTP id os3mr18817560lbb.90.1416830623513;
 Mon, 24 Nov 2014 04:03:43 -0800 (PST)
Received: by 10.112.31.47 with HTTP; Mon, 24 Nov 2014 04:03:43 -0800 (PST)
X-Originating-IP: [213.27.241.137]
Date: Mon, 24 Nov 2014 13:03:43 +0100
Message-ID: <CAD=ttqSWt1Gd32VWOjx4S6RyuS07+Oad=qLF0s_7f3QRW2rekA@mail.gmail.com>
Subject: IMPORTANT: Do not commit anything
From: Ivan Kelly <ivank@apache.org>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Content-Type: text/plain; charset=UTF-8

Hi folks,

As you'll have seen, we're going TLP. This means our source needs to
be moved out from under Zookeeper. Therefore, don't commit anything
until after this has happened.

The umbrella jira for the move is
https://issues.apache.org/jira/browse/INFRA-8697

Cheers,
Ivan

From bookkeeper-dev-return-11677-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 12:18:12 2014
Return-Path: <bookkeeper-dev-return-11677-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9B28B107AE
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 12:18:12 +0000 (UTC)
Received: (qmail 5761 invoked by uid 500); 24 Nov 2014 12:18:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 5733 invoked by uid 500); 24 Nov 2014 12:18:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 5722 invoked by uid 99); 24 Nov 2014 12:18:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 12:18:12 +0000
Date: Mon, 24 Nov 2014 12:18:12 +0000 (UTC)
From: "Youngjoon Kim (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.5803.1416831492302@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Created] (BOOKKEEPER-804) Client program is not terminated
 when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Youngjoon Kim created BOOKKEEPER-804:
----------------------------------------

             Summary: Client program is not terminated when using openLedgerNoRecovery
                 Key: BOOKKEEPER-804
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
             Project: Bookkeeper
          Issue Type: Bug
          Components: bookkeeper-client
    Affects Versions: 4.3.0
            Reporter: Youngjoon Kim


If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.

Here is a sample code. 
{code}
import java.util.Enumeration;

import org.apache.bookkeeper.client.BookKeeper;
import org.apache.bookkeeper.client.LedgerEntry;
import org.apache.bookkeeper.client.LedgerHandle;

public class BkClient {
  public static void main(String[] args) {
    try {
      BookKeeper bk = new BookKeeper("localhost:2181");

      // 9 is a ledger id of an existing ledger
      LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());

      Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);

      lh.close();
      bk.close();
    } catch (Exception e) {
      e.printStackTrace();
    }
  }
}
{code}

Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 




--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11678-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 12:21:37 2014
Return-Path: <bookkeeper-dev-return-11678-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 20A88107BD
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 12:21:37 +0000 (UTC)
Received: (qmail 9563 invoked by uid 500); 24 Nov 2014 12:21:37 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 9528 invoked by uid 500); 24 Nov 2014 12:21:37 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 9516 invoked by uid 99); 24 Nov 2014 12:21:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 12:21:36 +0000
X-ASF-Spam-Status: No, hits=3.2 required=5.0
	tests=FORGED_YAHOO_RCVD,HTML_MESSAGE,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of fpjunqueira@yahoo.com designates 98.139.213.126 as permitted sender)
Received: from [98.139.213.126] (HELO nm30-vm0.bullet.mail.bf1.yahoo.com) (98.139.213.126)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 12:21:29 +0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s2048; d=yahoo.com;
	b=UgMwUk3lbIRAmO4khgQR6clasGAbR5/HS1KSRfvkfeUH8s0GkHVx/+Tm/hRADXncytydmgA2VSsCB3fHLEYXbebQyhRmDVlDH8AR6YnGd3OwuXTIvYUqQn8nvSWjWaPg17WattiGZMvNAs2jKGkUD+1+/5K2KGz4rISheVK7uBpIlpTXHDaKtE69N+1Uzc13132kwLQUdnJcPuKSd71VPeu93aYv/JOQu1ncfSTPMPJnembv6BRaI96Dq5rSsivJqSMKTq4b4arGpEJE/ufiVYaK5cWLHxbvn4fdrfuZoxig2gxW+pAyv32hEOraGgWwSWFj9T1D+FgMzJ0DzdJ5HQ==;
Received: from [98.139.215.142] by nm30.bullet.mail.bf1.yahoo.com with NNFMP; 24 Nov 2014 12:19:02 -0000
Received: from [98.139.212.226] by tm13.bullet.mail.bf1.yahoo.com with NNFMP; 24 Nov 2014 12:19:02 -0000
Received: from [127.0.0.1] by omp1035.mail.bf1.yahoo.com with NNFMP; 24 Nov 2014 12:19:02 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 506168.53642.bm@omp1035.mail.bf1.yahoo.com
X-YMail-OSG: p4xNqgIVM1le9rDXdG_J7LZSsf4uFsbht3p9uzyGmwNswT..dfb8Jc3OZFV0tEx
 ZZuJHj1_zsAjxcsAJ9psJXzQyOhAbz90meTUSpBN7wrCPmedf.hd05ufYQtoBFMbKzAArHaUdNxz
 p4.PNmFlhL.wofqVeH2yW7zZuCDkpTxStzunnbGwyiGTqo._N7EzKD3qoO_26wVXY2PYaHz9oNQF
 AiD0DufNysImLFUMVLKGY6KgMQ67xvNQC8bs6_ks350sBZghbdhuuDIZ92JSpBQODjYbAUW7lnJs
 Z2jkC178eqZ7JtQx7ukysdPIhNhDPQzpyLkzOOGvsjuPmN7HzDEjqsT9SSzoYpir6XDjEFZEhjml
 0gGbaVn7OYFiBBKVsQJO52WW9YICXArLtKmOLFneYhbkiBgFK_K.96Z8OXXJltdPeclVL1DJpycm
 TFP_APSYd3pAFZf4Pkyh3BoDHkBQJ1GcGO2t4J5dT2DXlpMQpucRIoWwqPAqEEAdy2sne6IE-
Received: by 66.196.80.123; Mon, 24 Nov 2014 12:19:02 +0000 
Date: Mon, 24 Nov 2014 12:19:01 +0000 (UTC)
From: Flavio Junqueira <fpjunqueira@yahoo.com.INVALID>
Reply-To: Flavio Junqueira <fpjunqueira@yahoo.com>
To: 
	"bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Message-ID: <1843663868.172404.1416831541612.JavaMail.yahoo@jws106126.mail.bf1.yahoo.com>
In-Reply-To: <CAD=ttqSWt1Gd32VWOjx4S6RyuS07+Oad=qLF0s_7f3QRW2rekA@mail.gmail.com>
References: <CAD=ttqSWt1Gd32VWOjx4S6RyuS07+Oad=qLF0s_7f3QRW2rekA@mail.gmail.com>
Subject: Re: IMPORTANT: Do not commit anything
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_172403_23304892.1416831541609"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_172403_23304892.1416831541609
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

It might not be necessary, but consider locking the repo.
-Flavio
------=_Part_172403_23304892.1416831541609--

From bookkeeper-dev-return-11679-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 12:43:31 2014
Return-Path: <bookkeeper-dev-return-11679-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7C4FA10852
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 12:43:31 +0000 (UTC)
Received: (qmail 46772 invoked by uid 500); 24 Nov 2014 12:43:31 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 46738 invoked by uid 500); 24 Nov 2014 12:43:31 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 46724 invoked by uid 99); 24 Nov 2014 12:43:31 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 12:43:31 +0000
Received: from mail-la0-f48.google.com (mail-la0-f48.google.com [209.85.215.48])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 795281A037A
	for <bookkeeper-dev@zookeeper.apache.org>; Mon, 24 Nov 2014 12:43:22 +0000 (UTC)
Received: by mail-la0-f48.google.com with SMTP id s18so7640599lam.35
        for <bookkeeper-dev@zookeeper.apache.org>; Mon, 24 Nov 2014 04:43:28 -0800 (PST)
X-Gm-Message-State: ALoCoQmhIGpEyVNVz379uslQKO7XzpZpkuvTF2ywUZcjL7GGLCMujly0fi/veyoBKo+UEuD1ySOO
MIME-Version: 1.0
X-Received: by 10.112.148.130 with SMTP id ts2mr20420755lbb.43.1416833008246;
 Mon, 24 Nov 2014 04:43:28 -0800 (PST)
Received: by 10.112.31.47 with HTTP; Mon, 24 Nov 2014 04:43:28 -0800 (PST)
X-Originating-IP: [213.27.241.137]
In-Reply-To: <1843663868.172404.1416831541612.JavaMail.yahoo@jws106126.mail.bf1.yahoo.com>
References: <CAD=ttqSWt1Gd32VWOjx4S6RyuS07+Oad=qLF0s_7f3QRW2rekA@mail.gmail.com>
	<1843663868.172404.1416831541612.JavaMail.yahoo@jws106126.mail.bf1.yahoo.com>
Date: Mon, 24 Nov 2014 13:43:28 +0100
Message-ID: <CAD=ttqTD2Min3A1Y0QOSUGw7xQqyjFCh=kFJQrA6TChK72UYqA@mail.gmail.com>
Subject: Re: IMPORTANT: Do not commit anything
From: Ivan Kelly <ivank@apache.org>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>, 
	Flavio Junqueira <fpjunqueira@yahoo.com>
Content-Type: text/plain; charset=UTF-8

Locking is blocked by apache pre-lock hooks.

$ svn lock https://svn.apache.org/repos/asf/zookeeper/bookkeeper/
svn: E165001: Lock blocked by pre-lock hook (exit code 1) with output:
Error: /zookeeper/bookkeeper must have an appropriate MIME type to be locked.



On 24 November 2014 at 13:19, Flavio Junqueira
<fpjunqueira@yahoo.com.invalid> wrote:
> It might not be necessary, but consider locking the repo.
> -Flavio

From bookkeeper-dev-return-11680-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 12:48:41 2014
Return-Path: <bookkeeper-dev-return-11680-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E6D4710887
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 12:48:40 +0000 (UTC)
Received: (qmail 64708 invoked by uid 500); 24 Nov 2014 12:48:40 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 64672 invoked by uid 500); 24 Nov 2014 12:48:40 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 64660 invoked by uid 99); 24 Nov 2014 12:48:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 12:48:40 +0000
X-ASF-Spam-Status: No, hits=3.2 required=5.0
	tests=FORGED_YAHOO_RCVD,HTML_MESSAGE,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fpjunqueira@yahoo.com designates 98.139.212.189 as permitted sender)
Received: from [98.139.212.189] (HELO nm30.bullet.mail.bf1.yahoo.com) (98.139.212.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 12:48:11 +0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s2048; d=yahoo.com;
	b=GWb/LZ8Yw2xApYWWdt2MaoBSWaZqdT1BoPqtf0HwZhRqxDFAAwHwHBs9DIvZuxfowYN2PmH/+j/dSsNdGkjy6kA+36HWfYNrJztfFhyNoAp2MbAWUK+AKqGrLIGd6DKARPISBu/PeZqML3+qYaIzL6ZFspRwmWbXgzjgli6Vu69MziNR7v4v+DwAp479ObrMatS5+n5LVvT4YXahgyOOro1rLlGpYiqSa/IW2ObULF8b7ZxYG+slmFVDOdUIGTykDUMYDJWNZQsr8JpeFYVEtss8Ipj6ShScBqx0OADqn3KBNSySVmC4MES8NuKdZwrfk6FhOh+rgJAp4cm6NtjrHA==;
Received: from [66.196.81.174] by nm30.bullet.mail.bf1.yahoo.com with NNFMP; 24 Nov 2014 12:47:07 -0000
Received: from [98.139.212.198] by tm20.bullet.mail.bf1.yahoo.com with NNFMP; 24 Nov 2014 12:47:07 -0000
Received: from [127.0.0.1] by omp1007.mail.bf1.yahoo.com with NNFMP; 24 Nov 2014 12:47:07 -0000
X-Yahoo-Newman-Property: ymail-5
X-Yahoo-Newman-Id: 602844.39145.bm@omp1007.mail.bf1.yahoo.com
X-YMail-OSG: Yij5djEVM1lzTYkZK5i6lW1ALsgvp0bzU.zkDK82crTwT1d_0jRecT4hup8UVBI
 uUIcPr784obXWiBqne59q74asqYpDQvHLk45ovKIDX7cOv05JwxVfg4vSl_nhJcKKoPCJoszhACS
 M3YfHxU7LcR1As_BwKrP7wcpVcy8LjY7ERBRkqctzOVhuF.iKjsltMRix1.AbnSq4A3K5DPCAWG3
 tqet5Cusgpkz4Hialg25bp1tgFoNbABEXdpNhlCukITooWTI4AkdwwSjLVzOVSPsfQRmiwnKFF36
 CblLz0dwWMiJa8z4L4Yn50r5NelhC14Reb3sayHa1cLh6WUYlNnc7bDKKuj0HmCpeuT2wtK1PPjY
 F2Pzcop7ARbCBG9WKTA.L8ORfxu2B._vrf.p3mDpsXWXI4WmPJSgEuCnCWD3iKGKSGrb_bkWAyRd
 DApcad.W8ZsRI2VTylm.qn647m8sbtaS535d9s_DaVq3XKVQQL7FUvlS0YWGTjH_auDo-
Received: by 76.13.26.79; Mon, 24 Nov 2014 12:47:07 +0000 
Date: Mon, 24 Nov 2014 12:47:06 +0000 (UTC)
From: Flavio Junqueira <fpjunqueira@yahoo.com.INVALID>
Reply-To: Flavio Junqueira <fpjunqueira@yahoo.com>
To: Ivan Kelly <ivank@apache.org>, 
	"bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Message-ID: <705071261.166021.1416833226607.JavaMail.yahoo@jws10659.mail.bf1.yahoo.com>
In-Reply-To: <CAD=ttqTD2Min3A1Y0QOSUGw7xQqyjFCh=kFJQrA6TChK72UYqA@mail.gmail.com>
References: <CAD=ttqTD2Min3A1Y0QOSUGw7xQqyjFCh=kFJQrA6TChK72UYqA@mail.gmail.com>
Subject: Re: IMPORTANT: Do not commit anything
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_166020_706610775.1416833226603"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_166020_706610775.1416833226603
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

:-( ok
-Flavio 

     On Monday, November 24, 2014 12:43 PM, Ivan Kelly <ivank@apache.org> wrote:
   
 

 Locking is blocked by apache pre-lock hooks.

$ svn lock https://svn.apache.org/repos/asf/zookeeper/bookkeeper/
svn: E165001: Lock blocked by pre-lock hook (exit code 1) with output:
Error: /zookeeper/bookkeeper must have an appropriate MIME type to be locked.



On 24 November 2014 at 13:19, Flavio Junqueira
<fpjunqueira@yahoo.com.invalid> wrote:
> It might not be necessary, but consider locking the repo.
> -Flavio


 
    
------=_Part_166020_706610775.1416833226603--

From bookkeeper-dev-return-11681-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 13:06:12 2014
Return-Path: <bookkeeper-dev-return-11681-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C63BB10956
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 13:06:12 +0000 (UTC)
Received: (qmail 8571 invoked by uid 500); 24 Nov 2014 13:06:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 8534 invoked by uid 500); 24 Nov 2014 13:06:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 8521 invoked by uid 99); 24 Nov 2014 13:06:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 13:06:12 +0000
Date: Mon, 24 Nov 2014 13:06:12 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.5947.1416834372585@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Assigned] (BOOKKEEPER-804) Client program is not terminated
 when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly reassigned BOOKKEEPER-804:
-------------------------------------

    Assignee: Ivan Kelly

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11682-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 13:06:13 2014
Return-Path: <bookkeeper-dev-return-11682-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A77B410958
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 13:06:13 +0000 (UTC)
Received: (qmail 8847 invoked by uid 500); 24 Nov 2014 13:06:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 8670 invoked by uid 500); 24 Nov 2014 13:06:13 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 8658 invoked by uid 99); 24 Nov 2014 13:06:13 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 13:06:13 +0000
Date: Mon, 24 Nov 2014 13:06:13 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.5954.1416834373112@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-804) Client program is not
 terminated when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14222965#comment-14222965 ] 

Ivan Kelly commented on BOOKKEEPER-804:
---------------------------------------

Strange, it only happens if you call readEntries. If you just open the ledger there's no problem. I'll look into it.

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11683-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 14:35:13 2014
Return-Path: <bookkeeper-dev-return-11683-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7A52810C0F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 14:35:13 +0000 (UTC)
Received: (qmail 10757 invoked by uid 500); 24 Nov 2014 14:35:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 10662 invoked by uid 500); 24 Nov 2014 14:35:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 10427 invoked by uid 99); 24 Nov 2014 14:35:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 14:35:12 +0000
Date: Mon, 24 Nov 2014 14:35:12 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.6264.1416839712812@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-804) Client program is not terminated
 when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-804:
----------------------------------
    Fix Version/s: 4.3.1
                   4.4.0

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11684-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 15:59:12 2014
Return-Path: <bookkeeper-dev-return-11684-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B855610EA0
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 15:59:12 +0000 (UTC)
Received: (qmail 17160 invoked by uid 500); 24 Nov 2014 15:59:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 17115 invoked by uid 500); 24 Nov 2014 15:59:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 17103 invoked by uid 99); 24 Nov 2014 15:59:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 15:59:12 +0000
Date: Mon, 24 Nov 2014 15:59:12 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.6528.1416844752537@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-804) Client program is not
 terminated when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14223074#comment-14223074 ] 

Ivan Kelly commented on BOOKKEEPER-804:
---------------------------------------

The problem came in with BOOKKEEPER-654. We wrap the ledger managers catch the callbacks and make sure they get called when we clean up. The wrapper wasn't chaining the close call though (a simple omission issue), so AbstractZkLedgerManager#close() was never called. It only manifested when readEntries was called in this case, because if readEntries hadn't been called, the process would have exited before the thread started.

I've attached a fix. This is really hard to test for, or at least I can't find a clean way. I can't check what threads are alive before and after, since the bookies also run in the same thread, so they could also end up creating threads :/

Thanks for reporting this Youngjoon.

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11685-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 16:05:15 2014
Return-Path: <bookkeeper-dev-return-11685-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 179F810F04
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 16:05:15 +0000 (UTC)
Received: (qmail 44532 invoked by uid 500); 24 Nov 2014 16:05:15 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 44492 invoked by uid 500); 24 Nov 2014 16:05:14 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 44473 invoked by uid 99); 24 Nov 2014 16:05:14 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 16:05:14 +0000
Date: Mon, 24 Nov 2014 16:05:14 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.6632.1416845114815@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-804) Client program is not terminated
 when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-804:
----------------------------------
    Attachment: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11686-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 16:20:12 2014
Return-Path: <bookkeeper-dev-return-11686-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D0C9310FE5
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 16:20:12 +0000 (UTC)
Received: (qmail 12733 invoked by uid 500); 24 Nov 2014 16:20:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 12702 invoked by uid 500); 24 Nov 2014 16:20:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 12691 invoked by uid 99); 24 Nov 2014 16:20:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 16:20:12 +0000
Date: Mon, 24 Nov 2014 16:20:12 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.6729.1416846012565@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-804) Client program is not terminated
 when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly updated BOOKKEEPER-804:
----------------------------------
    Attachment: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch

Actually, this can be tested using a ThreadGroup. Test added to patch.

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch, 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11687-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 16:47:12 2014
Return-Path: <bookkeeper-dev-return-11687-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E913C100D7
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 16:47:12 +0000 (UTC)
Received: (qmail 93242 invoked by uid 500); 24 Nov 2014 16:47:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 93201 invoked by uid 500); 24 Nov 2014 16:47:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 93189 invoked by uid 99); 24 Nov 2014 16:47:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 16:47:12 +0000
Date: Mon, 24 Nov 2014 16:47:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.6856.1416847632712@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-804) Client program is not
 terminated when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14223123#comment-14223123 ] 

Hadoop QA commented on BOOKKEEPER-804:
--------------------------------------

Testing JIRA BOOKKEEPER-804


Patch [0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch|https://issues.apache.org/jira/secure/attachment/12683344/0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch] downloaded at Mon Nov 24 16:10:18 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/849/

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch, 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11688-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 17:23:12 2014
Return-Path: <bookkeeper-dev-return-11688-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F1C761021F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 17:23:12 +0000 (UTC)
Received: (qmail 86344 invoked by uid 500); 24 Nov 2014 17:23:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 86301 invoked by uid 500); 24 Nov 2014 17:23:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 86289 invoked by uid 99); 24 Nov 2014 17:23:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 17:23:12 +0000
Date: Mon, 24 Nov 2014 17:23:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.7133.1416849792793@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-804) Client program is not
 terminated when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14223157#comment-14223157 ] 

Hadoop QA commented on BOOKKEEPER-804:
--------------------------------------

Testing JIRA BOOKKEEPER-804


Patch [0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch|https://issues.apache.org/jira/secure/attachment/12683348/0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch] downloaded at Mon Nov 24 16:46:43 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 931
.    Tests failed: 1
.    Tests errors: 1

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/850/

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch, 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11689-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 18:07:12 2014
Return-Path: <bookkeeper-dev-return-11689-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E09A210470
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 18:07:12 +0000 (UTC)
Received: (qmail 92117 invoked by uid 500); 24 Nov 2014 18:07:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 92079 invoked by uid 500); 24 Nov 2014 18:07:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 92067 invoked by uid 99); 24 Nov 2014 18:07:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 18:07:12 +0000
Date: Mon, 24 Nov 2014 18:07:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.7481.1416852432652@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-804) Client program is not
 terminated when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14223216#comment-14223216 ] 

Hadoop QA commented on BOOKKEEPER-804:
--------------------------------------

Testing JIRA BOOKKEEPER-804


Patch [0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch|https://issues.apache.org/jira/secure/attachment/12683348/0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch] downloaded at Mon Nov 24 17:30:16 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 931
.    Tests failed: 1
.    Tests errors: 1

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/851/

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch, 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11690-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Mon Nov 24 21:47:13 2014
Return-Path: <bookkeeper-dev-return-11690-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 60B721006F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Mon, 24 Nov 2014 21:47:13 +0000 (UTC)
Received: (qmail 87792 invoked by uid 500); 24 Nov 2014 21:47:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 87752 invoked by uid 500); 24 Nov 2014 21:47:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 87739 invoked by uid 99); 24 Nov 2014 21:47:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 24 Nov 2014 21:47:12 +0000
Date: Mon, 24 Nov 2014 21:47:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.9955.1416865632814@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-804) Client program is not
 terminated when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14223575#comment-14223575 ] 

Hadoop QA commented on BOOKKEEPER-804:
--------------------------------------

Testing JIRA BOOKKEEPER-804


Patch [0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch|https://issues.apache.org/jira/secure/attachment/12683348/0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch] downloaded at Mon Nov 24 21:10:25 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 931
.    Tests failed: 0
.    Tests errors: 1

.    The patch failed the following testcases:

.      

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/852/

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch, 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11691-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 25 08:50:34 2014
Return-Path: <bookkeeper-dev-return-11691-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3982A1061A
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 25 Nov 2014 08:50:34 +0000 (UTC)
Received: (qmail 3276 invoked by uid 500); 25 Nov 2014 08:50:33 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 3123 invoked by uid 500); 25 Nov 2014 08:50:33 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 2957 invoked by uid 99); 25 Nov 2014 08:50:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 08:50:32 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of hadoop.uma@gmail.com designates 209.85.212.175 as permitted sender)
Received: from [209.85.212.175] (HELO mail-wi0-f175.google.com) (209.85.212.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 08:50:06 +0000
Received: by mail-wi0-f175.google.com with SMTP id l15so8364654wiw.2
        for <multiple recipients>; Tue, 25 Nov 2014 00:49:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        bh=22dmbpHWrfONxK+P4JuEAtKXmkLonteir1MEpeB1jnU=;
        b=S3nYzm0K0BwBPOX443ySy2/KCWjOrtSrJtbx2a5y4Y+W/YWZeo0ZFlumHussT8vTCF
         KBjk8wPhITIgrc6Ah6WvyZGaiwoFuwox/+mpu3VX/gg3hDKCeNH9xvHoCh5bx0Jo5jSf
         0vcLPILU33B0oH3ntF/BZajgQDLVwowtFh/SB5Pf+lzJWvgCPmpMaf0Aj6wEyoq9hFms
         0WzfVj4jLoc1B1x6x5NlRK7hzKNMJ7q/AV3ynkTrErtLoYcAXAbzlm2VW/7gZptHORHb
         7tzOwK39+BYesDhJDaFEOxJiBE2qELinp/SWKx50uREIDgREMQn3DvVT7joibiQdfxKS
         jqHg==
MIME-Version: 1.0
X-Received: by 10.180.87.72 with SMTP id v8mr29630893wiz.22.1416905360960;
 Tue, 25 Nov 2014 00:49:20 -0800 (PST)
Received: by 10.194.3.48 with HTTP; Tue, 25 Nov 2014 00:49:20 -0800 (PST)
In-Reply-To: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
References: <E541D41F-A3BF-4AC5-95F3-54B09276A09E@yahoo.com>
Date: Tue, 25 Nov 2014 14:19:20 +0530
Message-ID: <CAPAEb8hHL5nswZ7wsbVUcrVYmaUg3zcZ4XVWrjoCtto+oUn8vA@mail.gmail.com>
Subject: Re: Apache BookKeeper TLP!
From: Uma Maheswara Rao G <hadoop.uma@gmail.com>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Cc: "bookkeeper-user@zookeeper.apache.org" <bookkeeper-user@zookeeper.apache.org>, 
	"bookkeeper-user@zookeeper.apache.org" <user@zookeeper.apache.org>, DevZooKeeper <dev@zookeeper.apache.org>
Content-Type: multipart/alternative; boundary=f46d0444019cb885410508aafc24
X-Virus-Checked: Checked by ClamAV on apache.org

--f46d0444019cb885410508aafc24
Content-Type: text/plain; charset=UTF-8

Awesome news!

Congrats to all!

Regards,
Uma

On Sun, Nov 23, 2014 at 3:56 PM, Flavio Junqueira <
fpjunqueira@yahoo.com.invalid> wrote:

> I just wanted to share that the board approved our proposal to make Apache
> BookKeeper a top-level project. I'm thrilled with the news and I want to
> thank everyone for the support, especially the ZooKeeper community for
> hosting the project. The BookKeeper community will start working on the
> transition right away.
>
> -Flavio

--f46d0444019cb885410508aafc24--

From bookkeeper-dev-return-11692-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 25 08:52:54 2014
Return-Path: <bookkeeper-dev-return-11692-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B55811063C
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 25 Nov 2014 08:52:54 +0000 (UTC)
Received: (qmail 14839 invoked by uid 500); 25 Nov 2014 08:52:54 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 14807 invoked by uid 500); 25 Nov 2014 08:52:54 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 14785 invoked by uid 99); 25 Nov 2014 08:52:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 08:52:54 +0000
X-ASF-Spam-Status: No, hits=1.5 required=5.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of hadoop.uma@gmail.com designates 209.85.212.182 as permitted sender)
Received: from [209.85.212.182] (HELO mail-wi0-f182.google.com) (209.85.212.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 08:52:48 +0000
Received: by mail-wi0-f182.google.com with SMTP id h11so612945wiw.9
        for <bookkeeper-dev@zookeeper.apache.org>; Tue, 25 Nov 2014 00:50:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=s/ogrTH+sIQQTTPclbxP8FgAZp2cTxxJt+raMTYladA=;
        b=qs2SPVEQge2T85QLW81f4xwL4py03TGriXPEGcNHdrxHfLSP+Hguq7njj0sQX6aoGP
         7JyqEpELkPN9oFoY38w4kBl98li8Y8ZusemLACH2y19076erx0M7V68NAH2pY9+g0Amc
         1oHOfguQ3R5xv9aW/eQOADsXXAmz9lk7PqCQY7Is0b1HBB4sTHC/xYTZTnO5UHn+ewV+
         lApVV7F8Ku9MIzRJDy2VT+P24kNZTciaoWG8+uEySbWwoe5IzCQwYdZ1BQ+W33UjF/tJ
         PK1ArF9FcKmKxinRE1O7luzOtblYZtvi25yDB1qkuHwXi9SS+iV6TVDq/RbZcY7ARo8w
         XHfA==
MIME-Version: 1.0
X-Received: by 10.180.92.234 with SMTP id cp10mr29650527wib.16.1416905457685;
 Tue, 25 Nov 2014 00:50:57 -0800 (PST)
Received: by 10.194.3.48 with HTTP; Tue, 25 Nov 2014 00:50:57 -0800 (PST)
In-Reply-To: <CAD=ttqRYiryVe64h3SZACuyzLKXDSsopDjXTTrY5Ee4GYxKY8Q@mail.gmail.com>
References: <CAD=ttqRYiryVe64h3SZACuyzLKXDSsopDjXTTrY5Ee4GYxKY8Q@mail.gmail.com>
Date: Tue, 25 Nov 2014 14:20:57 +0530
Message-ID: <CAPAEb8hCjih3+1W6KxzAY_TxTSWeaoHYPB2OMz6aSj6b_4DAgg@mail.gmail.com>
Subject: Re: BookKeeper vs. Bookkeeper
From: Uma Maheswara Rao G <hadoop.uma@gmail.com>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>
Content-Type: multipart/alternative; boundary=f46d04388e577c5a220508ab02b7
X-Virus-Checked: Checked by ClamAV on apache.org

--f46d04388e577c5a220508ab02b7
Content-Type: text/plain; charset=UTF-8

+1 for BookKeeper

Regards,
Uma

On Thu, Oct 23, 2014 at 2:31 PM, Ivan Kelly <ivank@apache.org> wrote:

> Hi folks,
>
> Now that we are going top level, we have a chance to fix something
> that has been bugging me since I started working on the project; the
> superfluously capitalization of K in the name. The word 'bookkeeper'
> is a single word. The norms of capitalization, in written language,
> and also in CamelCase, dictate that only the first letter of a word
> should ever be capitalized. What's more, since people are familiar
> with this, the lean towards doing this, only remembering to add the K
> some of the time. So we end up in the following situation.
>
> ivank@trainmoney-ll ~/src/bookkeeper Thu Oct
> 23 10:45:31 [0 jobs] [hist 10099]
> $ find . -name *.java -exec grep Bookkeeper {} \; | wc -l
> 763
> ivank@trainmoney-ll ~/src/bookkeeper Thu Oct
> 23 10:45:36 [0 jobs] [hist 10100]
> $ find . -name *.java -exec grep BookKeeper {} \; | wc -l
> 682
>
> In the code, Bookkeeper is actually more common.
>
> The word bookkeeper is hard enough to type, with 3 consecutive double
> letters, without having a random capitalization in the middle.
>
> Does this annoy anyone else? Should we kill the K?
>
> Regards
> Ivan
>

--f46d04388e577c5a220508ab02b7--

From bookkeeper-dev-return-11693-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 25 11:37:13 2014
Return-Path: <bookkeeper-dev-return-11693-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3930E10B9B
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 25 Nov 2014 11:37:13 +0000 (UTC)
Received: (qmail 23689 invoked by uid 500); 25 Nov 2014 11:37:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 23673 invoked by uid 500); 25 Nov 2014 11:37:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 23662 invoked by uid 99); 25 Nov 2014 11:37:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 11:37:12 +0000
Date: Tue, 25 Nov 2014 11:37:12 +0000 (UTC)
From: "Youngjoon Kim (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757666.1416915422000.15039.1416915432820@Atlassian.JIRA>
In-Reply-To: <JIRA.12757666.1416915422000@Atlassian.JIRA>
References: <JIRA.12757666.1416915422000@Atlassian.JIRA> <JIRA.12757666.1416915422081@arcas>
Subject: [jira] [Created] (BOOKKEEPER-805) NullPointException in bookie
 server when using twitter-ostrich-provider
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Youngjoon Kim created BOOKKEEPER-805:
----------------------------------------

             Summary: NullPointException in bookie server when using twitter-ostrich-provider
                 Key: BOOKKEEPER-805
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-805
             Project: Bookkeeper
          Issue Type: Bug
    Affects Versions: 4.3.0
            Reporter: Youngjoon Kim


How to reproduce this bug
1) Set configurations in conf/bk_server.conf to use twitter-ostrich-provider.
{noformat}
statsProviderClass=org.apache.bookkeeper.stats.twitter.ostrich.OstrichProvider
statsExport=true
{noformat}

2) Copy twitter-ostrich-provider-4.3.0.jar and required library jars to lib directory.
{noformat}
(library jars)
ostrich_2.9.2-9.1.3.jar
scala-json_2.9.2-3.0.1.jar
scala-library-2.9.2.jar
util-app_2.9.2-6.3.7.jar
util-core_2.9.2-6.3.7.jar
util-eval_2.9.2-6.3.7.jar
util-jvm_2.9.2-6.3.7.jar
util-logging_2.9.2-6.3.7.jar
{noformat}

3) Start a bookie server. Then, the server doesn't start and server log shows NullPointException.
{noformat}
2014-11-25 17:30:27,796 - ERROR [main:BookieServer@396] - Exception running bookie server :
java.lang.NullPointerException
    at com.twitter.ostrich.stats.StatsListener.<init>(StatsListener.scala:90)
    at com.twitter.ostrich.stats.LatchedStatsListener.<init>(StatsListener.scala:144)
    at com.twitter.ostrich.stats.StatsListener$$anonfun$apply$4.apply(StatsListener.scala:68)
    at com.twitter.ostrich.stats.StatsListener$$anonfun$apply$4.apply(StatsListener.scala:68)
    at com.twitter.ostrich.stats.StatsListener$$anonfun$getOrRegister$1.apply(StatsListener.scala:40)
    at com.twitter.ostrich.stats.StatsListener$$anonfun$getOrRegister$1.apply(StatsListener.scala:39)
    at scala.Option.getOrElse(Option.scala:108)
    at com.twitter.ostrich.stats.StatsListener$.getOrRegister(StatsListener.scala:39)
    at com.twitter.ostrich.stats.StatsListener$.apply(StatsListener.scala:67)
    at com.twitter.ostrich.admin.AdminServiceFactory$$anonfun$configureStatsListeners$1.apply(AdminServiceFactory.scala:81)
    at com.twitter.ostrich.admin.AdminServiceFactory$$anonfun$configureStatsListeners$1.apply(AdminServiceFactory.scala:81)
    at scala.collection.LinearSeqOptimized$class.foreach(LinearSeqOptimized.scala:59)
    at scala.collection.immutable.List.foreach(List.scala:76)
    at com.twitter.ostrich.admin.AdminServiceFactory.configureStatsListeners(AdminServiceFactory.scala:81)
    at com.twitter.ostrich.admin.AdminServiceFactory.apply(AdminServiceFactory.scala:61)
    at org.apache.bookkeeper.stats.twitter.ostrich.OstrichProvider.start(OstrichProvider.java:57)
    at org.apache.bookkeeper.proto.BookieServer.main(BookieServer.java:375)
{noformat}




--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11694-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 25 11:58:13 2014
Return-Path: <bookkeeper-dev-return-11694-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E18EE10C42
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 25 Nov 2014 11:58:13 +0000 (UTC)
Received: (qmail 97844 invoked by uid 500); 25 Nov 2014 11:58:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 97801 invoked by uid 500); 25 Nov 2014 11:58:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 97735 invoked by uid 99); 25 Nov 2014 11:58:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 11:58:12 +0000
Date: Tue, 25 Nov 2014 11:58:12 +0000 (UTC)
From: "Youngjoon Kim (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757666.1416915422000.15172.1416916692484@Atlassian.JIRA>
In-Reply-To: <JIRA.12757666.1416915422000@Atlassian.JIRA>
References: <JIRA.12757666.1416915422000@Atlassian.JIRA> <JIRA.12757666.1416915422081@arcas>
Subject: [jira] [Updated] (BOOKKEEPER-805) NullPointException in bookie
 server when using twitter-ostrich-provider
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-805?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Youngjoon Kim updated BOOKKEEPER-805:
-------------------------------------
    Attachment: BOOKKEEPER-805.patch

I've attached a patch.

There are two problems in OstrichProvider.java.
1) null values are assigned to parameters require scala's List type. These should be replaced with empty List values.

2) After fixing 1), 'java.lang.IllegalStateException: server in wrong state' is thrown. This is caused by starting AdminHttpService twice. AdminServiceFactory automatically calls AdminHttpService's start(), so we shouldn't call  AdminHttpService's start() again.

> NullPointException in bookie server when using twitter-ostrich-provider
> -----------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-805
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-805
>             Project: Bookkeeper
>          Issue Type: Bug
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>         Attachments: BOOKKEEPER-805.patch
>
>
> How to reproduce this bug
> 1) Set configurations in conf/bk_server.conf to use twitter-ostrich-provider.
> {noformat}
> statsProviderClass=org.apache.bookkeeper.stats.twitter.ostrich.OstrichProvider
> statsExport=true
> {noformat}
> 2) Copy twitter-ostrich-provider-4.3.0.jar and required library jars to lib directory.
> {noformat}
> (library jars)
> ostrich_2.9.2-9.1.3.jar
> scala-json_2.9.2-3.0.1.jar
> scala-library-2.9.2.jar
> util-app_2.9.2-6.3.7.jar
> util-core_2.9.2-6.3.7.jar
> util-eval_2.9.2-6.3.7.jar
> util-jvm_2.9.2-6.3.7.jar
> util-logging_2.9.2-6.3.7.jar
> {noformat}
> 3) Start a bookie server. Then, the server doesn't start and server log shows NullPointException.
> {noformat}
> 2014-11-25 17:30:27,796 - ERROR [main:BookieServer@396] - Exception running bookie server :
> java.lang.NullPointerException
>     at com.twitter.ostrich.stats.StatsListener.<init>(StatsListener.scala:90)
>     at com.twitter.ostrich.stats.LatchedStatsListener.<init>(StatsListener.scala:144)
>     at com.twitter.ostrich.stats.StatsListener$$anonfun$apply$4.apply(StatsListener.scala:68)
>     at com.twitter.ostrich.stats.StatsListener$$anonfun$apply$4.apply(StatsListener.scala:68)
>     at com.twitter.ostrich.stats.StatsListener$$anonfun$getOrRegister$1.apply(StatsListener.scala:40)
>     at com.twitter.ostrich.stats.StatsListener$$anonfun$getOrRegister$1.apply(StatsListener.scala:39)
>     at scala.Option.getOrElse(Option.scala:108)
>     at com.twitter.ostrich.stats.StatsListener$.getOrRegister(StatsListener.scala:39)
>     at com.twitter.ostrich.stats.StatsListener$.apply(StatsListener.scala:67)
>     at com.twitter.ostrich.admin.AdminServiceFactory$$anonfun$configureStatsListeners$1.apply(AdminServiceFactory.scala:81)
>     at com.twitter.ostrich.admin.AdminServiceFactory$$anonfun$configureStatsListeners$1.apply(AdminServiceFactory.scala:81)
>     at scala.collection.LinearSeqOptimized$class.foreach(LinearSeqOptimized.scala:59)
>     at scala.collection.immutable.List.foreach(List.scala:76)
>     at com.twitter.ostrich.admin.AdminServiceFactory.configureStatsListeners(AdminServiceFactory.scala:81)
>     at com.twitter.ostrich.admin.AdminServiceFactory.apply(AdminServiceFactory.scala:61)
>     at org.apache.bookkeeper.stats.twitter.ostrich.OstrichProvider.start(OstrichProvider.java:57)
>     at org.apache.bookkeeper.proto.BookieServer.main(BookieServer.java:375)
> {noformat}



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11695-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 25 12:05:13 2014
Return-Path: <bookkeeper-dev-return-11695-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 18F8110C8F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 25 Nov 2014 12:05:13 +0000 (UTC)
Received: (qmail 15534 invoked by uid 500); 25 Nov 2014 12:05:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 15506 invoked by uid 500); 25 Nov 2014 12:05:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 15493 invoked by uid 99); 25 Nov 2014 12:05:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 12:05:12 +0000
Date: Tue, 25 Nov 2014 12:05:12 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757666.1416915422000.15205.1416917112814@Atlassian.JIRA>
In-Reply-To: <JIRA.12757666.1416915422000@Atlassian.JIRA>
References: <JIRA.12757666.1416915422000@Atlassian.JIRA> <JIRA.12757666.1416915422081@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-805) NullPointException in bookie
 server when using twitter-ostrich-provider
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-805?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14224453#comment-14224453 ] 

Ivan Kelly commented on BOOKKEEPER-805:
---------------------------------------

Best for [~hustlmsp] to review this.

> NullPointException in bookie server when using twitter-ostrich-provider
> -----------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-805
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-805
>             Project: Bookkeeper
>          Issue Type: Bug
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>         Attachments: BOOKKEEPER-805.patch
>
>
> How to reproduce this bug
> 1) Set configurations in conf/bk_server.conf to use twitter-ostrich-provider.
> {noformat}
> statsProviderClass=org.apache.bookkeeper.stats.twitter.ostrich.OstrichProvider
> statsExport=true
> {noformat}
> 2) Copy twitter-ostrich-provider-4.3.0.jar and required library jars to lib directory.
> {noformat}
> (library jars)
> ostrich_2.9.2-9.1.3.jar
> scala-json_2.9.2-3.0.1.jar
> scala-library-2.9.2.jar
> util-app_2.9.2-6.3.7.jar
> util-core_2.9.2-6.3.7.jar
> util-eval_2.9.2-6.3.7.jar
> util-jvm_2.9.2-6.3.7.jar
> util-logging_2.9.2-6.3.7.jar
> {noformat}
> 3) Start a bookie server. Then, the server doesn't start and server log shows NullPointException.
> {noformat}
> 2014-11-25 17:30:27,796 - ERROR [main:BookieServer@396] - Exception running bookie server :
> java.lang.NullPointerException
>     at com.twitter.ostrich.stats.StatsListener.<init>(StatsListener.scala:90)
>     at com.twitter.ostrich.stats.LatchedStatsListener.<init>(StatsListener.scala:144)
>     at com.twitter.ostrich.stats.StatsListener$$anonfun$apply$4.apply(StatsListener.scala:68)
>     at com.twitter.ostrich.stats.StatsListener$$anonfun$apply$4.apply(StatsListener.scala:68)
>     at com.twitter.ostrich.stats.StatsListener$$anonfun$getOrRegister$1.apply(StatsListener.scala:40)
>     at com.twitter.ostrich.stats.StatsListener$$anonfun$getOrRegister$1.apply(StatsListener.scala:39)
>     at scala.Option.getOrElse(Option.scala:108)
>     at com.twitter.ostrich.stats.StatsListener$.getOrRegister(StatsListener.scala:39)
>     at com.twitter.ostrich.stats.StatsListener$.apply(StatsListener.scala:67)
>     at com.twitter.ostrich.admin.AdminServiceFactory$$anonfun$configureStatsListeners$1.apply(AdminServiceFactory.scala:81)
>     at com.twitter.ostrich.admin.AdminServiceFactory$$anonfun$configureStatsListeners$1.apply(AdminServiceFactory.scala:81)
>     at scala.collection.LinearSeqOptimized$class.foreach(LinearSeqOptimized.scala:59)
>     at scala.collection.immutable.List.foreach(List.scala:76)
>     at com.twitter.ostrich.admin.AdminServiceFactory.configureStatsListeners(AdminServiceFactory.scala:81)
>     at com.twitter.ostrich.admin.AdminServiceFactory.apply(AdminServiceFactory.scala:61)
>     at org.apache.bookkeeper.stats.twitter.ostrich.OstrichProvider.start(OstrichProvider.java:57)
>     at org.apache.bookkeeper.proto.BookieServer.main(BookieServer.java:375)
> {noformat}



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11696-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 25 13:33:31 2014
Return-Path: <bookkeeper-dev-return-11696-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 48E171003C
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 25 Nov 2014 13:33:31 +0000 (UTC)
Received: (qmail 63865 invoked by uid 500); 25 Nov 2014 13:33:31 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 63833 invoked by uid 500); 25 Nov 2014 13:33:31 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 63818 invoked by uid 99); 25 Nov 2014 13:33:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 13:33:30 +0000
X-ASF-Spam-Status: No, hits=3.2 required=5.0
	tests=FORGED_YAHOO_RCVD,HTML_MESSAGE,RCVD_IN_DNSWL_NONE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of fpjunqueira@yahoo.com designates 98.139.213.150 as permitted sender)
Received: from [98.139.213.150] (HELO nm5-vm0.bullet.mail.bf1.yahoo.com) (98.139.213.150)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 13:33:02 +0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws; s=s2048; d=yahoo.com;
	b=fRJc0IPPP0msOUGVXrTXYGtINfAB+skzevwwwjUyGyESqpZXicZcp8Vjj6qP2uZPBOnOv4mfg/UBgI1dk35jQrERXpxDu23rO00hfKNf2JwTQhoZd09wVuKoJHsZm9GqcibVE50Y2sRHof9oHOsB40zrHwOfwDlkhx2XPxDwUDSxEMuni16Qpet622PRkxx1ZP9wtvTVQlKop3+abbEPIu5x6hN9E86rndR/c2g8W3yqolCoAKHWMA4lwAMITkDxXc4UEsK/V3wx1lsH8UslmmRDz1sp3SAdg/zYAtp4Ib3O784YEDAtPWCuoAssD7dRqdMvJFtQEHBhe5hu+4i9bw==;
Received: from [66.196.81.172] by nm5.bullet.mail.bf1.yahoo.com with NNFMP; 25 Nov 2014 13:29:51 -0000
Received: from [98.139.212.198] by tm18.bullet.mail.bf1.yahoo.com with NNFMP; 25 Nov 2014 13:29:51 -0000
Received: from [127.0.0.1] by omp1007.mail.bf1.yahoo.com with NNFMP; 25 Nov 2014 13:29:51 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 907576.49788.bm@omp1007.mail.bf1.yahoo.com
X-YMail-OSG: SFFyK30VM1kPln.YCWMxZlo_4d4Gnd9NRAtTmY7MrJ2AJzA4UBnyaQbhsIY9pOx
 QAsy7XJHMQGueRp0njh.fFlyUeE.CyT84BQN9NQZjpNHa1dWACRL0XDmEcjno6Eqpn6Lj1CWcFAl
 t5eQ5657cYf0CGEjl75YKwp0t8YqmfIf5wJ0lTItiErRotoJUrEWMZO31pB.bVrduHODspkD310X
 gbrlP44xXK.O5kUn4XvBm1GEg6D4OBPFltC0KGAyMo3u8KyrmWjs8ayCb9..8kRKuEtfyct5fg_k
 q8CA_DCTvUzXdoo79rEKW..uVRKum8sXaXtDNes_cNvLebOyyg73GwHV8gTI5yhk2aW3nmfquwgP
 7kpZnVCu6n9YRIXJvQOathcFo94aS6igYu4JLOBiLYSmUCRkhGraa7vwECBXizdG6YOPJX7XcUkZ
 mk4XSUrdn5pIUGThe9OwA1_Vs2f4zgGVqvktyW0ubm2xKORE998I6JJTgFw2umi0XXmVClaKWPSl
 eGkDd.sVeaNmFlRySf0FQpwxcAKtXWmMwNl7Yc8mnFEeVm8Gtxq3x91HGNLZ1xGg-
Received: by 66.196.80.144; Tue, 25 Nov 2014 13:29:50 +0000 
Date: Tue, 25 Nov 2014 13:29:50 +0000 (UTC)
From: Flavio Junqueira <fpjunqueira@yahoo.com.INVALID>
Reply-To: Flavio Junqueira <fpjunqueira@yahoo.com>
To: Bookkeeper <bookkeeper-dev@zookeeper.apache.org>
Message-ID: <270478344.755636.1416922190603.JavaMail.yahoo@jws106108.mail.bf1.yahoo.com>
Subject: Office
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_755635_1123601503.1416922190601"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_755635_1123601503.1416922190601
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit

We already have an office entry and a VP on the foundation page!
http://www.apache.org/foundation/

-Flavio

------=_Part_755635_1123601503.1416922190601--

From bookkeeper-dev-return-11697-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Tue Nov 25 13:57:15 2014
Return-Path: <bookkeeper-dev-return-11697-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BC3461010F
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Tue, 25 Nov 2014 13:57:15 +0000 (UTC)
Received: (qmail 23610 invoked by uid 500); 25 Nov 2014 13:57:15 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 23578 invoked by uid 500); 25 Nov 2014 13:57:15 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 23567 invoked by uid 99); 25 Nov 2014 13:57:15 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 25 Nov 2014 13:57:15 +0000
Received: from mail-la0-f49.google.com (mail-la0-f49.google.com [209.85.215.49])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id B84A81A04A2
	for <bookkeeper-dev@zookeeper.apache.org>; Tue, 25 Nov 2014 13:57:03 +0000 (UTC)
Received: by mail-la0-f49.google.com with SMTP id hs14so560755lab.22
        for <bookkeeper-dev@zookeeper.apache.org>; Tue, 25 Nov 2014 05:57:10 -0800 (PST)
X-Gm-Message-State: ALoCoQmFjp5GYFuYBASUYgpE/Ni+o6Bqk2ftd4px6kdWxgF4jVdTDoH9U1LBZBE/IrRjTg6908Sc
MIME-Version: 1.0
X-Received: by 10.112.199.130 with SMTP id jk2mr14169240lbc.3.1416923830410;
 Tue, 25 Nov 2014 05:57:10 -0800 (PST)
Received: by 10.112.31.47 with HTTP; Tue, 25 Nov 2014 05:57:10 -0800 (PST)
X-Originating-IP: [213.27.241.137]
In-Reply-To: <270478344.755636.1416922190603.JavaMail.yahoo@jws106108.mail.bf1.yahoo.com>
References: <270478344.755636.1416922190603.JavaMail.yahoo@jws106108.mail.bf1.yahoo.com>
Date: Tue, 25 Nov 2014 14:57:10 +0100
Message-ID: <CAD=ttqTpamStR95-jtRP6a-_zzBu_QPGbHr8Fo7UB4zhohUrGw@mail.gmail.com>
Subject: Re: Office
From: Ivan Kelly <ivank@apache.org>
To: "bookkeeper-dev@zookeeper.apache.org" <bookkeeper-dev@zookeeper.apache.org>, 
	Flavio Junqueira <fpjunqueira@yahoo.com>
Content-Type: text/plain; charset=UTF-8

First thing I added. The permissions are available straight away.
Waiting on infra now (INFRA-8697)

On 25 November 2014 at 14:29, Flavio Junqueira
<fpjunqueira@yahoo.com.invalid> wrote:
> We already have an office entry and a VP on the foundation page!
> http://www.apache.org/foundation/
>
> -Flavio

From bookkeeper-dev-return-11698-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 26 02:47:13 2014
Return-Path: <bookkeeper-dev-return-11698-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 68C15105E0
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 26 Nov 2014 02:47:13 +0000 (UTC)
Received: (qmail 22689 invoked by uid 500); 26 Nov 2014 02:47:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 22656 invoked by uid 500); 26 Nov 2014 02:47:13 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 22645 invoked by uid 99); 26 Nov 2014 02:47:13 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Nov 2014 02:47:13 +0000
Date: Wed, 26 Nov 2014 02:47:13 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757378.1416831446000.21942.1416970033031@Atlassian.JIRA>
In-Reply-To: <JIRA.12757378.1416831446000@Atlassian.JIRA>
References: <JIRA.12757378.1416831446000@Atlassian.JIRA> <JIRA.12757378.1416831446660@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-804) Client program is not
 terminated when using openLedgerNoRecovery
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-804?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14225623#comment-14225623 ] 

Hadoop QA commented on BOOKKEEPER-804:
--------------------------------------

Testing JIRA BOOKKEEPER-804


Patch [0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch|https://issues.apache.org/jira/secure/attachment/12683348/0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch] downloaded at Wed Nov 26 02:10:19 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 924
.    Tests failed: 0
.    Tests errors: 1

.    The patch failed the following testcases:

.      

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/853/

> Client program is not terminated when using openLedgerNoRecovery
> ----------------------------------------------------------------
>
>                 Key: BOOKKEEPER-804
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-804
>             Project: Bookkeeper
>          Issue Type: Bug
>          Components: bookkeeper-client
>    Affects Versions: 4.3.0
>            Reporter: Youngjoon Kim
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1
>
>         Attachments: 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch, 0001-BOOKKEEPER-804-Client-program-is-not-terminated-when.patch
>
>
> If a client program does some operations using a ledger handle opened by openLedgerNoRecovery(), the program is not terminated after the handle and bookkeeper object is closed.
> Here is a sample code. 
> {code}
> import java.util.Enumeration;
> import org.apache.bookkeeper.client.BookKeeper;
> import org.apache.bookkeeper.client.LedgerEntry;
> import org.apache.bookkeeper.client.LedgerHandle;
> public class BkClient {
>   public static void main(String[] args) {
>     try {
>       BookKeeper bk = new BookKeeper("localhost:2181");
>       // 9 is a ledger id of an existing ledger
>       LedgerHandle lh = bk.openLedgerNoRecovery(9, BookKeeper.DigestType.CRC32, "passwd".getBytes());
>       Enumeration<LedgerEntry> entries = lh.readEntries(0, 0);
>       lh.close();
>       bk.close();
>     } catch (Exception e) {
>       e.printStackTrace();
>     }
>   }
> }
> {code}
> Thread dump of this program shows that non-daemon thread "ZkLedgerManagerScheduler-0"  is alive, after bk.close() is called. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11699-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 26 02:56:13 2014
Return-Path: <bookkeeper-dev-return-11699-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4EEE210615
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 26 Nov 2014 02:56:13 +0000 (UTC)
Received: (qmail 33585 invoked by uid 500); 26 Nov 2014 02:56:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 33538 invoked by uid 500); 26 Nov 2014 02:56:13 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 33526 invoked by uid 99); 26 Nov 2014 02:56:13 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Nov 2014 02:56:13 +0000
Date: Wed, 26 Nov 2014 02:56:13 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756421.1416409636000.21982.1416970573147@Atlassian.JIRA>
In-Reply-To: <JIRA.12756421.1416409636000@Atlassian.JIRA>
References: <JIRA.12756421.1416409636000@Atlassian.JIRA> <JIRA.12756421.1416409636416@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-798) Make website look more modern
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-798?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14225631#comment-14225631 ] 

Hadoop QA commented on BOOKKEEPER-798:
--------------------------------------

Testing JIRA BOOKKEEPER-798


Patch [0001-Adding-bootstrap-resources-for-site-reboot.patch|https://issues.apache.org/jira/secure/attachment/12682425/0001-Adding-bootstrap-resources-for-site-reboot.patch] downloaded at Wed Nov 26 02:51:02 UTC 2014

----------------------------

{color:red}-1{color} Patch failed to apply to head of branch

----------------------------

> Make website look more modern
> -----------------------------
>
>                 Key: BOOKKEEPER-798
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-798
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>         Attachments: 0001-Adding-bootstrap-resources-for-site-reboot.patch, 0001-Make-site-use-bootstrap.patch
>
>
> The current website looks super old. This jira is to remedy the style. Changes to content will come later.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11700-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 26 03:36:12 2014
Return-Path: <bookkeeper-dev-return-11700-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F045A10720
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 26 Nov 2014 03:36:12 +0000 (UTC)
Received: (qmail 73662 invoked by uid 500); 26 Nov 2014 03:36:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 73624 invoked by uid 500); 26 Nov 2014 03:36:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 73609 invoked by uid 99); 26 Nov 2014 03:36:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Nov 2014 03:36:12 +0000
Date: Wed, 26 Nov 2014 03:36:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756950.1416569610000.22158.1416972972698@Atlassian.JIRA>
In-Reply-To: <JIRA.12756950.1416569610000@Atlassian.JIRA>
References: <JIRA.12756950.1416569610000@Atlassian.JIRA> <JIRA.12756950.1416569610636@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-799) Distribution schedule coverage
 sets don't take gaps in response lists into account when writequorum >
 ackquorum
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-799?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14225658#comment-14225658 ] 

Hadoop QA commented on BOOKKEEPER-799:
--------------------------------------

Testing JIRA BOOKKEEPER-799


Patch [0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch|https://issues.apache.org/jira/secure/attachment/12682858/0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch] downloaded at Wed Nov 26 02:55:49 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:green}+1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:green}+1{color} the patch does adds/modifies 1 testcase(s)
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 931
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:green}*+1 Overall result, good!, no -1s*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/855/

> Distribution schedule coverage sets don't take gaps in response lists into account when writequorum > ackquorum
> ---------------------------------------------------------------------------------------------------------------
>
>                 Key: BOOKKEEPER-799
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-799
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>            Priority: Blocker
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-BOOKKEEPER-799-Distribution-schedule-coverage-sets-d.patch
>
>
> The algorithm now be used to check if all quorums are being covered when sending a read lac or fencing message is broken when writeQuorum >= ackQuorum.
> The purpose of the algorithm is to tell us when we have heard a response from enough nodes, that an ack quorum could not possibly have been formed without at least one of the nodes that we have heard responses from.
> The current algorithm works when writeQuorum == ackQuorum, as we consider all quorums covered if the first |ackQuorum| nodes in the writeQuorum are covered. However, this doesn't work in the case that it's the middle node in the quorum that we have heard.
> Take the example, e:4, w:3, a:2, and we've heard from node 0, and node 2. In this case, it is possible for the write quorum, 1,2,3 to get an ack quorum if 1 and 3 response. 



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11701-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 26 04:13:16 2014
Return-Path: <bookkeeper-dev-return-11701-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 777A210898
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 26 Nov 2014 04:13:16 +0000 (UTC)
Received: (qmail 58796 invoked by uid 500); 26 Nov 2014 04:13:04 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 58693 invoked by uid 500); 26 Nov 2014 04:13:04 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 58525 invoked by uid 99); 26 Nov 2014 04:13:03 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Nov 2014 04:13:03 +0000
Date: Wed, 26 Nov 2014 04:13:03 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12756976.1416576618000.22942.1416975183872@Atlassian.JIRA>
In-Reply-To: <JIRA.12756976.1416576618000@Atlassian.JIRA>
References: <JIRA.12756976.1416576618000@Atlassian.JIRA> <JIRA.12756976.1416576618300@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-800) Expose whether a ledger is
 closed or not
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-800?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14225696#comment-14225696 ] 

Hadoop QA commented on BOOKKEEPER-800:
--------------------------------------

Testing JIRA BOOKKEEPER-800


Patch [0001-Expose-whether-a-ledger-has-been-closed.patch|https://issues.apache.org/jira/secure/attachment/12682903/0001-Expose-whether-a-ledger-has-been-closed.patch] downloaded at Wed Nov 26 03:35:32 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 927
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/856/

> Expose whether a ledger is closed or not
> ----------------------------------------
>
>                 Key: BOOKKEEPER-800
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-800
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0, 4.3.1, 4.2.4
>
>         Attachments: 0001-Expose-whether-a-ledger-has-been-closed.patch, 0001-Expose-whether-a-ledger-has-been-closed.patch
>
>
> On issue i could writing the tutorial is that when you open a ledger in non-recovery mode, it's not possible to check if the ledger you opened has been closed or is still been written too. This complicates things when you get to the end of the ledger, as you don't know whether to try for more entries in the same ledger, or to look at the next ledger is the list.
> This jira is to expose this information (it's in the metadata). This method only makes sense for reading. For writing a ledger, you really should know if you closed the ledger or not, and if you don't then you shouldn't be touching it again.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11702-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 26 04:48:13 2014
Return-Path: <bookkeeper-dev-return-11702-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1CD3710A69
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 26 Nov 2014 04:48:13 +0000 (UTC)
Received: (qmail 94499 invoked by uid 500); 26 Nov 2014 04:48:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 94459 invoked by uid 500); 26 Nov 2014 04:48:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 94448 invoked by uid 99); 26 Nov 2014 04:48:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Nov 2014 04:48:12 +0000
Date: Wed, 26 Nov 2014 04:48:12 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757018.1416588978000.23714.1416977292837@Atlassian.JIRA>
In-Reply-To: <JIRA.12757018.1416588978000@Atlassian.JIRA>
References: <JIRA.12757018.1416588978000@Atlassian.JIRA> <JIRA.12757018.1416588978190@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-802) Bookkeeper protocol
 documentation
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-802?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14225739#comment-14225739 ] 

Hadoop QA commented on BOOKKEEPER-802:
--------------------------------------

Testing JIRA BOOKKEEPER-802


Patch [0002-Protocol.patch|https://issues.apache.org/jira/secure/attachment/12682909/0002-Protocol.patch] downloaded at Wed Nov 26 04:12:06 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/857/

> Bookkeeper protocol documentation
> ---------------------------------
>
>                 Key: BOOKKEEPER-802
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-802
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0002-Protocol.patch
>
>
> We need a precise description of the bookkeeper protocol and the guarantees therein.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11703-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 26 05:24:14 2014
Return-Path: <bookkeeper-dev-return-11703-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B426410B47
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 26 Nov 2014 05:24:14 +0000 (UTC)
Received: (qmail 48476 invoked by uid 500); 26 Nov 2014 05:24:14 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 48430 invoked by uid 500); 26 Nov 2014 05:24:14 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 48254 invoked by uid 99); 26 Nov 2014 05:24:14 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Nov 2014 05:24:14 +0000
Date: Wed, 26 Nov 2014 05:24:14 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757015.1416588670000.23866.1416979454378@Atlassian.JIRA>
In-Reply-To: <JIRA.12757015.1416588670000@Atlassian.JIRA>
References: <JIRA.12757015.1416588670000@Atlassian.JIRA> <JIRA.12757015.1416588670139@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-801) Bookkeeper client tutorial
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-801?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14225770#comment-14225770 ] 

Hadoop QA commented on BOOKKEEPER-801:
--------------------------------------

Testing JIRA BOOKKEEPER-801


Patch [0001-Bookkeeper-tutorial.patch|https://issues.apache.org/jira/secure/attachment/12682908/0001-Bookkeeper-tutorial.patch] downloaded at Wed Nov 26 04:48:01 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:red}-1 TESTS{color}
.    Tests run: 930
.    Tests failed: 1
.    Tests errors: 0

.    The patch failed the following testcases:

.      testSimpleChat(org.apache.hedwig.jms.BasicJMSTest)

{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/858/

> Bookkeeper client tutorial
> --------------------------
>
>                 Key: BOOKKEEPER-801
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-801
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0001-Bookkeeper-tutorial.patch
>
>
> Taking the tutorial from https://github.com/ivankelly/bookkeeper-tutorial and adding it to the bookkeeper docs.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11704-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Wed Nov 26 06:00:17 2014
Return-Path: <bookkeeper-dev-return-11704-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 161AC10BF3
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Wed, 26 Nov 2014 06:00:17 +0000 (UTC)
Received: (qmail 99289 invoked by uid 500); 26 Nov 2014 06:00:17 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 99262 invoked by uid 500); 26 Nov 2014 06:00:16 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 99250 invoked by uid 99); 26 Nov 2014 06:00:16 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 26 Nov 2014 06:00:16 +0000
Date: Wed, 26 Nov 2014 06:00:16 +0000 (UTC)
From: "Hadoop QA (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12757019.1416589224000.24077.1416981616819@Atlassian.JIRA>
In-Reply-To: <JIRA.12757019.1416589224000@Atlassian.JIRA>
References: <JIRA.12757019.1416589224000@Atlassian.JIRA> <JIRA.12757019.1416589224219@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-803) Guide for making a replicated
 log out of ledgers
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-803?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14225800#comment-14225800 ] 

Hadoop QA commented on BOOKKEEPER-803:
--------------------------------------

Testing JIRA BOOKKEEPER-803


Patch [0003-Ledgers-2-logs.patch|https://issues.apache.org/jira/secure/attachment/12682911/0003-Ledgers-2-logs.patch] downloaded at Wed Nov 26 05:24:14 UTC 2014

----------------------------

{color:green}+1 PATCH_APPLIES{color}
{color:green}+1 CLEAN{color}
{color:red}-1 RAW_PATCH_ANALYSIS{color}
.    {color:green}+1{color} the patch does not introduce any @author tags
.    {color:green}+1{color} the patch does not introduce any tabs
.    {color:green}+1{color} the patch does not introduce any trailing spaces
.    {color:green}+1{color} the patch does not introduce any line longer than 120
.    {color:red}-1{color} the patch does not add/modify any testcase
{color:green}+1 RAT{color}
.    {color:green}+1{color} the patch does not seem to introduce new RAT warnings
{color:green}+1 JAVADOC{color}
.    {color:green}+1{color} the patch does not seem to introduce new Javadoc warnings
{color:green}+1 COMPILE{color}
.    {color:green}+1{color} HEAD compiles
.    {color:green}+1{color} patch compiles
.    {color:green}+1{color} the patch does not seem to introduce new javac warnings
{color:green}+1 FINDBUGS{color}
.    {color:green}+1{color} the patch does not seem to introduce new Findbugs warnings
{color:green}+1 TESTS{color}
.    Tests run: 930
{color:green}+1 DISTRO{color}
.    {color:green}+1{color} distro tarball builds with the patch 

----------------------------
{color:red}*-1 Overall result, please check the reported -1(s)*{color}


The full output of the test-patch run is available at

.   https://builds.apache.org/job/bookkeeper-trunk-precommit-build/859/

> Guide for making a replicated log out of ledgers
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-803
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-803
>             Project: Bookkeeper
>          Issue Type: Bug
>            Reporter: Ivan Kelly
>            Assignee: Ivan Kelly
>             Fix For: 4.4.0
>
>         Attachments: 0003-Ledgers-2-logs.patch
>
>
> We need a guide to show people how to create a replicated log out of ledgers, as ledgers on their own aren't enough.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11705-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 27 02:17:12 2014
Return-Path: <bookkeeper-dev-return-11705-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 969A710280
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 27 Nov 2014 02:17:12 +0000 (UTC)
Received: (qmail 61598 invoked by uid 500); 27 Nov 2014 02:17:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 61562 invoked by uid 500); 27 Nov 2014 02:17:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 61551 invoked by uid 99); 27 Nov 2014 02:17:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Nov 2014 02:17:12 +0000
Date: Thu, 27 Nov 2014 02:17:12 +0000 (UTC)
From: "Sebb (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12758114.1417054609000.31808.1417054632387@Atlassian.JIRA>
In-Reply-To: <JIRA.12758114.1417054609000@Atlassian.JIRA>
References: <JIRA.12758114.1417054609000@Atlassian.JIRA> <JIRA.12758114.1417054609069@arcas>
Subject: [jira] [Created] (BOOKKEEPER-806) Please create a DOAP file for
 your TLP
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394

Sebb created BOOKKEEPER-806:
-------------------------------

             Summary: Please create a DOAP file for your TLP
                 Key: BOOKKEEPER-806
                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-806
             Project: Bookkeeper
          Issue Type: Task
            Reporter: Sebb


Please can you set up a DOAP for your project and get it added to files.xml?

Please see http://projects.apache.org/create.html

Once you have created the DOAP and committed it to your source code repository, please submit it for inclusion in the Apache projects listing as per:

http://projects.apache.org/create.html#submit

Remember, if you ever move or rename the doap file in future, please
ensure that files.xml is updated to point to the new location.

Thanks!



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11706-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 27 02:29:13 2014
Return-Path: <bookkeeper-dev-return-11706-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E759D1031D
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 27 Nov 2014 02:29:12 +0000 (UTC)
Received: (qmail 77002 invoked by uid 500); 27 Nov 2014 02:29:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 76962 invoked by uid 500); 27 Nov 2014 02:29:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 76950 invoked by uid 99); 27 Nov 2014 02:29:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Nov 2014 02:29:12 +0000
Date: Thu, 27 Nov 2014 02:29:12 +0000 (UTC)
From: "Sebb (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12681301.1385488375000.31917.1417055352647@Atlassian.JIRA>
In-Reply-To: <JIRA.12681301.1385488375000@Atlassian.JIRA>
References: <JIRA.12681301.1385488375000@Atlassian.JIRA> <JIRA.12681301.1385488375156@arcas>
Subject: [jira] [Reopened] (BOOKKEEPER-770) Please delete old releases from
 mirroring system
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-770?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Sebb reopened BOOKKEEPER-770:
-----------------------------

Please delete releases 4.4.2 and 4.2.3.

Only 4.3.0 appears now to be current.

> Please delete old releases from mirroring system
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-770
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-770
>             Project: Bookkeeper
>          Issue Type: Bug
>         Environment: http://www.apache.org/dist/zookeeper/bookkeeper/
>            Reporter: Sebb
>
> To reduce the load on the ASF mirrors, projects are required to delete old releases.
> Please can you remove all non-current releases?
> [Note that older releases are always available from the ASF archive server]
> Thanks.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11707-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 27 09:18:17 2014
Return-Path: <bookkeeper-dev-return-11707-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DD16710E2D
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 27 Nov 2014 09:18:17 +0000 (UTC)
Received: (qmail 93382 invoked by uid 500); 27 Nov 2014 09:18:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 93349 invoked by uid 500); 27 Nov 2014 09:18:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 93338 invoked by uid 99); 27 Nov 2014 09:18:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Nov 2014 09:18:12 +0000
Date: Thu, 27 Nov 2014 09:18:12 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12758114.1417054609000.33473.1417079892616@Atlassian.JIRA>
In-Reply-To: <JIRA.12758114.1417054609000@Atlassian.JIRA>
References: <JIRA.12758114.1417054609000@Atlassian.JIRA> <JIRA.12758114.1417054609069@arcas>
Subject: [jira] [Assigned] (BOOKKEEPER-806) Please create a DOAP file for
 your TLP
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


     [ https://issues.apache.org/jira/browse/BOOKKEEPER-806?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel ]

Ivan Kelly reassigned BOOKKEEPER-806:
-------------------------------------

    Assignee: Ivan Kelly

> Please create a DOAP file for your TLP
> --------------------------------------
>
>                 Key: BOOKKEEPER-806
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-806
>             Project: Bookkeeper
>          Issue Type: Task
>            Reporter: Sebb
>            Assignee: Ivan Kelly
>
> Please can you set up a DOAP for your project and get it added to files.xml?
> Please see http://projects.apache.org/create.html
> Once you have created the DOAP and committed it to your source code repository, please submit it for inclusion in the Apache projects listing as per:
> http://projects.apache.org/create.html#submit
> Remember, if you ever move or rename the doap file in future, please
> ensure that files.xml is updated to point to the new location.
> Thanks!



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11708-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 27 09:56:13 2014
Return-Path: <bookkeeper-dev-return-11708-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B447510FAA
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 27 Nov 2014 09:56:13 +0000 (UTC)
Received: (qmail 59109 invoked by uid 500); 27 Nov 2014 09:56:13 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 59074 invoked by uid 500); 27 Nov 2014 09:56:13 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 59063 invoked by uid 99); 27 Nov 2014 09:56:13 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Nov 2014 09:56:13 +0000
Date: Thu, 27 Nov 2014 09:56:13 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12681301.1385488375000.33631.1417082173555@Atlassian.JIRA>
In-Reply-To: <JIRA.12681301.1385488375000@Atlassian.JIRA>
References: <JIRA.12681301.1385488375000@Atlassian.JIRA> <JIRA.12681301.1385488375156@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-770) Please delete old releases from
 mirroring system
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-770?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14227453#comment-14227453 ] 

Ivan Kelly commented on BOOKKEEPER-770:
---------------------------------------

4.2.3 is current also. 4.3.0 contains some experimental stuff, so we don't want to kill the 4.2 branch just yet.

> Please delete old releases from mirroring system
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-770
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-770
>             Project: Bookkeeper
>          Issue Type: Bug
>         Environment: http://www.apache.org/dist/zookeeper/bookkeeper/
>            Reporter: Sebb
>
> To reduce the load on the ASF mirrors, projects are required to delete old releases.
> Please can you remove all non-current releases?
> [Note that older releases are always available from the ASF archive server]
> Thanks.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11709-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 27 09:57:12 2014
Return-Path: <bookkeeper-dev-return-11709-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E9F6010FB6
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 27 Nov 2014 09:57:12 +0000 (UTC)
Received: (qmail 60584 invoked by uid 500); 27 Nov 2014 09:57:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 60543 invoked by uid 500); 27 Nov 2014 09:57:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 60531 invoked by uid 99); 27 Nov 2014 09:57:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Nov 2014 09:57:12 +0000
Date: Thu, 27 Nov 2014 09:57:12 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12681301.1385488375000.33634.1417082232752@Atlassian.JIRA>
In-Reply-To: <JIRA.12681301.1385488375000@Atlassian.JIRA>
References: <JIRA.12681301.1385488375000@Atlassian.JIRA> <JIRA.12681301.1385488375156@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-770) Please delete old releases from
 mirroring system
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-770?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14227454#comment-14227454 ] 

Ivan Kelly commented on BOOKKEEPER-770:
---------------------------------------

I'll remove the others.


> Please delete old releases from mirroring system
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-770
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-770
>             Project: Bookkeeper
>          Issue Type: Bug
>         Environment: http://www.apache.org/dist/zookeeper/bookkeeper/
>            Reporter: Sebb
>
> To reduce the load on the ASF mirrors, projects are required to delete old releases.
> Please can you remove all non-current releases?
> [Note that older releases are always available from the ASF archive server]
> Thanks.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11710-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 27 09:57:14 2014
Return-Path: <bookkeeper-dev-return-11710-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1369910FC1
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 27 Nov 2014 09:57:14 +0000 (UTC)
Received: (qmail 61129 invoked by uid 500); 27 Nov 2014 09:57:14 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 61086 invoked by uid 500); 27 Nov 2014 09:57:14 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 61072 invoked by uid 99); 27 Nov 2014 09:57:13 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Nov 2014 09:57:13 +0000
Date: Thu, 27 Nov 2014 09:57:13 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12758114.1417054609000.33648.1417082233864@Atlassian.JIRA>
In-Reply-To: <JIRA.12758114.1417054609000@Atlassian.JIRA>
References: <JIRA.12758114.1417054609000@Atlassian.JIRA> <JIRA.12758114.1417054609069@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-806) Please create a DOAP file for
 your TLP
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-806?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14227456#comment-14227456 ] 

Ivan Kelly commented on BOOKKEEPER-806:
---------------------------------------

Added. It has the current info for now, I'll update once the new site and git repo is set up.

> Please create a DOAP file for your TLP
> --------------------------------------
>
>                 Key: BOOKKEEPER-806
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-806
>             Project: Bookkeeper
>          Issue Type: Task
>            Reporter: Sebb
>            Assignee: Ivan Kelly
>
> Please can you set up a DOAP for your project and get it added to files.xml?
> Please see http://projects.apache.org/create.html
> Once you have created the DOAP and committed it to your source code repository, please submit it for inclusion in the Apache projects listing as per:
> http://projects.apache.org/create.html#submit
> Remember, if you ever move or rename the doap file in future, please
> ensure that files.xml is updated to point to the new location.
> Thanks!



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11711-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 27 10:23:13 2014
Return-Path: <bookkeeper-dev-return-11711-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 143D9100F1
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 27 Nov 2014 10:23:13 +0000 (UTC)
Received: (qmail 7078 invoked by uid 500); 27 Nov 2014 10:23:12 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 7028 invoked by uid 500); 27 Nov 2014 10:23:12 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 7015 invoked by uid 99); 27 Nov 2014 10:23:12 -0000
Received: from arcas.apache.org (HELO arcas.apache.org) (140.211.11.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Nov 2014 10:23:12 +0000
Date: Thu, 27 Nov 2014 10:23:12 +0000 (UTC)
From: "Ivan Kelly (JIRA)" <jira@apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <JIRA.12681301.1385488375000.33750.1417083792727@Atlassian.JIRA>
In-Reply-To: <JIRA.12681301.1385488375000@Atlassian.JIRA>
References: <JIRA.12681301.1385488375000@Atlassian.JIRA> <JIRA.12681301.1385488375156@arcas>
Subject: [jira] [Commented] (BOOKKEEPER-770) Please delete old releases from
 mirroring system
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-JIRA-FingerPrint: 30527f35849b9dde25b450d4833f0394


    [ https://issues.apache.org/jira/browse/BOOKKEEPER-770?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=14227477#comment-14227477 ] 

Ivan Kelly commented on BOOKKEEPER-770:
---------------------------------------

removed all but 4.2.3 and 4.3.0

> Please delete old releases from mirroring system
> ------------------------------------------------
>
>                 Key: BOOKKEEPER-770
>                 URL: https://issues.apache.org/jira/browse/BOOKKEEPER-770
>             Project: Bookkeeper
>          Issue Type: Bug
>         Environment: http://www.apache.org/dist/zookeeper/bookkeeper/
>            Reporter: Sebb
>
> To reduce the load on the ASF mirrors, projects are required to delete old releases.
> Please can you remove all non-current releases?
> [Note that older releases are always available from the ASF archive server]
> Thanks.



--
This message was sent by Atlassian JIRA
(v6.3.4#6332)

From bookkeeper-dev-return-11712-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Thu Nov 27 12:45:18 2014
Return-Path: <bookkeeper-dev-return-11712-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3B9A510816
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Thu, 27 Nov 2014 12:45:18 +0000 (UTC)
Received: (qmail 33240 invoked by uid 500); 27 Nov 2014 12:45:18 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 33205 invoked by uid 500); 27 Nov 2014 12:45:18 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 33194 invoked by uid 99); 27 Nov 2014 12:45:17 -0000
Received: from crius.apache.org (HELO crius) (140.211.11.14)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 27 Nov 2014 12:45:17 +0000
Received: from crius.apache.org (localhost [127.0.0.1])
	by crius (Postfix) with ESMTP id BA537E003F8
	for <bookkeeper-dev@zookeeper.apache.org>; Thu, 27 Nov 2014 12:45:16 +0000 (UTC)
Date: Thu, 27 Nov 2014 12:45:13 +0000 (UTC)
From: Apache Jenkins Server  <jenkins@builds.apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <736120689.10454.1417092313711.JavaMail.jenkins@crius>
Subject: Build failed in Jenkins: bookkeeper-trunk #863
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: bookkeeper-trunk
X-Jenkins-Result: FAILURE

See <https://builds.apache.org/job/bookkeeper-trunk/863/>

------------------------------------------
[...truncated 1133 lines...]
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.76 sec
Running org.apache.hedwig.server.persistence.TestBookkeeperPersistenceManagerWhiteBox
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.034 sec
Running org.apache.hedwig.server.persistence.TestLocalDBPersistenceManagerBlackBox
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.758 sec
Running org.apache.hedwig.server.TestBackwardCompat
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.486 sec
Running org.apache.hedwig.server.delivery.TestThrottlingDelivery
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 22.868 sec
Running org.apache.hedwig.server.delivery.TestFIFODeliveryManager
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.509 sec
Running org.apache.hedwig.server.filter.TestMessageFilter
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 8.25 sec
Running org.apache.hedwig.server.meta.TestFactoryLayout
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.918 sec
Running org.apache.hedwig.server.meta.TestMetadataManager
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.376 sec
Running org.apache.hedwig.server.meta.TestMetadataManagerFactory
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.815 sec
Running org.apache.hedwig.server.topics.TestTopicBasedLoadShedder
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.608 sec
Running org.apache.hedwig.server.topics.TestZkTopicManager
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 14.991 sec
Running org.apache.hedwig.server.topics.TestMMTopicManager
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 29.747 sec
Running org.apache.hedwig.server.topics.TestHubInfo
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.275 sec
Running org.apache.hedwig.server.topics.TestHubLoad
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.267 sec
Running org.apache.hedwig.server.topics.TestConcurrentTopicAcquisition
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 6.941 sec
Running org.apache.hedwig.server.integration.TestHedwigRegion
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 117.175 sec
Running org.apache.hedwig.server.integration.TestHedwigHubProxy
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 39.184 sec
Running org.apache.hedwig.server.integration.TestHedwigHubSSL
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 67.072 sec
Running org.apache.hedwig.server.integration.TestHedwigHubRegular
Tests run: 50, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 37.976 sec
Running org.apache.hedwig.client.TestPubSubClient
Tests run: 36, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 33.35 sec
Running org.apache.hedwig.client.netty.TestMultiplexing
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 21.916 sec
Running org.apache.hedwig.client.TestSubAfterCloseSub
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.882 sec

Results :

Tests run: 317, Failures: 0, Errors: 0, Skipped: 0

[INFO] 
[INFO] --- maven-jar-plugin:2.3.1:jar (default-jar) @ hedwig-server ---
[INFO] Building jar: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/target/hedwig-server-4.4.0-SNAPSHOT.jar>
[INFO] 
[INFO] --- maven-dependency-plugin:2.8:copy-dependencies (default) @ hedwig-server ---
[INFO] Copying junit-4.8.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/junit-4.8.1.jar>
[INFO] Copying zookeeper-3.4.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/zookeeper-3.4.6.jar>
[INFO] Copying derby-10.8.2.2.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/derby-10.8.2.2.jar>
[INFO] Copying bookkeeper-server-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-server-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-logging-1.1.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-logging-1.1.1.jar>
[INFO] Copying slf4j-api-1.6.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/slf4j-api-1.6.4.jar>
[INFO] Copying commons-lang-2.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-lang-2.4.jar>
[INFO] Copying slf4j-log4j12-1.6.4.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/slf4j-log4j12-1.6.4.jar>
[INFO] Copying commons-collections-3.2.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-collections-3.2.1.jar>
[INFO] Copying hedwig-server-compat420-4.2.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat420-4.2.0.jar>
[INFO] Copying jline-0.9.94.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/jline-0.9.94.jar>
[INFO] Copying commons-beanutils-1.7.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-beanutils-1.7.0.jar>
[INFO] Copying bookkeeper-stats-api-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-stats-api-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-io-2.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-io-2.1.jar>
[INFO] Copying zookeeper-3.4.6-tests.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/zookeeper-3.4.6-tests.jar>
[INFO] Copying log4j-1.2.15.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/log4j-1.2.15.jar>
[INFO] Copying commons-configuration-1.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-configuration-1.6.jar>
[INFO] Copying commons-digester-1.8.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-digester-1.8.jar>
[INFO] Copying guava-13.0.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/guava-13.0.1.jar>
[INFO] Copying netty-3.9.4.Final.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/netty-3.9.4.Final.jar>
[INFO] Copying hedwig-client-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-client-4.4.0-SNAPSHOT.jar>
[INFO] Copying bookkeeper-server-4.4.0-SNAPSHOT-tests.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/bookkeeper-server-4.4.0-SNAPSHOT-tests.jar>
[INFO] Copying hedwig-protocol-4.4.0-SNAPSHOT.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-protocol-4.4.0-SNAPSHOT.jar>
[INFO] Copying commons-beanutils-core-1.8.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-beanutils-core-1.8.0.jar>
[INFO] Copying hedwig-server-compat400-4.0.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat400-4.0.0.jar>
[INFO] Copying jna-3.2.7.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/jna-3.2.7.jar>
[INFO] Copying hedwig-server-compat410-4.1.0.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/hedwig-server-compat410-4.1.0.jar>
[INFO] Copying commons-cli-1.2.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-cli-1.2.jar>
[INFO] Copying protobuf-java-2.4.1.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/protobuf-java-2.4.1.jar>
[INFO] Copying commons-codec-1.6.jar to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/lib/commons-codec-1.6.jar>
[INFO] 
[INFO] --- maven-jar-plugin:2.3.1:test-jar (default) @ hedwig-server ---
[INFO] Building jar: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-server/target/hedwig-server-4.4.0-SNAPSHOT-tests.jar>
[INFO] 
[INFO] >>> findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server >>>
[INFO] 
[INFO] --- findbugs-maven-plugin:2.5.2:findbugs (findbugs) @ hedwig-server ---
[INFO] Fork Value is true
     [java] The following classes needed for analysis were missing:
     [java]   com.google.protobuf.Parser
     [java] Missing classes: 1
[INFO] Done FindBugs Analysis....
[INFO] 
[INFO] <<< findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server <<<
[INFO] 
[INFO] --- findbugs-maven-plugin:2.5.2:check (default-cli) @ hedwig-server ---
[INFO] BugInstance size is 0
[INFO] Error size is 0
[INFO] No errors/warnings found
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building hedwig-client-jms 4.4.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-clean-plugin:2.4.1:clean (default-clean) @ hedwig-client-jms ---
[INFO] 
[INFO] --- apache-rat-plugin:0.7:check (default-cli) @ hedwig-client-jms ---
[INFO] Exclude: **/JmsHeader.java
[INFO] 
[INFO] --- javacc-maven-plugin:2.6:jjtree-javacc (jjtree-javacc) @ hedwig-client-jms ---
Java Compiler Compiler Version 5.0 (Tree Builder)
(type "jjtree" with no arguments for help)
Reading from file <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/src/main/grammar/javacc/selector_grammar.jjt> . . .
File "Node.java" does not exist.  Will create one.
File "SimpleNode.java" does not exist.  Will create one.
File "ASTOrExpr.java" does not exist.  Will create one.
File "ASTAndExpr.java" does not exist.  Will create one.
File "ASTNotExpr.java" does not exist.  Will create one.
File "ASTGreaterThan.java" does not exist.  Will create one.
File "ASTLessThan.java" does not exist.  Will create one.
File "ASTLessThanEqualTo.java" does not exist.  Will create one.
File "ASTGreaterThanEqualTo.java" does not exist.  Will create one.
File "ASTEqualTo.java" does not exist.  Will create one.
File "ASTNotEqualTo.java" does not exist.  Will create one.
File "ASTIsNullExpr.java" does not exist.  Will create one.
File "ASTBetweenExpr.java" does not exist.  Will create one.
File "ASTInExpr.java" does not exist.  Will create one.
File "ASTLikeExpr.java" does not exist.  Will create one.
File "ASTAddExpr.java" does not exist.  Will create one.
File "ASTSubExpr.java" does not exist.  Will create one.
File "ASTDivideExpr.java" does not exist.  Will create one.
File "ASTMultiplyExpr.java" does not exist.  Will create one.
File "ASTNegateExpr.java" does not exist.  Will create one.
File "ASTLookupExpr.java" does not exist.  Will create one.
File "ASTConstant.java" does not exist.  Will create one.
File "ASTStringVarargParams.java" does not exist.  Will create one.
File "SelectorParserTreeConstants.java" does not exist.  Will create one.
File "SelectorParserVisitor.java" does not exist.  Will create one.
File "JJTSelectorParserState.java" does not exist.  Will create one.
Annotated grammar generated successfully in <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/javacc-1417092295142/node/selector_grammar.jj>
Java Compiler Compiler Version 5.0 (Parser Generator)
(type "javacc" with no arguments for help)
Reading from file <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/javacc-1417092295142/node/selector_grammar.jj> . . .
Warning: Line 296, Column 3: Non-ASCII characters used in regular expression.
Please make sure you use the correct Reader when you create the parser, one that can handle your character set.
File "TokenMgrError.java" does not exist.  Will create one.
File "ParseException.java" does not exist.  Will create one.
File "Token.java" does not exist.  Will create one.
File "SimpleCharStream.java" does not exist.  Will create one.
Parser generated with 0 errors and 1 warnings.
[INFO] Processed 1 grammar
[INFO] 
[INFO] --- maven-remote-resources-plugin:1.1:process (default) @ hedwig-client-jms ---
[INFO] 
[INFO] --- maven-resources-plugin:2.4.3:resources (default-resources) @ hedwig-client-jms ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.0:compile (default-compile) @ hedwig-client-jms ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 76 source files to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/classes>
[INFO] 
[INFO] --- maven-resources-plugin:2.4.3:testResources (default-testResources) @ hedwig-client-jms ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/src/test/resources>
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.0:testCompile (default-testCompile) @ hedwig-client-jms ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 104 source files to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/test-classes>
[INFO] 
[INFO] --- maven-surefire-plugin:2.9:test (default-test) @ hedwig-client-jms ---
[INFO] Tests are skipped.
[INFO] 
[INFO] --- maven-surefire-plugin:2.9:test (unit-tests) @ hedwig-client-jms ---
[INFO] Surefire report directory: <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/surefire-reports>

-------------------------------------------------------
 T E S T S
-------------------------------------------------------

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.hedwig.jms.selector.activemq.SelectorTest
Tests run: 19, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.238 sec
Running org.apache.hedwig.jms.selector.activemq.SelectorParserTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.214 sec
Running org.apache.hedwig.jms.selector.BasicSelectorGrammarTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.245 sec
Running org.apache.hedwig.jms.BasicJMSTest
Tests run: 3, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 3.198 sec <<< FAILURE!

Results :

Failed tests:   testSimpleChat(org.apache.hedwig.jms.BasicJMSTest): true

Tests run: 26, Failures: 1, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] bookkeeper ........................................ SUCCESS [  2.333 s]
[INFO] compability dependencies .......................... SUCCESS [  0.067 s]
[INFO] bookkeeper-server-compat400 ....................... SUCCESS [  4.714 s]
[INFO] bookkeeper-server-compat410 ....................... SUCCESS [  2.330 s]
[INFO] bookkeeper-server-compat420 ....................... SUCCESS [  2.630 s]
[INFO] hedwig-server-compat400 ........................... SUCCESS [  3.824 s]
[INFO] hedwig-server-compat410 ........................... SUCCESS [  3.695 s]
[INFO] hedwig-server-compat420 ........................... SUCCESS [  4.280 s]
[INFO] hedwig-protocol ................................... SUCCESS [ 24.204 s]
[INFO] Stats API for bookkeeper .......................... SUCCESS [  6.243 s]
[INFO] bookkeeper-server ................................. SUCCESS [14:19 min]
[INFO] hedwig-client ..................................... SUCCESS [ 15.447 s]
[INFO] hedwig-server ..................................... SUCCESS [12:04 min]
[INFO] hedwig-client-jms ................................. FAILURE [  7.138 s]
[INFO] bookkeeper-benchmark .............................. SKIPPED
[INFO] Stats provider for twitter-stats package .......... SKIPPED
[INFO] Stats provider for twitter-ostrich package ........ SKIPPED
[INFO] Stats provider for codahale metrics ............... SKIPPED
[INFO] bookkeeper-stats-providers ........................ SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 27:41 min
[INFO] Finished at: 2014-11-27T12:45:01+00:00
[INFO] Final Memory: 58M/661M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.9:test (unit-tests) on project hedwig-client-jms: There are test failures.
[ERROR] 
[ERROR] Please refer to <https://builds.apache.org/job/bookkeeper-trunk/ws/hedwig-client-jms/target/surefire-reports> for the individual test results.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
[ERROR] 
[ERROR] After correcting the problems, you can resume the build with the command
[ERROR]   mvn <goals> -rf :hedwig-client-jms
Build step 'Execute shell' marked build as failure
Recording test results

From bookkeeper-dev-return-11713-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org  Fri Nov 28 12:47:34 2014
Return-Path: <bookkeeper-dev-return-11713-apmail-zookeeper-bookkeeper-dev-archive=zookeeper.apache.org@zookeeper.apache.org>
X-Original-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 92B9310ECA
	for <apmail-zookeeper-bookkeeper-dev-archive@minotaur.apache.org>; Fri, 28 Nov 2014 12:47:34 +0000 (UTC)
Received: (qmail 19544 invoked by uid 500); 28 Nov 2014 12:47:32 -0000
Delivered-To: apmail-zookeeper-bookkeeper-dev-archive@zookeeper.apache.org
Received: (qmail 19502 invoked by uid 500); 28 Nov 2014 12:47:32 -0000
Mailing-List: contact bookkeeper-dev-help@zookeeper.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:bookkeeper-dev-help@zookeeper.apache.org>
List-Unsubscribe: <mailto:bookkeeper-dev-unsubscribe@zookeeper.apache.org>
List-Post: <mailto:bookkeeper-dev@zookeeper.apache.org>
List-Id: <bookkeeper-dev.zookeeper.apache.org>
Reply-To: bookkeeper-dev@zookeeper.apache.org
Delivered-To: mailing list bookkeeper-dev@zookeeper.apache.org
Received: (qmail 19475 invoked by uid 99); 28 Nov 2014 12:47:32 -0000
Received: from crius.apache.org (HELO crius) (140.211.11.14)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 28 Nov 2014 12:47:32 +0000
Received: from crius.apache.org (localhost [127.0.0.1])
	by crius (Postfix) with ESMTP id 817B2E007A6
	for <bookkeeper-dev@zookeeper.apache.org>; Fri, 28 Nov 2014 12:47:31 +0000 (UTC)
Date: Fri, 28 Nov 2014 12:47:28 +0000 (UTC)
From: Apache Jenkins Server  <jenkins@builds.apache.org>
To: bookkeeper-dev@zookeeper.apache.org
Message-ID: <1629790124.10680.1417178848535.JavaMail.jenkins@crius>
In-Reply-To: <736120689.10454.1417092313711.JavaMail.jenkins@crius>
References: <736120689.10454.1417092313711.JavaMail.jenkins@crius>
Subject: Jenkins build is back to normal : bookkeeper-trunk #864
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Jenkins-Job: bookkeeper-trunk
X-Jenkins-Result: SUCCESS

See <https://builds.apache.org/job/bookkeeper-trunk/864/>


